<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LMC_Blog</title>
  
  
  <link href="http://lmc.pub/atom.xml" rel="self"/>
  
  <link href="http://lmc.pub/"/>
  <updated>2023-03-23T09:03:05.621Z</updated>
  <id>http://lmc.pub/</id>
  
  <author>
    <name>LMC</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>如何有效学习？</title>
    <link href="http://lmc.pub/2023/03/23/%E6%8E%8C%E6%8F%A1%E4%B8%80%E9%97%A8%E6%8A%80%E6%9C%AF%E6%9C%80%E5%BF%AB%E7%9A%84%E5%8A%9E%E6%B3%95/"/>
    <id>http://lmc.pub/2023/03/23/%E6%8E%8C%E6%8F%A1%E4%B8%80%E9%97%A8%E6%8A%80%E6%9C%AF%E6%9C%80%E5%BF%AB%E7%9A%84%E5%8A%9E%E6%B3%95/</id>
    <published>2023-03-23T09:43:31.000Z</published>
    <updated>2023-03-23T09:03:05.621Z</updated>
    
    <content type="html"><![CDATA[<h1>如何有效学习？</h1><h2 id="一，以终为始">一，以终为始</h2><p>我们在学任何一种东西的时候，要以终为始。</p><p>比如：</p><p>你想大学本科毕业就月薪过万。</p><blockquote><p>那你就得看市场上那些行业的那些岗位是能产生这个薪资的。</p><p>然后进入这个岗位的要求是什么？更看重什么？</p><p>这些要求有没有主次之分？我的个人条件对我达到这个目标有什么限制。</p><p>然后定下大学努力方向，并从大四规划到大一。</p></blockquote><p>比如：</p><p>你想大四找个BAT暑假实习。</p><blockquote><h2 id="你要知道实习面试要求什么？什么形式的？考些什么？">你要知道实习面试要求什么？什么形式的？考些什么？</h2><p>编程语言是问一门嘛？问的主要是那些？</p><p>算法是怎么考的，是不是白纸写基础算法?考那些算法？</p><p>项目会怎么问？难点，收获，深究框架底层原理？</p><p>计网/操作系统的常见面试题目是哪个部分和章节的？</p><h2 id="什么时候投，简历怎么写？坑在哪里？">什么时候投，简历怎么写？坑在哪里？</h2></blockquote><p>比如：</p><p>你在学习计算机网络。</p><blockquote><h3 id="面试的时候常考的是什么">面试的时候常考的是什么?</h3><p>应用层（HTTP），运输层（TCP）</p></blockquote><p>你在看课的时候最应该，从他重点面试问的地方开始准备。</p><p>而不是拿到一个视频就嘎嘎上去从头看到尾巴。</p><p><strong>以终为始，带着问题去学习。</strong></p><h2 id="二，产出倒逼输入">二，产出倒逼输入</h2><p>拿学编程举例子。</p><p>我这个阶段学习，要做一个什么出来，做到什么水平和程度。</p><p>而不是今天上午学完什么什么，听那个网课听到多少章节。</p><p>听完了这个东西不一定会，看完了一个视频也不一定掌握。</p><p>目标不是今天我要看完xx节那个培训机构的网课，学习几个小时。我把那个科目的网课刷完了。</p><p>而是今天要输出关于XXX的一篇高质量的blog，或者今天做一个电商系统，做一个博客系统，做一个app。</p><p>这个才是完成目标。</p><p>阶段性目标要一个个的完成，目标是真的有产出，做出东西来。而不是把这个流程走一遍就完事了。</p><p>这是解决<code>无用功/形式主义/自我感动式学习</code>的关键。</p><h2 id="三，内化：走出舒适圈">三，内化：走出舒适圈</h2><p>如果你的学习过程是非常轻松的，其实是很难进步的。</p><p>比如你在无脑的刷一个教程视频，从头2倍速看到尾。</p><p>你也不知道这个课具体的是在讲什么，反正你就是把这本书，这个视频刷完了 。</p><p>这个视频讲的什么，书说的什么你会不会？</p><p>这种不经过大脑去虚荣的不过大脑的浏览一遍东西的化，其实谁都记不住。而且也不可能学会。最多有个大体粗略的了解。</p><p>所以我们要离开舒适区。</p><p>想尽办法，绞尽脑子去理解这个东西。</p><p>比如动手一行行先模仿的写一遍代码，看运行得起来不。</p><p>再全删了，自己实现一边。</p><p>或者自己记笔记，不要截屏。</p><p>看完一个视频就关了，然后自己根据自己想的，去做思维导图和自己的理解。</p><p>意思就是把这个东西自己消化内化了一边，然后再向我一样做笔记分享给大家。</p><p>内化得过程会非常的痛苦，但是这样学的东西基本不会忘。</p><p>学任何东西要内化。</p><h2 id="四，有效学习会很慢">四，有效学习会很慢</h2><p>你在学习上花的时间有实际产出，而不是走流程堆时长，番茄打卡自己感动自己。</p><p>对于普通人来说，学习效率高反应在你学习生活中会有一种相反得错觉。</p><p>比如一本书，以前你浏览式学习，基本一天就看完了。然后现在看了这篇文章，你去做内化，做笔记，还要去理解，去吸收总结反思。结果你一本书看了一整年。</p><p>是一天看完一本书快还是一年看完一本书快呢？那坑定是一天快。但是一天看完了快有用嘛？没记住就没用。</p><p>你习惯了快学习，敷衍学习，自我安慰学习，对于真的学习你会觉得比被我打了10顿得狗渣男爬得都慢。</p><p>但慢才是我们学习必须经历得一个过程</p><p>你一上午看完了，你没有学会，那你白看了。这一上午全浪费了。</p><p>所以我觉得我要贯彻这个。学编程得时候要“追求成果。今天做出一个界面。学理论型学科就要内化吸收然后口语化输出一篇文章”</p><p>踏踏实实的学才能进步，不要焦急浮躁，</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;如何有效学习？&lt;/h1&gt;
&lt;h2 id=&quot;一，以终为始&quot;&gt;一，以终为始&lt;/h2&gt;
&lt;p&gt;我们在学任何一种东西的时候，要以终为始。&lt;/p&gt;
&lt;p&gt;比如：&lt;/p&gt;
&lt;p&gt;你想大学本科毕业就月薪过万。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;那你就得看市场上那些行业的那些岗位是</summary>
      
    
    
    
    <category term="随感" scheme="http://lmc.pub/categories/%E9%9A%8F%E6%84%9F/"/>
    
    
    <category term="随感" scheme="http://lmc.pub/tags/%E9%9A%8F%E6%84%9F/"/>
    
  </entry>
  
  <entry>
    <title>算法</title>
    <link href="http://lmc.pub/2023/03/22/2023-03-22-%E7%AE%97%E6%B3%95/"/>
    <id>http://lmc.pub/2023/03/22/2023-03-22-%E7%AE%97%E6%B3%95/</id>
    <published>2023-03-22T10:43:31.000Z</published>
    <updated>2023-03-22T12:18:21.866Z</updated>
    
    <content type="html"><![CDATA[<h1>算法笔记</h1><h2 id="2023-03-22">2023/03/22</h2><h3 id="1-代码规范">1. 代码规范</h3><h4 id="变量命名：">变量命名：</h4><p>规范</p><blockquote><ul><li><p>大小驼峰:Java</p></li><li><p>下划线:C</p></li><li><p>匈牙利</p></li></ul></blockquote><p>小驼峰：第一个单词首字母小写后面其他单词都首字母大写theNum</p><p>大驼峰：第一个单词也大写TheNum</p><p>下划线：the_num</p><p>意义</p><h4 id="空格">空格</h4><p>操作符左右要有空格</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> i + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>分隔符前一位没有空格，后一位有</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a, b;</span><br></pre></td></tr></table></figure><p>大括号和函数同一行，同时一个空格隔开</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFunction</span> <span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>while if for 后都有一个空格</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (a &gt; b) &#123;</span><br><span class="line">return -1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-刷题用不用库函数">2. 刷题用不用库函数</h3><p>如果题目关键的部分直接用库函数就可以解决，建议不要使用库函数。</p><p>如果库函数仅仅是 解题过程中的一小部分，并且你已经很清楚这个库函数的内部实现原理的话，那么直接用库函数。</p><h3 id="3-算法的ACM模式">3. 算法的ACM模式</h3><p>力扣上是直接写逻辑的，但是面试经常是直接牛客上啥也没有就去写。</p><p>力扣是直接搞算法逻辑的。</p><p>ACM就是记事本写算法那种。</p><p>主要是引包和一些输入输出，比如一些数据结构的构建。</p><h3 id="4-程序员写文档">4. 程序员写文档</h3><p>MarkDown</p><p>专注写作，高效率。</p><p>富文本点来点去很麻烦，在写作的时候。</p><p>方便记笔记，更快速。</p><blockquote><p>几个#就是几级主题</p><p>+/-表示无序列表</p><p>1.2.直接表示有序列表</p><p>链接：<code>[名字](网址)</code></p><p>图片：<code>![名字](图片地址)</code></p></blockquote><p>还支持Web前端，html，CSS标签</p><p>软件：</p><p>一些网站</p><p>win：Typora（I am）</p><p>mac：macdown</p><h3 id="5-互联网大厂研发流程">5.互联网大厂研发流程</h3><ol><li>需求文档</li><li>需求包含那些功能</li><li>难点：记下来</li><li>架构图</li><li>定协议</li><li>设计数据机构和算法：面试手撕算法，实际掉包侠。</li><li>预估容量</li><li>考虑部署</li><li>设计评审</li><li>写代码：体力活</li><li>自测：绩效</li><li>联调</li><li>给测试</li><li>code review</li><li>合入主干</li><li>发布</li></ol><h3 id="6-程序员简历">6. 程序员简历</h3><ol><li><p>别花里胡哨，简单直接一点。</p></li><li><p>一张纸就行。</p></li><li><p>技术简历就不用来“我锻炼了组织能力了。”</p></li><li><p>别写<strong>精通XX语言</strong></p><p>精通 &gt; 熟悉 &gt; 掌握 &gt; 了解</p><p>简历上写了熟悉那门语言，基本就必考这个。</p><p>一般编程语言只会考察一门。</p></li><li><p>拿不准的东西别写简历上。别写“代码行数10w+”</p></li><li><p>项目：难点 + 贡献</p><p>做项目的时候要保证对难点的敏感程度。</p><p>花了很久解决的东西一定要记下来形成博客。</p><p>一般你难点写的什么就问你什么。</p></li><li><p>这样被动就成了主动。<strong>真正好的简历是 当同学们把自己的简历递给面试官的时候，基本都知道面试官看着简历都会问什么问题</strong>，然后将面试官的引导到自己最熟悉的领域，这样大家才会占有主动权。</p></li><li><p>勤劳输出博客 + github</p></li><li><p>专业技能要写的具体且有针对诱导性：熟悉计算机网络，熟悉TCP三次握手，四次挥手，流量控制，拥塞控制等手段。</p></li><li><p>项目经历： <a href="https://code-thinking-1253855093.file.myqcloud.com/pics/20220308225933.png">https://code-thinking-1253855093.file.myqcloud.com/pics/20220308225933.png</a></p><p>项目描述，主要工作，项目难点，个人收获</p><p>一般都是问后面两个。</p></li></ol><h3 id="7-大厂面试流程">7. 大厂面试流程</h3><ul><li>一面机试：选择/编程</li><li>二面基础算法面：算法</li><li>三面综合技术面：编程语言+计算机基础+项目</li><li>四面技术leader面：解决问题快速学习</li><li>最后hr面：企业文化，职业发展，offer选择，薪资待遇</li></ul><p><strong>机试</strong>：选择》计网，操作系统，数据库，编程语言 牛客有</p><p><strong>基础算法</strong>：白纸写基础算法。</p><p>Java/C++</p><p>尤其注意基本机构定义和白纸代码训练。</p><p><strong>综合技术</strong>：</p><p>编程语言：Java -》 Kotlin</p><p>计算机基础：计网 - &gt; 操作系统</p><p>项目：技术原理 + 技术深度 + 应变能力</p><p><strong>Leaders面</strong>：</p><p>解决问题能力：</p><ul><li>学习/项目中遇到那些挑战，怎么解决的。</li></ul><p>快速学习能力：</p><ul><li>如何快速学习一门新的技术和语言。</li></ul><p><strong>HR面</strong></p><ul><li>为什么选择我么公司？技术氛围，职业发展，公司潜力</li><li>职业规划，技术方面讲</li><li>是否接受加班</li><li>坚持最长的一件事情</li><li>工资XX能接受嘛？</li></ul><h3 id="8-中国互联网城市排行">8. 中国互联网城市排行</h3><ol><li>北京</li><li>上海</li><li>深圳</li><li>杭州</li><li>广州</li><li>成都</li></ol><hr><h3 id="9-时间复杂度">9. 时间复杂度</h3><p>O(n):是最坏情况</p><p>O(1)常数阶 &lt; O(logn)对数阶 &lt; O(n)线性阶 &lt; O(nlogn)线性对数阶 &lt; O(n^2)平方阶 &lt; O(n^3)立方阶 &lt; O(2^n)指数阶</p><h3 id="10-空间复杂度">10. 空间复杂度</h3><p>不是程序大小而是程序运行时占用内存的大小</p><h2 id="2023-03-23">2023/03/23</h2><hr><h2 id="My-Opinion">My Opinion</h2><p>代码随想录要刷三遍。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;算法笔记&lt;/h1&gt;
&lt;h2 id=&quot;2023-03-22&quot;&gt;2023/03/22&lt;/h2&gt;
&lt;h3 id=&quot;1-代码规范&quot;&gt;1. 代码规范&lt;/h3&gt;
&lt;h4 id=&quot;变量命名：&quot;&gt;变量命名：&lt;/h4&gt;
&lt;p&gt;规范&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>面试题</title>
    <link href="http://lmc.pub/2023/03/22/2023-03-22-%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <id>http://lmc.pub/2023/03/22/2023-03-22-%E9%9D%A2%E8%AF%95%E9%A2%98/</id>
    <published>2023-03-22T10:43:31.000Z</published>
    <updated>2023-03-23T06:42:53.026Z</updated>
    
    <content type="html"><![CDATA[<h1>Android面试合集</h1><h2 id="一，编程语言">一，编程语言</h2><h3 id="Java">Java</h3><h3 id="Kotlin">Kotlin</h3><h2 id="二，Android">二，Android</h2><h2 id="三，计算基础">三，计算基础</h2><h3 id="3-1-计算机网络">3.1 计算机网络</h3><h4 id="TCP">TCP</h4><ol><li>请简述一下什么是【三报文握手，四报文挥手】？</li><li>为什么要三次握手？</li><li>为什么要三次挥手？</li></ol><h4 id="HTTP">HTTP</h4><h3 id="3-2-操作系统">3.2 操作系统</h3><h3 id="3-3-算法">3.3 算法</h3><h2 id="四，其他">四，其他</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Android面试合集&lt;/h1&gt;
&lt;h2 id=&quot;一，编程语言&quot;&gt;一，编程语言&lt;/h2&gt;
&lt;h3 id=&quot;Java&quot;&gt;Java&lt;/h3&gt;
&lt;h3 id=&quot;Kotlin&quot;&gt;Kotlin&lt;/h3&gt;
&lt;h2 id=&quot;二，Android&quot;&gt;二，Android&lt;/h2&gt;
&lt;h2 i</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="面试" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%9D%A2%E8%AF%95/"/>
    
    
    <category term="面试" scheme="http://lmc.pub/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>Git基础</title>
    <link href="http://lmc.pub/2023/03/14/2023-03-14-Git%E5%9F%BA%E7%A1%80/"/>
    <id>http://lmc.pub/2023/03/14/2023-03-14-Git%E5%9F%BA%E7%A1%80/</id>
    <published>2023-03-14T14:03:00.000Z</published>
    <updated>2023-03-20T08:55:30.494Z</updated>
    
    <content type="html"><![CDATA[<h1>Git基础</h1><h2 id="一，准备">一，准备</h2><h3 id="1-安装">1. 安装</h3><blockquote><p>下载：<a href="https://gitforwindows.org/">Git for Windows</a></p></blockquote><p>无脑式下一步。</p><p>git –version，出现下面 git 就是安装好了。</p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314154601364.png" alt="image-20230314154601364" style="zoom:80%;" /><h3 id="2-配置用户信息">2. 配置用户信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;xxx&quot;</span><br><span class="line"></span><br><span class="line">git config --global user.email &quot;xxx@qq.com&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-创建仓库">3. 创建仓库</h3><p>你想让哪一个文件夹成为 git 仓库就在它下面打开 git bash 然后输下面这个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p>这个文件夹下面就会有一个 .git 文件。</p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170738200.png" alt="image-20230314170738200" style="zoom:80%;" /><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170817463.png" alt="image-20230314170817463" style="zoom:80%;" /><h3 id="4-查看仓库状态">4. 查看仓库状态</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git git status</span><br></pre></td></tr></table></figure><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170836047.png" alt="image-20230314170836047" style="zoom:80%;" /><h2 id="二，暂存区">二，暂存区</h2><blockquote><p>准备工作：在文件夹下搞个文件。（最好英文名）</p></blockquote><h3 id="1-添加到暂存区">1. 添加到暂存区</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 添加指定文件</span><br><span class="line">git add 文件名</span><br><span class="line"></span><br><span class="line"># 添加这个仓库文件夹下的所有文件</span><br><span class="line">git add -A</span><br></pre></td></tr></table></figure><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314171905546.png" alt="image-20230314171905546" style="zoom:80%;" /><h3 id="2-暂存区回来">2. 暂存区回来</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git restore 文件名</span><br><span class="line">git restore --staged 文件名</span><br></pre></td></tr></table></figure><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314171931261.png" alt="image-20230314171931261" style="zoom:80%;" /><h2 id="三，本地仓库">三，本地仓库</h2><h3 id="1-提交到本地仓库">1. 提交到本地仓库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;这次提交干了什么事的描述（建议英文）&quot;</span><br></pre></td></tr></table></figure><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314172124631.png" alt="image-20230314172124631" style="zoom:80%;" /><h3 id="2-从本地仓库回来">2. 从本地仓库回来</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 恢复到上一次</span><br><span class="line">git reset --hard HEAD~</span><br><span class="line"></span><br><span class="line"># 恢复到指定提交</span><br><span class="line">git reset --hard 提交id</span><br></pre></td></tr></table></figure><p>本地仓库里有很多版本，用这个会直接把你的那个文件回到指令中的那个版本。</p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314172813969.png" alt="image-20230314172813969" style="zoom:80%;" /><h3 id="3-查看提交历史">3. 查看提交历史</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure><p>错了就改，缺了就补，时常回顾，精心打造自己的计算机知识体系。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Git基础&lt;/h1&gt;
&lt;h2 id=&quot;一，准备&quot;&gt;一，准备&lt;/h2&gt;
&lt;h3 id=&quot;1-安装&quot;&gt;1. 安装&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;下载：&lt;a href=&quot;https://gitforwindows.org/&quot;&gt;Git for Windows&lt;/a&gt;&lt;</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="其他" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/"/>
    
    <category term="工具" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="Git" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/%E5%B7%A5%E5%85%B7/Git/"/>
    
    
    <category term="Git" scheme="http://lmc.pub/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>【Bug】Java中Char和Int的互转</title>
    <link href="http://lmc.pub/2023/01/11/%E3%80%90Bug%E3%80%91Java%E4%B8%ADChar%E5%92%8CInt%E7%9A%84%E4%BA%92%E8%BD%AC/"/>
    <id>http://lmc.pub/2023/01/11/%E3%80%90Bug%E3%80%91Java%E4%B8%ADChar%E5%92%8CInt%E7%9A%84%E4%BA%92%E8%BD%AC/</id>
    <published>2023-01-11T04:24:27.000Z</published>
    <updated>2023-01-11T15:42:35.634Z</updated>
    
    <content type="html"><![CDATA[<h1>【Bug】Java中Char和Int的互转</h1><p>今天在做一个栈相关的算法，然后在 Java中Char和Int互转 这里粗心记混了，结果出了个Bug，修了一会。</p><p>事情是这样的：</p><p>有一个由数字构成的字符串，比如：“1433223”，然后想把组成字符串的每一位数字都放到一个栈里面去。</p><p>但是每次从这个字符串(String)拿出来的是是一个字符(Char)而非数字(Int)，比如拿出第一位，他是字符‘1’而不是整数1。</p><p>当时就直接强转了，以为： int 1 = (int)‘1’</p><p>但其实 (int)‘1’ = 49(int) 而不是期望的 1(int)。导致后面的一大堆出了奇怪的 bug。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20230111231905800.png" alt="image-20230111231905800"></p><p>因为 Java 中的char其实底层都是对应的ASCII码，也是int整数。</p><p>比如：‘1’（Char） = 49(int)</p><p>所以正确的做法，应该是下面这样：</p><p>把char转为对应的Integer</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20230111232012386.png" alt="image-20230111232012386"></p><p>当然也可以这样：</p><p>numStack.push((int)(char01 - ‘0’);</p><p>所以关于 Java的Char底层就是对应的ASCII码(int),你忘了吗？</p><p><s>(int)‘1’ = 1(int)</s></p><p>(int)‘1’ = 49(int)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;【Bug】Java中Char和Int的互转&lt;/h1&gt;
&lt;p&gt;今天在做一个栈相关的算法，然后在 Java中Char和Int互转 这里粗心记混了，结果出了个Bug，修了一会。&lt;/p&gt;
&lt;p&gt;事情是这样的：&lt;/p&gt;
&lt;p&gt;有一个由数字构成的字符串，比如：“1433223”，然后</summary>
      
    
    
    
    <category term="Bug" scheme="http://lmc.pub/categories/Bug/"/>
    
    <category term="Java" scheme="http://lmc.pub/categories/Bug/Java/"/>
    
    
    <category term="Bug" scheme="http://lmc.pub/tags/Bug/"/>
    
  </entry>
  
  <entry>
    <title>App打包</title>
    <link href="http://lmc.pub/2022/12/19/%E6%80%8E%E4%B9%88%E8%AE%A9%E8%87%AA%E5%B7%B1%E7%9A%84APP%E8%AE%A9%E5%A4%A7%E5%AE%B6%E7%94%A8%E4%B8%8A%EF%BC%88App%E6%89%93%E5%8C%85%EF%BC%89%EF%BC%9F/"/>
    <id>http://lmc.pub/2022/12/19/%E6%80%8E%E4%B9%88%E8%AE%A9%E8%87%AA%E5%B7%B1%E7%9A%84APP%E8%AE%A9%E5%A4%A7%E5%AE%B6%E7%94%A8%E4%B8%8A%EF%BC%88App%E6%89%93%E5%8C%85%EF%BC%89%EF%BC%9F/</id>
    <published>2022-12-19T13:15:42.000Z</published>
    <updated>2023-03-20T09:22:20.137Z</updated>
    
    <content type="html"><![CDATA[<h1>App打包</h1><p>怎么让自己的APP让大家用            上</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219175737919.png" alt="image-20221219175737919"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219175755262.png" alt="image-20221219175755262"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219175830964.png" alt="image-20221219175830964"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219180120421.png" alt="image-20221219180120421"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219180149245.png" alt="image-20221219180149245"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219180250938.png" alt="image-20221219180250938"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219180326003.png" alt="image-20221219180326003"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219180419610.png" alt="image-20221219180419610"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;App打包&lt;/h1&gt;
&lt;p&gt;怎么让自己的APP让大家用            上&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221</summary>
      
    
    
    
    <category term="Android" scheme="http://lmc.pub/categories/Android/"/>
    
    
    <category term="Android" scheme="http://lmc.pub/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>怎么给APP换名字和图标？</title>
    <link href="http://lmc.pub/2022/12/10/%E6%80%8E%E4%B9%88%E7%BB%99APP%E6%8D%A2%E5%90%8D%E5%AD%97%E5%92%8C%E5%9B%BE%E6%A0%87%EF%BC%9F/"/>
    <id>http://lmc.pub/2022/12/10/%E6%80%8E%E4%B9%88%E7%BB%99APP%E6%8D%A2%E5%90%8D%E5%AD%97%E5%92%8C%E5%9B%BE%E6%A0%87%EF%BC%9F/</id>
    <published>2022-12-10T13:15:42.000Z</published>
    <updated>2023-03-20T09:22:12.628Z</updated>
    
    <content type="html"><![CDATA[<h1>怎么给APP换名字和图标？</h1><p>没美化的APP：</p><p>统一绿底安卓头，名字奇奇怪怪</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219163250771.png" alt="image-20221219163250771"></p><p>换个名字换个图标：</p><p>像那么回事了。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/A5963A1E4899F6DD73EA08A7FA981DEE.jpg" alt="img"></p><h2 id="换名字">换名字</h2><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219163641901.png" alt="image-20221219163641901"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219164336011.png" alt="image-20221219164336011"></p><h2 id="改图标">改图标</h2><p>准备一张你想要的照片当App图标</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219164443960.png" alt="image-20221219164443960"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219165100459.png" alt="image-20221219165100459"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219165203825.png" alt="image-20221219165203825"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219165258740.png" alt="image-20221219165258740"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219165422364.png" alt="image-20221219165422364"></p><p>然后直接 Finish 就可以拉。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;怎么给APP换名字和图标？&lt;/h1&gt;
&lt;p&gt;没美化的APP：&lt;/p&gt;
&lt;p&gt;统一绿底安卓头，名字奇奇怪怪&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags</summary>
      
    
    
    
    <category term="Android" scheme="http://lmc.pub/categories/Android/"/>
    
    
    <category term="Android" scheme="http://lmc.pub/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Android项目_天气预报</title>
    <link href="http://lmc.pub/2022/11/03/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5App/"/>
    <id>http://lmc.pub/2022/11/03/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5App/</id>
    <published>2022-11-03T02:46:00.000Z</published>
    <updated>2023-03-20T08:54:38.257Z</updated>
    
    <content type="html"><![CDATA[<h1>火山天气</h1><p>天气API：<a href="https://dashboard.caiyunapp.com/v1/token/">彩云科技 | 开放平台 (caiyunapp.com)</a></p><blockquote><ol><li><p>查询全球城市数据信息：<a href="https://api.caiyunapp.com/v2/place?query=%E5%8C%97%E4%BA%AC&amp;token=%7Btoken%7D&amp;lang=zh_CN">https://api.caiyunapp.com/v2/place?query=北京&amp;token={token}&amp;lang=zh_CN</a></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;**status**&quot;</span><span class="punctuation">:</span><span class="string">&quot;ok&quot;</span><span class="punctuation">,</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;**places**&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;**name**&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京市&quot;</span><span class="punctuation">,</span><span class="attr">&quot;**location**&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.9041999</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.4073963</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;**formatted_address**&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国北京市&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京西站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.89491</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.322056</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 莲花池东路118号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京南站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.865195</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.378545</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 永外大街车站路12号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京站(地铁站)&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.904983</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.427287</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 东城区 2号线&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>查询某地区实时天气：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/realtime.json  </code></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;**realtime**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;**temperature**&quot;</span><span class="punctuation">:</span> <span class="number">23.16</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**skycon**&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WIND&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**air_quality**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;aqi&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;chn&quot;</span><span class="punctuation">:</span> <span class="number">17.0</span> <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure></li><li><p>查询未来几天天气信息接口：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/daily.json  </code></p><p>返回的JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;daily&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;max&quot;</span><span class="punctuation">:</span> <span class="number">25.7</span><span class="punctuation">,</span> <span class="attr">&quot;min&quot;</span><span class="punctuation">:</span> <span class="number">20.3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;skycon&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CLOUDY&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2019-10-20T00:00+08:00&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;life_index&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coldRisk&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;易发&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;carWashing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;适宜&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ultraviolet&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;dressing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;舒适&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h2 id="1-MVVM项目架构">1. MVVM项目架构</h2><p>MVVM：Model-View-ViewModel  （还有MVP/MVC）</p><p>Model：数据模型</p><p>View：界面展示</p><p>ViewModel：连接数据和界面的桥梁</p><p>实现让业务逻辑和界面展示分离的程序结构设计</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221103164101961.png" alt="image-20221103164101961"></p><p>UI控制层：Activity，Fragment，布局文件等和界面有关的东西；</p><p>ViewModel层：持有和UI元素相关的数据，并保证旋转不会丢失；同时提供接口给UI控制层调用和仓库层通信；</p><p>仓库层：判断调用请求的数据去哪里获取</p><p>本地数据源：SQLite，SharedPreferences</p><p>网络数据库：Retrofit访问服务器提供的Webservice接口来获得</p><p>注意：箭头是单向的，表示上一层只能持有下一层的引用。不能反过来也不能跨层</p><p>项目结构：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221103165442048.png" alt="image-20221103165442048"></p><p>依赖：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.core:core-ktx:1.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.google.android.material:material:1.4.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.recyclerview:recyclerview:1.2.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-extensions:2.2.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-livedata-ktx:2.5.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.1.0&quot;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:retrofit:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:converter-gson:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.1&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.1&quot;</span></span><br><span class="line"></span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.13.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-城市数据">2. 城市数据</h2><blockquote><ol><li><p>查询全球城市数据信息：<a href="https://api.caiyunapp.com/v2/place?query=%E5%8C%97%E4%BA%AC&amp;token=%7Btoken%7D&amp;lang=zh_CN">https://api.caiyunapp.com/v2/place?query=北京&amp;token={token}&amp;lang=zh_CN</a></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;**status**&quot;</span><span class="punctuation">:</span><span class="string">&quot;ok&quot;</span><span class="punctuation">,</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;**places**&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;**name**&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京市&quot;</span><span class="punctuation">,</span><span class="attr">&quot;**location**&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.9041999</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.4073963</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;**formatted_address**&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国北京市&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京西站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.89491</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.322056</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 莲花池东路118号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京南站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.865195</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.378545</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 永外大街车站路12号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京站(地铁站)&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.904983</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.427287</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 东城区 2号线&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="2-1-逻辑层">2.1 逻辑层</h3><h4 id="2-1-1-准备工作">2.1.1 准备工作</h4><p><strong>全局获取context</strong></p><blockquote><p>为什么？</p><p>因为MVVM这种分层架构设计，我们在ViewModel就不再持有Activity的引用了，所以会经常出现缺<code>context</code>的情况。</p></blockquote><ol><li><p>在com.lmc.volcanoweather包下新建一个VolcanoWeatherApplication类:</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106162714195.png" alt="image-20221106162714195"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="comment">//全局获取context</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VolcanoWeatherApplication</span>:<span class="type">Application</span></span>() &#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="meta">@SuppressLint(<span class="string">&quot;StaticFieldLeak&quot;</span>)</span></span><br><span class="line">        <span class="keyword">lateinit</span> <span class="keyword">var</span> context: Context</span><br><span class="line">        <span class="comment">//天气API的令牌值</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">val</span> TOKEN = <span class="string">&quot;NL0AtaDgGQO3Ytfg&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line">        context = applicationContext</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>顺手把天气API的令牌值放进去</p></li><li><p>在AndroidManifest下指定用我们这个VolcanoWeatherApplication</p><p>就下面name那一句指定下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:name</span>=<span class="string">&quot;.VolcanoWeatherApplication&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.VolcanoWeather&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">tools:targetApi</span>=<span class="string">&quot;31&quot;</span>&gt;</span></span><br><span class="line">      ……</span><br><span class="line">   <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-2-数据模型">2.1.2 数据模型</h4><ol><li><p>logic-》model 下建立一个个PlaceResponse.kt</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106164054048.png" alt="image-20221106164054048"></p><p>代码：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaceResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> places: List&lt;Place&gt;)</span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Place</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> location: Location,</span><br><span class="line">                 <span class="meta">@SerializedName(<span class="string">&quot;formatted_address&quot;</span>)</span> <span class="keyword">val</span> address: String)<span class="comment">//JSON中字段命名和Kotlin中命名规范不一致就用一下这个</span></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Location</span></span>(<span class="keyword">val</span> lng: String, <span class="keyword">val</span> lat: String)</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-3-网络层">2.1.3 网络层</h4><ol><li><p>定义一个Retrofit接口（访问彩云天气城市搜索API:logic/network下新建PlaceService）</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.PlaceResponse</span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.GET</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.Query</span><br><span class="line"><span class="comment">//位置服务</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PlaceService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//发送的网络请求只有query(地址)，其他的都不会变</span></span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2/place?token=<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>&amp;lang=zh_CN&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(<span class="meta">@Query(<span class="string">&quot;query&quot;</span>)</span> query: <span class="type">String</span>)</span></span>:Call&lt;PlaceResponse&gt;<span class="comment">//数据返回结果解析成PlaceResponse</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>创建一个Retrofit构造器（logic/network-》ServiceCreator单例类）</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> retrofit2.Retrofit</span><br><span class="line"><span class="keyword">import</span> retrofit2.converter.gson.GsonConverterFactory</span><br><span class="line"></span><br><span class="line"><span class="comment">//Retrofit的构造器</span></span><br><span class="line"><span class="keyword">object</span> ServiceCreator &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">val</span> BASE_URL = <span class="string">&quot;https://api.caiyunapp.com/&quot;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> retrofit = Retrofit.Builder()</span><br><span class="line">        .baseUrl(BASE_URL)</span><br><span class="line">        .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">create</span><span class="params">(serviceClass: <span class="type">Class</span>&lt;<span class="type">T</span>&gt;)</span></span>: T = retrofit.create(serviceClass)</span><br><span class="line">    <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T&gt;</span> <span class="title">create</span><span class="params">()</span></span>: T = create(T::<span class="keyword">class</span>.java)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>一个统一的网络数据源访问入口（对所有网络请求API进行封装）logic/network/VolcanoWeatherNetwork单例类</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.Callback</span><br><span class="line"><span class="keyword">import</span> retrofit2.Response</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.resume</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.resumeWithException</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.suspendCoroutine</span><br><span class="line"></span><br><span class="line"><span class="comment">//一个统一的网络数据源访问入口</span></span><br><span class="line"><span class="keyword">object</span> VolcanoWeatherNetwork &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> placeService = ServiceCreator.create&lt;PlaceService&gt;()<span class="comment">//创建了一个PlaceService接口的动态代理对象</span></span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = placeService.searchPlaces(query).await()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Call<span class="type">&lt;T&gt;</span>.<span class="title">await</span><span class="params">()</span></span>: T &#123;</span><br><span class="line">        <span class="keyword">return</span> suspendCoroutine &#123; continuation -&gt;</span><br><span class="line">            enqueue(<span class="keyword">object</span> : Callback&lt;T&gt; &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResponse</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, response: <span class="type">Response</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> body = response.body()</span><br><span class="line">                    <span class="keyword">if</span> (body != <span class="literal">null</span>) continuation.resume(body)</span><br><span class="line">                    <span class="keyword">else</span> continuation.resumeWithException(</span><br><span class="line">                        RuntimeException(<span class="string">&quot;response body is null&quot;</span>))</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onFailure</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, t: <span class="type">Throwable</span>)</span></span> &#123;</span><br><span class="line">                    continuation.resumeWithException(t)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-4-仓库层">2.1.4 仓库层</h4><blockquote><p>仓库层主要工作：判断调用方请求的数据要从哪里拿（本地还是网络？）并拿到给调用方。</p><p>相当于他是调用和缓存的中间件，每次有调用请求先看下本地有没有缓存，没有就直接去网络或者内存中拿。</p></blockquote><p>这里没有做缓存必要，直接全去网络。</p><p>logic下做一个Repository单例类，作为仓库层的统一封装入口。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106171104592.png" alt="image-20221106171104592"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.liveData</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.network.VolcanoWeatherNetwork</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.Dispatchers</span><br><span class="line"></span><br><span class="line"><span class="comment">//仓库层的统一封装入口</span></span><br><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = liveData(Dispatchers.IO) &#123;<span class="comment">//这里设置全是在子线程中干活</span></span><br><span class="line">        <span class="keyword">val</span> result = <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> placeResponse = VolcanoWeatherNetwork.searchPlaces(query)</span><br><span class="line">            <span class="keyword">if</span> (placeResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">val</span> places = placeResponse.places</span><br><span class="line">                Result.success(places)<span class="comment">//这个是Kotlin自带的包装方法</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Result.failure(RuntimeException(<span class="string">&quot;response status is <span class="subst">$&#123;placeResponse.status&#125;</span>&quot;</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">            Result.failure&lt;List&lt;Place&gt;&gt;(e)</span><br><span class="line">        &#125;</span><br><span class="line">        emit(result)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-1-5-ViewModel层">2.1.5 ViewModel层</h4><blockquote><p>这是逻辑层和UI层的一个桥梁，但是更加偏向逻辑。但又由于ViewModel和Activity还有Fragment是一一对应的。所有把他们放在一起好了。</p></blockquote><p>ui/place下新建一个PlaceViewModel</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Transformations</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.Repository</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="comment">//ViewModel层</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceViewModel</span>:<span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> searchLiveData = MutableLiveData&lt;String&gt;()</span><br><span class="line">    <span class="keyword">val</span> placeList = ArrayList&lt;Place&gt;()</span><br><span class="line">    <span class="keyword">val</span> placeLiveData = Transformations.switchMap(searchLiveData) &#123; query -&gt;</span><br><span class="line">        Repository.searchPlaces(query)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        searchLiveData.value = query</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-UI层">2.2 UI层</h3><h4 id="2-2-1-界面总布局">2.2.1 界面总布局</h4><p>在res/layout目录中新建fragment_place.xml布局</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;?android:windowBackground&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/bgImageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/bg_place&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/actionBarLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@color/design_default_color_primary&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/searchPlaceEdit&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:paddingStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:paddingEnd</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:hint</span>=<span class="string">&quot;输入地址&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">&quot;@drawable/search_bg&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/actionBarLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:visibility</span>=<span class="string">&quot;gone&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107142453630.png" alt="image-20221107142453630"></p><h4 id="2-2-2-RecycleView的善后工作">2.2.2 RecycleView的善后工作</h4><ol><li><p>子项布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107142710677.png" alt="image-20221107142710677"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;130dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;12dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_margin</span>=<span class="string">&quot;18dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeName&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeAddress&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorSecondary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107143253929.png" alt="image-20221107143253929"></p></li><li><p>RecycleView适配器</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107143356782.png" alt="image-20221107143356782"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="comment">//RecyclerView适配器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: Fragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList: List&lt;Place&gt;) :</span><br><span class="line">    RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(view: View) : RecyclerView.ViewHolder(view) &#123;</span><br><span class="line">        <span class="keyword">val</span> placeName: TextView = view.findViewById(R.id.placeName)</span><br><span class="line">        <span class="keyword">val</span> placeAddress: TextView = view.findViewById(R.id.placeAddress)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">            parent, <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">return</span> ViewHolder(view)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">        holder.placeName.text = place.name</span><br><span class="line">        holder.placeAddress.text = place.address</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = placeList.size</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-2-3-Fragment">2.2.3 Fragment</h4><ol><li>Fragment实现</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107144434547.png" alt="image-20221107144434547"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.core.widget.addTextChangedListener</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Observer</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.fragment_place.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span>:<span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(PlaceViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> adapter: PlaceAdapter</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(inflater: <span class="type">LayoutInflater</span>, container: <span class="type">ViewGroup</span>?,</span></span></span><br><span class="line"><span class="params"><span class="function">                              savedInstanceState: <span class="type">Bundle</span>?)</span></span>: View? &#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_place, container, <span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinearLayoutManager(activity)</span><br><span class="line">        recyclerView.layoutManager = layoutManager</span><br><span class="line">        adapter = PlaceAdapter(<span class="keyword">this</span>, viewModel.placeList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">        searchPlaceEdit.addTextChangedListener &#123; editable -&gt;</span><br><span class="line">            <span class="keyword">val</span> content = editable.toString()</span><br><span class="line">            <span class="keyword">if</span> (content.isNotEmpty()) &#123;</span><br><span class="line">                viewModel.searchPlaces(content)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                recyclerView.visibility = View.GONE</span><br><span class="line">                bgImageView.visibility = View.VISIBLE</span><br><span class="line">                viewModel.placeList.clear()</span><br><span class="line">                adapter.notifyDataSetChanged()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        viewModel.placeLiveData.observe(viewLifecycleOwner, Observer&#123; result -&gt;</span><br><span class="line">            <span class="keyword">val</span> places = result.getOrNull()</span><br><span class="line">            <span class="keyword">if</span> (places != <span class="literal">null</span>) &#123;</span><br><span class="line">                recyclerView.visibility = View.VISIBLE</span><br><span class="line">                bgImageView.visibility = View.GONE</span><br><span class="line">                viewModel.placeList.clear()</span><br><span class="line">                viewModel.placeList.addAll(places)</span><br><span class="line">                adapter.notifyDataSetChanged()</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Toast.makeText(activity, <span class="string">&quot;未能查询到任何地点&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>将Fragment添加到Activity中</p><p>activity_main.xml中的代码:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.lmc.volcanoweather.ui.place.PlaceFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>隐藏原生的ActionBar</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107145752864.png" alt="image-20221107145752864"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.MaterialComponents.Light.NoActionBar&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>申请权限</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">package</span>=<span class="string">&quot;com.sunnyweather.android&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>结果：<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107150029243.png" alt="image-20221107150029243"></p><p>os：其实地方名，地址，经纬度都拿到了</p><h2 id="3-天气信息">3. 天气信息</h2><blockquote><ol start="2"><li><p>查询某地区实时天气：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/realtime.json  </code></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;**realtime**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;**temperature**&quot;</span><span class="punctuation">:</span> <span class="number">23.16</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**skycon**&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WIND&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**air_quality**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;aqi&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;chn&quot;</span><span class="punctuation">:</span> <span class="number">17.0</span> <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure></li><li><p>查询未来几天天气信息接口：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/daily.json  </code></p><p>返回的JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;daily&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;max&quot;</span><span class="punctuation">:</span> <span class="number">25.7</span><span class="punctuation">,</span> <span class="attr">&quot;min&quot;</span><span class="punctuation">:</span> <span class="number">20.3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;skycon&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CLOUDY&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2019-10-20T00:00+08:00&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;life_index&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coldRisk&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;易发&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;carWashing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;适宜&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ultraviolet&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;dressing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;舒适&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="3-1-逻辑">3.1 逻辑</h3><h4 id="3-1-1-数据模型">3.1.1 数据模型</h4><ol><li>RealtimeResponse</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107150555760.png" alt="image-20221107150555760"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">RealtimeResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> result: Result) &#123;</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span></span>(<span class="keyword">val</span> realtime: Realtime)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Realtime</span></span>(<span class="keyword">val</span> skycon: String, <span class="keyword">val</span> temperature: <span class="built_in">Float</span>,</span><br><span class="line">                        <span class="meta">@SerializedName(<span class="string">&quot;air_quality&quot;</span>)</span> <span class="keyword">val</span> airQuality: AirQuality)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">AirQuality</span></span>(<span class="keyword">val</span> aqi: AQI)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">AQI</span></span>(<span class="keyword">val</span> chn: <span class="built_in">Float</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所有数据模型类都定义在RealtimeResonse内部可以有效防止和其他接口的数据类型重名冲突的情况</p><ol start="2"><li>DailyResponse</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">DailyResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> result: Result) &#123;</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span></span>(<span class="keyword">val</span> daily: Daily)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Daily</span></span>(<span class="keyword">val</span> temperature: List&lt;Temperature&gt;, <span class="keyword">val</span> skycon: List&lt;Skycon&gt;,</span><br><span class="line">                     <span class="meta">@SerializedName(<span class="string">&quot;life_index&quot;</span>)</span> <span class="keyword">val</span> lifeIndex: LifeIndex)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Temperature</span></span>(<span class="keyword">val</span> max: <span class="built_in">Float</span>, <span class="keyword">val</span> min: <span class="built_in">Float</span>)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Skycon</span></span>(<span class="keyword">val</span> value: String, <span class="keyword">val</span> date: Date)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeIndex</span></span>(<span class="keyword">val</span> coldRisk: List&lt;LifeDescription&gt;, <span class="keyword">val</span> carWashing:</span><br><span class="line">    List&lt;LifeDescription&gt;, <span class="keyword">val</span> ultraviolet: List&lt;LifeDescription&gt;,</span><br><span class="line">                         <span class="keyword">val</span> dressing: List&lt;LifeDescription&gt;)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeDescription</span></span>(<span class="keyword">val</span> desc: String)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><p>整和上面两个的 Weather</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107152815165.png" alt="image-20221107152815165"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Weather</span></span>(<span class="keyword">val</span> realtime: RealtimeResponse.Realtime, <span class="keyword">val</span> daily: DailyResponse.Daily)</span><br></pre></td></tr></table></figure></li><li><p>Sky(这个是在UI后面补充的)</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107165606951.png" alt="image-20221107165606951"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sky</span></span>(<span class="keyword">val</span> info: String, <span class="keyword">val</span> icon: <span class="built_in">Int</span>, <span class="keyword">val</span> bg: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> sky = mapOf(</span><br><span class="line">    <span class="string">&quot;CLEAR_DAY&quot;</span> to Sky(<span class="string">&quot;晴&quot;</span>, R.drawable.ic_clear_day, R.drawable.bg_clear_day),</span><br><span class="line">    <span class="string">&quot;CLEAR_NIGHT&quot;</span> to Sky(<span class="string">&quot;晴&quot;</span>, R.drawable.ic_clear_night, R.drawable.bg_clear_night),</span><br><span class="line">    <span class="string">&quot;PARTLY_CLOUDY_DAY&quot;</span> to Sky(</span><br><span class="line">        <span class="string">&quot;多云&quot;</span>, R.drawable.ic_partly_cloud_day,</span><br><span class="line">        R.drawable.bg_partly_cloudy_day</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;PARTLY_CLOUDY_NIGHT&quot;</span> to Sky(</span><br><span class="line">        <span class="string">&quot;多云&quot;</span>, R.drawable.ic_partly_cloud_night,</span><br><span class="line">        R.drawable.bg_partly_cloudy_night</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;CLOUDY&quot;</span> to Sky(<span class="string">&quot;阴&quot;</span>, R.drawable.ic_cloudy, R.drawable.bg_cloudy),</span><br><span class="line">    <span class="string">&quot;WIND&quot;</span> to Sky(<span class="string">&quot;大风&quot;</span>, R.drawable.ic_cloudy, R.drawable.bg_wind),</span><br><span class="line">    <span class="string">&quot;LIGHT_RAIN&quot;</span> to Sky(<span class="string">&quot;小雨&quot;</span>, R.drawable.ic_light_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;MODERATE_RAIN&quot;</span> to Sky(<span class="string">&quot;中雨&quot;</span>, R.drawable.ic_moderate_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;HEAVY_RAIN&quot;</span> to Sky(<span class="string">&quot;大雨&quot;</span>, R.drawable.ic_heavy_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;STORM_RAIN&quot;</span> to Sky(<span class="string">&quot;暴雨&quot;</span>, R.drawable.ic_storm_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;THUNDER_SHOWER&quot;</span> to Sky(<span class="string">&quot;雷阵雨&quot;</span>, R.drawable.ic_thunder_shower, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;SLEET&quot;</span> to Sky(<span class="string">&quot;雨夹雪&quot;</span>, R.drawable.ic_sleet, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;LIGHT_SNOW&quot;</span> to Sky(<span class="string">&quot;小雪&quot;</span>, R.drawable.ic_light_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;MODERATE_SNOW&quot;</span> to Sky(<span class="string">&quot;中雪&quot;</span>, R.drawable.ic_moderate_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;HEAVY_SNOW&quot;</span> to Sky(<span class="string">&quot;大雪&quot;</span>, R.drawable.ic_heavy_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;STORM_SNOW&quot;</span> to Sky(<span class="string">&quot;暴雪&quot;</span>, R.drawable.ic_heavy_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;HAIL&quot;</span> to Sky(<span class="string">&quot;冰雹&quot;</span>, R.drawable.ic_hail, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;LIGHT_HAZE&quot;</span> to Sky(<span class="string">&quot;轻度雾霾&quot;</span>, R.drawable.ic_light_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;MODERATE_HAZE&quot;</span> to Sky(<span class="string">&quot;中度雾霾&quot;</span>, R.drawable.ic_moderate_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;HEAVY_HAZE&quot;</span> to Sky(<span class="string">&quot;重度雾霾&quot;</span>, R.drawable.ic_heavy_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;FOG&quot;</span> to Sky(<span class="string">&quot;雾&quot;</span>, R.drawable.ic_fog, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;DUST&quot;</span> to Sky(<span class="string">&quot;浮尘&quot;</span>, R.drawable.ic_fog, R.drawable.bg_fog)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getSky</span><span class="params">(skycon: <span class="type">String</span>)</span></span>: Sky &#123;</span><br><span class="line">    <span class="keyword">return</span> sky[skycon] ?: sky[<span class="string">&quot;CLEAR_DAY&quot;</span>]!!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="3-1-2-网络层">3.1.2 网络层</h4><h5 id="1-访问天气信息API的Retrofit接口">1. 访问天气信息API的Retrofit接口</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153005106.png" alt="image-20221107153005106"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.DailyResponse</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.RealtimeResponse</span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.GET</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.Path</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">WeatherService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2.5/<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>/&#123;lng&#125;,&#123;lat&#125;/realtime.json&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getRealtimeWeather</span><span class="params">(<span class="meta">@Path(<span class="string">&quot;lng&quot;</span>)</span> lng: <span class="type">String</span>, <span class="meta">@Path(<span class="string">&quot;lat&quot;</span>)</span> lat: <span class="type">String</span>)</span></span>:</span><br><span class="line">            Call&lt;RealtimeResponse&gt;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2.5/<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>/&#123;lng&#125;,&#123;lat&#125;/daily.json&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getDailyWeather</span><span class="params">(<span class="meta">@Path(<span class="string">&quot;lng&quot;</span>)</span> lng: <span class="type">String</span>, <span class="meta">@Path(<span class="string">&quot;lat&quot;</span>)</span> lat: <span class="type">String</span>)</span></span>:</span><br><span class="line">            Call&lt;DailyResponse&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-VolcanoWeatherNetwork网络数据源访问入口对新加的这个接口进行封装">2.VolcanoWeatherNetwork网络数据源访问入口对新加的这个接口进行封装</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153503788.png" alt="image-20221107153503788"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> VolcanoWeatherNetwork &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> weatherService = ServiceCreator.create(WeatherService::<span class="keyword">class</span>.java)</span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">getDailyWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> =</span><br><span class="line">    weatherService.getDailyWeather(lng, lat).await()</span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">getRealtimeWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> =</span><br><span class="line">    weatherService.getRealtimeWeather(lng, lat).await()</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-3-仓库层">3.1.3 仓库层</h4><ol><li>修改Repository中的代码：</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153731630.png" alt="image-20221107153731630"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.liveData</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Weather</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.network.VolcanoWeatherNetwork</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.Dispatchers</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.async</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.coroutineScope</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.CoroutineContext</span><br><span class="line"></span><br><span class="line"><span class="comment">//仓库层的统一封装入口</span></span><br><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = fire(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">val</span> placeResponse = VolcanoWeatherNetwork.searchPlaces(query)</span><br><span class="line">        <span class="keyword">if</span> (placeResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> places = placeResponse.places</span><br><span class="line">            Result.success(places)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Result.failure(RuntimeException(<span class="string">&quot;response status is <span class="subst">$&#123;placeResponse.status&#125;</span>&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> = fire(Dispatchers.IO) &#123;</span><br><span class="line">        coroutineScope &#123;</span><br><span class="line">            <span class="keyword">val</span> deferredRealtime = async &#123;</span><br><span class="line">                VolcanoWeatherNetwork.getRealtimeWeather(lng, lat)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> deferredDaily = async &#123;</span><br><span class="line">                VolcanoWeatherNetwork.getDailyWeather(lng, lat)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> realtimeResponse = deferredRealtime.await()</span><br><span class="line">            <span class="keyword">val</span> dailyResponse = deferredDaily.await()</span><br><span class="line">            <span class="comment">//这两个执行完才能往下走</span></span><br><span class="line">            <span class="keyword">if</span> (realtimeResponse.status == <span class="string">&quot;ok&quot;</span> &amp;&amp; dailyResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">val</span> weather = Weather(realtimeResponse.result.realtime,</span><br><span class="line">                    dailyResponse.result.daily)</span><br><span class="line">                Result.success(weather)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Result.failure(</span><br><span class="line">                    RuntimeException(</span><br><span class="line">                        <span class="string">&quot;realtime response status is <span class="subst">$&#123;realtimeResponse.status&#125;</span>&quot;</span> +</span><br><span class="line">                                <span class="string">&quot;daily response status is <span class="subst">$&#123;dailyResponse.status&#125;</span>&quot;</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//这个fire是升级过后的东西拉</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">fire</span><span class="params">(context: <span class="type">CoroutineContext</span>, block: <span class="type">suspend</span> () -&gt; <span class="type">Result</span>&lt;<span class="type">T</span>&gt;)</span></span> =</span><br><span class="line">        liveData&lt;Result&lt;T&gt;&gt;(context) &#123;</span><br><span class="line">            <span class="keyword">val</span> result = <span class="keyword">try</span> &#123;</span><br><span class="line">                block()</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">                Result.failure&lt;T&gt;(e)</span><br><span class="line">            &#125;</span><br><span class="line">            emit(result)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-4-ViewModel">3.1.4 ViewModel</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107160307510.png" alt="image-20221107160307510"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.wealther</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Transformations</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.Repository</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Location</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> locationLiveData = MutableLiveData&lt;Location&gt;()</span><br><span class="line">    <span class="comment">//下面三个都是和界面相关的数据，所以放在 ViewModel</span></span><br><span class="line">    <span class="keyword">var</span> locationLng = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> locationLat = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> placeName = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">//这个是转换LiveData观察用的</span></span><br><span class="line">    <span class="keyword">val</span> weatherLiveData = Transformations.switchMap(locationLiveData) &#123; location -&gt;</span><br><span class="line">        Repository.refreshWeather(location.lng, location.lat)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        locationLiveData.value = Location(lng, lat)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-UI">3.2 UI</h3><h4 id="3-2-1-显示天气的Activity">3.2.1 显示天气的Activity</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161254732.png" alt="image-20221107161254732"></p><p>activity_weather.xml（这个在创建Activity的时候会自动创建） 会是很长的一个布局，我们用引用布局的形式。</p><h4 id="3-2-2-now">3.2.2 now</h4><p>当前天气信息布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161927746.png" alt="image-20221107161927746"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161905024.png" alt="image-20221107161905024"></p><h4 id="3-2-3-forecast">3.2.3 forecast</h4><p>未来几天天气信息布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162109721.png" alt="image-20221107162109721"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162402138.png" alt="image-20221107162402138"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">    xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">    android:layout_marginLeft=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    android:layout_marginRight=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    android:layout_marginTop=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    app:cardCornerRadius=<span class="string">&quot;4dp&quot;</span>&gt;</span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:orientation=<span class="string">&quot;vertical&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_marginStart=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">            android:layout_marginTop=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">            android:layout_marginBottom=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;预报&quot;</span></span><br><span class="line">            android:textColor=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span><br><span class="line">            android:textSize=<span class="string">&quot;20sp&quot;</span>/&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:id=<span class="string">&quot;@+id/forecastLayout&quot;</span></span><br><span class="line">            android:orientation=<span class="string">&quot;vertical&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span>&gt;</span><br><span class="line">        &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/com.google.android.material.card.MaterialCardView&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-4-fprecast-item">3.2.4 fprecast_item</h4><p>未来天气信息的子项布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162540732.png" alt="image-20221107162540732"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162940272.png" alt="image-20221107162940272"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/dateInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/skyIcon&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;20dp&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/skyInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/temperatureInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;end&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-5-life-index">3.2.5 life_index</h4><p>生活指数的布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164104493.png" alt="image-20221107164104493"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164800332.png" alt="image-20221107164800332"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164937530.png" alt="image-20221107164937530"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;生活指数&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;20dp&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/coldRiskImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_coldrisk&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/coldRiskImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;感冒&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/coldRiskText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/dressingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_dressing&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/dressingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;穿衣&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/dressingText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;20dp&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/ultravioletImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_ultraviolet&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/ultravioletImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;实时紫外线&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/ultravioletText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/carWashingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_carwashing&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/carWashingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;洗车&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/carWashingText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-6-引入">3.2.6 引入</h4><p>将上面4个模块加载进显示天气的Activity</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107165138692.png" alt="image-20221107165138692"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/weatherLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:scrollbars</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:overScrollMode</span>=<span class="string">&quot;never&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:visibility</span>=<span class="string">&quot;invisible&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/now&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/forecast&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/life_index&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-7-Sky转换函数准备">3.2.7 Sky转换函数准备</h4><p>见3.1.1 最后一个</p><h4 id="3-2-8-WeatherActivity下">3.2.8 WeatherActivity下</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.wealther</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Observer</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Weather</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.getSky</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_weather.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.forecast.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.life_index.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.now.*</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(WeatherViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_weather)</span><br><span class="line">        <span class="comment">//下面三个是从Intent中去除经纬坐标和地区名称</span></span><br><span class="line">        <span class="keyword">if</span> (viewModel.locationLng.isEmpty()) &#123;</span><br><span class="line">            viewModel.locationLng = intent.getStringExtra(<span class="string">&quot;location_lng&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (viewModel.locationLat.isEmpty()) &#123;</span><br><span class="line">            viewModel.locationLat = intent.getStringExtra(<span class="string">&quot;location_lat&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (viewModel.placeName.isEmpty()) &#123;</span><br><span class="line">            viewModel.placeName = intent.getStringExtra(<span class="string">&quot;place_name&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//观察天气LiveData，当获取到服务器返回数据就展示出来</span></span><br><span class="line">        viewModel.weatherLiveData.observe(<span class="keyword">this</span>, Observer &#123; result -&gt;</span><br><span class="line">            <span class="keyword">val</span> weather = result.getOrNull()</span><br><span class="line">            <span class="keyword">if</span> (weather != <span class="literal">null</span>) &#123;</span><br><span class="line">                showWeatherInfo(weather)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;无法成功获取天气信息&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        viewModel.refreshWeather(viewModel.locationLng, viewModel.locationLat)<span class="comment">//执行了一次刷新天气的请求</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showWeatherInfo</span><span class="params">(weather: <span class="type">Weather</span>)</span></span> &#123;</span><br><span class="line">        placeName.text = viewModel.placeName</span><br><span class="line">        <span class="keyword">val</span> realtime = weather.realtime</span><br><span class="line">        <span class="keyword">val</span> daily = weather.daily</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充now.xml布局中的数据</span></span><br><span class="line">        <span class="keyword">val</span> currentTempText = <span class="string">&quot;<span class="subst">$&#123;realtime.temperature.toInt()&#125;</span> ℃&quot;</span></span><br><span class="line">        currentTemp.text = currentTempText</span><br><span class="line">        currentSky.text = getSky(realtime.skycon).info</span><br><span class="line">        <span class="keyword">val</span> currentPM25Text = <span class="string">&quot;空气指数 <span class="subst">$&#123;realtime.airQuality.aqi.chn.toInt()&#125;</span>&quot;</span></span><br><span class="line">        currentAQI.text = currentPM25Text</span><br><span class="line">        nowLayout.setBackgroundResource(getSky(realtime.skycon).bg)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充forecast.xml布局中的数据</span></span><br><span class="line">        forecastLayout.removeAllViews()</span><br><span class="line">        <span class="keyword">val</span> days = daily.skycon.size</span><br><span class="line">        <span class="comment">//下面这个循环是拿到未来每天的天气信息</span></span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0</span> until days) &#123;</span><br><span class="line">            <span class="keyword">val</span> skycon = daily.skycon[i]</span><br><span class="line">            <span class="keyword">val</span> temperature = daily.temperature[i]</span><br><span class="line">            <span class="keyword">val</span> view = LayoutInflater.from(<span class="keyword">this</span>).inflate(</span><br><span class="line">                R.layout.forecast_item,</span><br><span class="line">                forecastLayout, <span class="literal">false</span></span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">val</span> dateInfo = view.findViewById(R.id.dateInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> skyIcon = view.findViewById(R.id.skyIcon) <span class="keyword">as</span> ImageView</span><br><span class="line">            <span class="keyword">val</span> skyInfo = view.findViewById(R.id.skyInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> temperatureInfo = view.findViewById(R.id.temperatureInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> simpleDateFormat = SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>, Locale.getDefault())</span><br><span class="line">            dateInfo.text = simpleDateFormat.format(skycon.date)</span><br><span class="line">            <span class="keyword">val</span> sky = getSky(skycon.value)</span><br><span class="line">            skyIcon.setImageResource(sky.icon)</span><br><span class="line">            skyInfo.text = sky.info</span><br><span class="line">            <span class="keyword">val</span> tempText = <span class="string">&quot;<span class="subst">$&#123;temperature.min.toInt()&#125;</span> ~ <span class="subst">$&#123;temperature.max.toInt()&#125;</span> ℃&quot;</span></span><br><span class="line">            temperatureInfo.text = tempText</span><br><span class="line">            forecastLayout.addView(view)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充life_index.xml布局中的数据</span></span><br><span class="line">        <span class="keyword">val</span> lifeIndex = daily.lifeIndex</span><br><span class="line">        <span class="comment">//生活指数有很多天的，我们只拿出当天的</span></span><br><span class="line">        coldRiskText.text = lifeIndex.coldRisk[<span class="number">0</span>].desc</span><br><span class="line">        dressingText.text = lifeIndex.dressing[<span class="number">0</span>].desc</span><br><span class="line">        ultravioletText.text = lifeIndex.ultraviolet[<span class="number">0</span>].desc</span><br><span class="line">        carWashingText.text = lifeIndex.carWashing[<span class="number">0</span>].desc</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//获取了所有数据要让他们显示出来</span></span><br><span class="line">        weatherLayout.visibility = View.VISIBLE</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-9-界面跳转">3.2.9 界面跳转</h4><p>从搜索城市界面跳转到天气界面</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107171916611.png" alt="image-20221107171916611"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: Fragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList: List&lt;Place&gt;) :</span><br><span class="line">RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">    <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">    parent, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">val</span> holder = ViewHolder(view)</span><br><span class="line">    holder.itemView.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> position = holder.adapterPosition</span><br><span class="line">    <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(parent.context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    fragment.startActivity(intent)</span><br><span class="line">    fragment.activity?.finish()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> holder</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果出现这个Bug：</p><p><code>    android.content.ActivityNotFoundException: Unable to find explicit activity class &#123;com.lmc.volcanoweather/com.lmc.volcanoweather.ui.wealther.WeatherActivity&#125;; have you declared this activity in your AndroidManifest.xml?</code></p><p>则AndroidManifest.xml这里改一下：看图</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173037558.png" alt="image-20221107173037558"></p><p>我ui下面weather包名之前写错了，之前是wealther 现在改过来了weather</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173054749.png" alt="image-20221107173054749"></p></blockquote><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173351243.png" alt="image-20221107173351243"></p><p>美化：</p><p>之前美化是用的Material库来做的，虽然优秀但是复杂。今天来个更简单的实现方式。</p><p>WeatherActivity中：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">   /下面这里是设置那个状态栏的</span><br><span class="line">        <span class="keyword">val</span> decorView = window.decorView</span><br><span class="line">        decorView.systemUiVisibility =</span><br><span class="line">            View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN or View.SYSTEM_UI_FLAG_LAYOUT_STABLE<span class="comment">//这行表示Activity的布局会显示在状态栏上</span></span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT<span class="comment">//将状态栏设置为透明色</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这时候，天气界面的布局整体向上偏移了一些——丑：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107182716540.png" alt="image-20221107182716540"></p><p>os：其实也还好，怕以后工作产品狗挑毛病也写一下好了</p><p>修改：now.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/nowLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;530dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/titleLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这一行是让系统状态栏留出空间。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107183046983.png" alt="image-20221107183046983"></p><p>好像确实更优雅了</p><h3 id="3-3-记录选中城市">3.3 记录选中城市</h3><h4 id="3-3-1-存储准备">3.3.1 存储准备</h4><ol><li><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191559967.png" alt="image-20221107191559967"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.dao</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.provider.Settings.Global.putString</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.edit</span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"></span><br><span class="line"><span class="keyword">object</span> PlaceDao &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> &#123;</span><br><span class="line">        sharedPreferences().edit &#123;</span><br><span class="line">            putString(<span class="string">&quot;place&quot;</span>, Gson().toJson(place))<span class="comment">//利用这个GSON将一个place对象转成一个JSON字符串再去存就很划算</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span>: Place &#123;</span><br><span class="line">        <span class="keyword">val</span> placeJson = sharedPreferences().getString(<span class="string">&quot;place&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> Gson().fromJson(placeJson, Place::<span class="keyword">class</span>.java)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断数据是否又被存储</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = sharedPreferences().contains(<span class="string">&quot;place&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">sharedPreferences</span><span class="params">()</span></span> = VolcanoWeatherApplication.context.</span><br><span class="line">    getSharedPreferences(<span class="string">&quot;sunny_weather&quot;</span>, Context.MODE_PRIVATE)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>仓库中封装一下</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191808930.png" alt="image-20221107191808930"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> = PlaceDao.savePlace(place)</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span> = PlaceDao.getSavedPlace()</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = PlaceDao.isPlaceSaved()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>PlaceViewModel中再进行一次封装</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191955822.png" alt="image-20221107191955822"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> = Repository.savePlace(place)</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span> = Repository.getSavedPlace()</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = Repository.isPlaceSaved()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="3-3-2-实现">3.3.2 实现</h4><h5 id="PlaceAdapter">PlaceAdapter</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107192230429.png" alt="image-20221107192230429"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: PlaceFragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList:</span><br><span class="line">List&lt;Place&gt;) : RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">    <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">    parent, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">val</span> holder = ViewHolder(view)</span><br><span class="line">    holder.itemView.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> position = holder.adapterPosition</span><br><span class="line">    <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(parent.context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    fragment.viewModel.savePlace(place)</span><br><span class="line">    fragment.startActivity(intent)</span><br><span class="line">    fragment.activity?.finish()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> holder</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进行两处修改：</p><ol><li>先把 PlaceAdapter 主构造函数中传入的 Fragment 对象改成 PlaceFragment 对象</li><li>当点击了任何子项布局时，在跳转到 WeatherActivity 之前，先调用 PlaceViewModel 的 savePlace() 方法来存储选中的城市。</li></ol><h5 id="PlaceFragment">PlaceFragment</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107192833343.png" alt="image-20221107192833343"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">    <span class="keyword">if</span> (viewModel.isPlaceSaved()) &#123;</span><br><span class="line">    <span class="keyword">val</span> place = viewModel.getSavedPlace()</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    startActivity(intent)</span><br><span class="line">    activity?.finish()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>验证了一下几乎成了</p><h2 id="4-手动刷新天气-切换城市">4.手动刷新天气&amp;切换城市</h2><blockquote><p>有个Bug：选中某个地方就没办法查看其他城市的天气了。</p></blockquote><h3 id="4-1-手动刷新天气">4.1 手动刷新天气</h3><p>直接用下拉控件就可以了</p><ol><li><p>在ScrollView的外面嵌套了一层SwipeRefreshLayout</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108150656151.png" alt="image-20221108150656151"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/swipeRefresh&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/weatherLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:overScrollMode</span>=<span class="string">&quot;never&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:scrollbars</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:visibility</span>=<span class="string">&quot;invisible&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>WeatherActivity 中加入刷新天气的处理逻辑：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108150818662.png" alt="image-20221108150818662"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"><span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(WeatherViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    viewModel.weatherLiveData.observe(<span class="keyword">this</span>, Observer &#123; result -&gt;</span><br><span class="line">    <span class="keyword">val</span> weather = result.getOrNull()</span><br><span class="line">    <span class="keyword">if</span> (weather != <span class="literal">null</span>) &#123;</span><br><span class="line">    showWeatherInfo(weather)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;无法成功获取天气信息&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">    result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">    &#125;</span><br><span class="line">    swipeRefresh.isRefreshing = <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">    swipeRefresh.setColorSchemeResources(R.color.design_default_color_primary)</span><br><span class="line">    refreshWeather()</span><br><span class="line">    swipeRefresh.setOnRefreshListener &#123;</span><br><span class="line">    refreshWeather()</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">()</span></span> &#123;</span><br><span class="line">    viewModel.refreshWeather(viewModel.locationLng, viewModel.locationLat)</span><br><span class="line">    swipeRefresh.isRefreshing = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>其实吧，没啥大区别，你进去就是最新的天气信息。再刷新下子有啥作用尼？</p><h3 id="4-2-切换城市">4.2 切换城市</h3><p>想着是通过滑动菜单来做</p><h4 id="4-2-1-头布局加个切换按钮">4.2.1 头布局加个切换按钮</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108151942198.png" alt="image-20221108151942198"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/nowLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;530dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/titleLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/navBtn&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@drawable/ic_home&quot;</span> /&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-2-2-实现滑动菜单功能">4.2.2 实现滑动菜单功能</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108152223568.png" alt="image-20221108152223568"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/swipeRefresh&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;start&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:clickable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:focusable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@color/design_default_color_primary&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.lmc.volcanoweather.ui.place.PlaceFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;25dp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在SwipeRefreshLayout的外面又嵌套了一层DrawerLayout,第一个是主屏幕中的内容，第二个是滑动菜单中的内容</p><h4 id="4-2-3-滑动菜单逻辑">4.2.3 滑动菜单逻辑</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108153659654.png" alt="image-20221108153659654"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        ...</span><br><span class="line">        navBtn.setOnClickListener &#123;</span><br><span class="line">            drawerLayout.openDrawer(GravityCompat.START)</span><br><span class="line">        &#125;</span><br><span class="line">        drawerLayout.addDrawerListener(<span class="keyword">object</span> : DrawerLayout.DrawerListener &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerStateChanged</span><span class="params">(newState: <span class="type">Int</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerSlide</span><span class="params">(drawerView: <span class="type">View</span>, slideOffset: <span class="type">Float</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerOpened</span><span class="params">(drawerView: <span class="type">View</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerClosed</span><span class="params">(drawerView: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">                <span class="comment">//滑动菜单隐藏的时候也隐藏输入法</span></span><br><span class="line">            <span class="keyword">val</span> manager = getSystemService(Context.INPUT_METHOD_SERVICE)</span><br><span class="line">            <span class="keyword">as</span> InputMethodManager</span><br><span class="line">            manager.hideSoftInputFromWindow(drawerView.windowToken,</span><br><span class="line">            InputMethodManager.HIDE_NOT_ALWAYS)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有个Bug：</p><blockquote><p>之前在PlaceFragment中做过一个数据存储状态的判断，假如已经有选中的城市保<br>存在SharedPreferences文件中了，那么就直接跳转到WeatherActivity。但是现在将<br>PlaceFragment嵌入WeatherActivity中之后，如果还执行这段逻辑肯定是不行的，因为这会<br>造成无限循环跳转的情况。为此需要对PlaceFragment进行如下修改：</p><p>???</p></blockquote><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108154643471.png" alt="image-20221108154643471"></p><p>加了一层逻辑判断条件</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">        <span class="keyword">if</span> (activity <span class="keyword">is</span> MainActivity &amp;&amp; viewModel.isPlaceSaved()) &#123;</span><br><span class="line">            <span class="keyword">val</span> place = viewModel.getSavedPlace()</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">            putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">            putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">            putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">            &#125;</span><br><span class="line">            startActivity(intent)</span><br><span class="line">            activity?.finish()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>切换城市后的逻辑:</p><p>之前选中了某个城市后是跳转到WeatherActivity的，而现在由于我们本来就是<br>在WeatherActivity中的，因此并不需要跳转，只要去请求新选择城市的天气信息就可以了。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108155127067.png" alt="image-20221108155127067"></p><p>出现一个空指针BUG</p><blockquote><p>解决办法：<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108160359323.png" alt="image-20221108160359323"></p><p>这两个方法一定要放在最上面</p></blockquote><h2 id="5-制作APP图标">5. 制作APP图标</h2><p>从 Android8 开始app图标应该是两层：前景层和背景层。</p><p>前景层：APP的logo</p><p>背景层：衬托APP的Logo（只能定义颜色和纹理，不可以有形状）</p><p>图标形状由手机厂商来决定（mask）</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109161923535.png" alt="image-20221109161923535"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109162022438.png" alt="image-20221109162022438"></p><h2 id="6-生成正式签名的APK文件文件">6. 生成正式签名的APK文件文件</h2><p>之前测试的安卓APP是AS有个默认的keystore文件帮我们自动进行了签名（gradle负责）</p><h3 id="6-1-AS生成">6.1 AS生成</h3><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109162800822.png" alt="image-20221109162800822"></p><p>这个也不好演示，看视频好耶</p><h3 id="6-2-Gradle生成">6.2 Gradle生成</h3><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109165813855.png" alt="image-20221109165813855"></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;org.jetbrains.kotlin.android&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;kotlin-android-extensions&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdk <span class="number">32</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.lmc.volcanoweather&quot;</span></span><br><span class="line">        minSdk <span class="number">21</span></span><br><span class="line">        targetSdk <span class="number">32</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line"></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        config &#123;</span><br><span class="line">            storeFile file(<span class="string">&#x27;/Users/Mecenlee/Mecenlee.jks&#x27;</span>)</span><br><span class="line">            storePassword <span class="string">&#x27;594946&#x27;</span></span><br><span class="line">            keyAlias = <span class="string">&#x27;Mecenleedev&#x27;</span></span><br><span class="line">            keyPassword <span class="string">&#x27;594946&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">            signingConfig signingConfigs.config</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        jvmTarget = <span class="string">&#x27;1.8&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.core:core-ktx:1.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.google.android.material:material:1.4.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.recyclerview:recyclerview:1.2.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-extensions:2.2.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-livedata-ktx:2.5.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.1.0&quot;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:retrofit:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:converter-gson:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.1&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.1&quot;</span></span><br><span class="line"></span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.13.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-优化点">7.优化点</h2><h2 id="8-总结">8.总结</h2><p>弱项：</p><ol><li>网络部分，尤其是Retrofit</li><li>RecycleView的一些列操作</li><li>Fragment</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;火山天气&lt;/h1&gt;
&lt;p&gt;天气API：&lt;a href=&quot;https://dashboard.caiyunapp.com/v1/token/&quot;&gt;彩云科技 | 开放平台 (caiyunapp.com)&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;查询全</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="项目" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/"/>
    
    <category term="Android" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/Android/"/>
    
    
    <category term="项目" scheme="http://lmc.pub/tags/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>Bug合集</title>
    <link href="http://lmc.pub/2022/10/05/CSDN/"/>
    <id>http://lmc.pub/2022/10/05/CSDN/</id>
    <published>2022-10-05T15:43:31.000Z</published>
    <updated>2023-03-20T09:09:36.143Z</updated>
    
    <content type="html"><![CDATA[<h1>CSDN</h1><h2 id="一，电脑使用Bugs">一，电脑使用Bugs</h2><ol><li><p>打字的时候输入空格光标后面一个字被删除了？</p><blockquote><p>键盘输入有两个模式：一个是<strong>插入格式</strong>，一个是<strong>改写模式</strong>；</p><p>一般我们习惯的是插入模式，上述描绘的就是从<code>插入模式</code>不小心进入<code>改写模式</code>后的情况。</p><p><strong>解决办法</strong>：按下键盘上<code>delete</code>旁边的<code>Insert</code>键就换回来了</p></blockquote></li><li><p>Sublime 怎么写Kotlin</p></li></ol><ul><li>去这个网址<a href="https://github.com/vkostyukov/kotlin-sublime-package">vkostyukov/kotlin-sublime-package: Sublime Text 2 Package for Kotlin Programming Language (github.com)</a></li><li>下这个<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221127134651203.png" alt="image-20221127134651203"></li><li>移到 Sublime 下的packages目录下</li><li>把名字改为 Kotlin.sublime-package（之前是kotlin.zip）</li><li>重启sublime</li><li>好了<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221127134922269.png" alt="image-20221127134922269"></li></ul><h2 id="二，编程Bugs">二，编程Bugs</h2><h3 id="2-1">2.1</h3><p>错误: 编码 GBK 的不可映射字符</p><blockquote><p>Bug场景：</p><p>用 <strong>Sublime Text</strong> 写 Java 代码，然后再输入<code>命令提示符</code>:cmd,打开<code>命令提示符窗口</code>:DOS(也叫<code>终端</code>)。</p><p>在<code>javac</code>预编译 java 文件的时候，提示报错：文件名.java:行数 错误：<strong>编码 GBK 的不可映射字符</strong> （0x几几）</p><p>原因：</p><p>Win 下 DOS 默认编码格式是 GBK，但是 java 源码文件默认是 Unicode ，所以两个冲突导致汉字被编译成了乱码。（只有 Win 上会冲突，Mac 不会）</p><p>解决：没次写完 java 源文件，手动保存为 GBK 格式。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221123065331350.png" alt="image-20221123065331350"></p></blockquote><h3 id="2-2">2.2</h3><p>Invocation failed Unexpected end of file from server java.lang.RuntimeException: Invocation failed Unexpected end of file from server</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126170159836.png" alt="image-20221126170159836"></p><p>描述：AS push 代码到github，可视化那个点push说失败。</p><p>解决：在终端手动输入：git push</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126170410269.png" alt="image-20221126170410269"></p><h3 id="2-3">2.3</h3><p>Android Studio右侧工具栏的Gradle页签没有Task任务列表没有Task任务列表</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126215712157.png" alt="image-20221126215712157"></p><p>原因：新版AS默认不显示</p><p>解决：file-》settings</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126220019707.png" alt="image-20221126220019707"><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126221318777.png" alt="image-20221126221318777"></p><p>好了<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221126221410396.png" alt="image-20221126221410396"></p><h3 id="2-4">2.4</h3><p>Android Studio 中res资源目录下的图片命名规范：</p><ol><li>别英文大写。都必须是英文小写。</li></ol><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221215162129516.png" alt="image-20221215162129516"></p><ol start="2"><li><p>不能有空格。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221215162413744.png" alt="image-20221215162413744"></p></li></ol><h3 id="2-5">2.5</h3><p>res资源文件夹命名易错细节：</p><ol><li>连接后缀的符号是 <code>-</code> 而不是<code>——</code> 或者 <code>_</code>。</li><li>输入法中文英文都可以，但是输入那个杠他是短的，然后是在中间的。</li><li>正确的输入方法：不按住Shift 输入小横线（中英文无异）、</li></ol><p>错误举例：</p><ul><li><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221215162641920.png" alt="image-20221215162641920"></li></ul><p>这个符号更长</p><ul><li><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221215163148106.png" alt="image-20221215163148106"></li></ul><p>这个符号在下面。</p><blockquote><p>总结：写错了，他不会报错。但是引用包的时候会出现莫名Bug。又是一个小细节。</p></blockquote><h3 id="2-6">2.6</h3><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219114137622.png" alt="image-20221219114137622"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221219114217579.png" alt="image-20221219114217579"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;CSDN&lt;/h1&gt;
&lt;h2 id=&quot;一，电脑使用Bugs&quot;&gt;一，电脑使用Bugs&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;打字的时候输入空格光标后面一个字被删除了？&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;键盘输入有两个模式：一个是&lt;strong&gt;插入格式&lt;/strong&gt;，</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Bug" scheme="http://lmc.pub/tags/Bug/"/>
    
  </entry>
  
  <entry>
    <title>AS的一个Bug</title>
    <link href="http://lmc.pub/2022/10/05/Device%20File%20Explorer%20There%20were%20errors%20downloading%20files%20andor%20directories%20Cannot%20delete%20&#39;CUsersMicenleeDesktop/"/>
    <id>http://lmc.pub/2022/10/05/Device%20File%20Explorer%20There%20were%20errors%20downloading%20files%20andor%20directories%20Cannot%20delete%20&#39;CUsersMicenleeDesktop/</id>
    <published>2022-10-05T15:43:31.000Z</published>
    <updated>2023-03-20T09:10:24.340Z</updated>
    
    <content type="html"><![CDATA[<hr><h2 id="Device-File-Explorer-There-were-errors-downloading-files-and-or-directories-Cannot-delete-‘C-Users-Micenlee-Desktop-BookStore-db’">Device File Explorer /There were errors downloading files and/or directories:/ Cannot delete ‘C:\Users\Micenlee\Desktop\BookStore.db’</h2><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914125755795.png" alt="image-20220914125755795"></p><p>上 Android 课的时候，到了SQLite。在 Device File Explorer 中准备把 db文件另存为时候。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914125946032.png" alt="image-20220914125946032"></p><p>保存目录下有同名文件</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914130225271.png" alt="image-20220914130225271"></p><p>保存就报错说，删除不了原来同名文件。</p><blockquote><p>stackoverflow该问题解答（唯一中文就是俺写的）：<a href="https://stackoverflow.com/questions/52202720/android-studio-device-file-explorer-gets-stuck-when-downloading-a-file">https://stackoverflow.com/questions/52202720/android-studio-device-file-explorer-gets-stuck-when-downloading-a-file</a></p></blockquote><p>实际原因：</p><p>自己在AS中的DB Browser 中已经打开了，而在win11 下，已经打开的文件是删除不了的</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914130547642.png" alt="image-20220914130547642"></p><p>解决：</p><p>打开DB Browser ,跟图操作</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914130751440.png" alt="image-20220914130751440"></p><p>把这所有的connection 全 删了（选中一个点一下➖）</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914130827360.png" alt="image-20220914130827360"></p><p>然后再回去 Save As就好了</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220914131001014.png" alt="image-20220914131001014"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;h2 id=&quot;Device-File-Explorer-There-were-errors-downloading-files-and-or-directories-Cannot-delete-‘C-Users-Micenlee-Desktop-BookStore-d</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="Bug" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Bug/"/>
    
    
    <category term="Bug" scheme="http://lmc.pub/tags/Bug/"/>
    
  </entry>
  
  <entry>
    <title>Android实战项目《音乐APP》</title>
    <link href="http://lmc.pub/2022/10/05/Android%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E3%80%8A%E9%9F%B3%E4%B9%90APP%E3%80%8B/"/>
    <id>http://lmc.pub/2022/10/05/Android%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E3%80%8A%E9%9F%B3%E4%B9%90APP%E3%80%8B/</id>
    <published>2022-10-05T15:43:31.000Z</published>
    <updated>2023-03-20T09:07:43.782Z</updated>
    
    <content type="html"><![CDATA[<h1>Android实战项目《音乐APP》</h1><h2 id="一，引入">一，引入</h2><h4 id="1-0-碎片">1.0  碎片</h4><blockquote><p>2023/03/14 begin</p></blockquote><p>包含内容</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314132711672.png" alt="image-20230314132711672"></p><hr><p>学习的本质是：模仿</p><p>看课的时候怎么避免问题：什么东西全部跟视频演示的一样。想改最后自己再去优化。</p><p>解决bug几大狠招：清除项目缓存/清除开发工具缓存/重启开发工具/重启电脑</p><p>怎么看代码是否有问题？有一个小功能就测试一下，并git，这样哪里出了问题就回去</p><p>源码覆盖法：源码 Beyond Compare 看哪里抄错了</p><p>搜索引擎：必应 or 谷歌（用原始提示）</p><p>不行就联系我</p><p>怎么提问：准备自己做了很多尝试，依然不能解决。且搜索引擎解决不了。</p><p>提问格式：</p><ul><li>详细描述问题</li><li>贴上相关代码（别截图）</li><li>贴上报错日志</li><li>已经尝试那些方法也没有solve，附上链接</li></ul><p>《提问的艺术》</p><hr><p>找到自己的学习方法？</p><ul><li><p>好的学习方法</p><blockquote><p>看着视频跟着敲每一行代码。</p><p>实在不懂就先在一个地方记下来，然后学完了回来看看。</p><p>优点是：学习效果很好</p><p>缺点是：耗费极大的时间和精力</p></blockquote></li><li><p>中等</p><blockquote><p>对着视频敲关键代码，其他的直接复制源码</p></blockquote></li><li><p>下等</p><blockquote><p>速看一边课程，只有遇到了就去看笔记，看不懂就在去看书。</p></blockquote></li></ul><hr><p>我们做的课用心点</p><p><strong>视频</strong></p><ul><li>清晰:笔记本全屏录制，字体</li><li>去除多余时间：录播课</li><li>去除杂音</li><li>无干扰</li><li>统一编辑器配置</li><li>支持完全离线学习：阿里云盘（在线卡，清晰度2.8k）</li></ul><p><strong>在线电子书</strong>（为什么不用pdf）</p><ul><li>代码高亮</li><li>代码格式化</li><li>电子书配图</li><li>删除无用消息</li><li>网址处理，点就直达</li><li>提供离线PDF</li></ul><p><strong>代码</strong></p><ul><li>完整课程运行配套代码</li><li>完整Git提交历史</li></ul><p><strong>答疑</strong></p><p>QQ/微信/群/远程桌面/语音</p><p>时间：早5晚11</p><p><strong>有效期</strong></p><p>X年 -》 技术过期</p><p><strong>不足之处</strong></p><ul><li>有问题联系我</li><li>严重会重新录制</li></ul><hr><p>普通开发还有前途嘛？</p><p>2014就会四大组件就轻松月薪过万</p><p>中高级开发 ：1~2 w（大体一致，不同城市不同公司有所区别）</p><p>你只会Android基础，找不到很正常</p><p><strong>My opinion</strong>：</p><p>网上在吹，前端，Android，IOS不行了，学大数据，机械学习，人工智能，python</p><p>其实，如果你做了几年Android或者其他，发现找不到工作饿了，干不下去。</p><p>那我们可以很负责的告诉你：就算你去做Java了，做go了，做前端了你干几年还是同样会被淘汰，</p><p>因为你一直没掌握核心技术，一直停留在表层。而这个层次的人太多了，所以你找到工作的概率就很小。</p><hr><h3 id="1-1-版本控制-Git">1.1 版本控制:Git</h3><h4 id="一，准备阶段">一，准备阶段</h4><h5 id="1-安装-v2">1. 安装</h5><blockquote><p>下载：<a href="https://gitforwindows.org/">Git for Windows</a></p></blockquote><p>无脑式下一步。</p><p>git –version，出现下面 git 就是安装好了。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314154601364.png" alt="image-20230314154601364"></p><h5 id="2-配置用户信息-v2">2. 配置用户信息</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;xxx&quot;</span><br><span class="line"></span><br><span class="line">git config --global user.email &quot;xxx@qq.com&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-创建仓库-v2">3. 创建仓库</h5><p>你想让哪一个文件夹成为 git 仓库就在它下面打开 git bash 然后输下面这个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git git init</span><br></pre></td></tr></table></figure><p>这个文件夹下面就会有一个 .git 文件。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170738200.png" alt="image-20230314170738200"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170817463.png" alt="image-20230314170817463"></p><h5 id="4-查看仓库状态-v2">4. 查看仓库状态</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git git status</span><br></pre></td></tr></table></figure><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314170836047.png" alt="image-20230314170836047"></p><h4 id="二，暂存区-v2">二，暂存区</h4><blockquote><p>准备工作：在文件夹下搞个文件。（最好英文名）</p></blockquote><h5 id="1-添加到暂存区-v2">1. 添加到暂存区</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 添加指定文件</span><br><span class="line">git add 文件名</span><br><span class="line"></span><br><span class="line"># 添加这个仓库文件夹下的所有文件</span><br><span class="line">git add -A</span><br></pre></td></tr></table></figure><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314171905546.png" alt="image-20230314171905546"></p><h5 id="2-暂存区回来-v2">2. 暂存区回来</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git restore 文件名</span><br><span class="line">git restore --staged 文件名</span><br></pre></td></tr></table></figure><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314171931261.png" alt="image-20230314171931261"></p><h4 id="三，本地仓库-v2">三，本地仓库</h4><h5 id="1-提交到本地仓库-v2">1. 提交到本地仓库</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;这次提交干了什么事的描述（建议英文）&quot;</span><br></pre></td></tr></table></figure><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314172124631.png" alt="image-20230314172124631"></p><h5 id="2-从本地仓库回来-v2">2. 从本地仓库回来</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 恢复到上一次</span><br><span class="line">git reset --hard HEAD~</span><br><span class="line"></span><br><span class="line"># 恢复到指定提交</span><br><span class="line">git reset --hard 提交id</span><br></pre></td></tr></table></figure><p>本地仓库里有很多版本，用这个会直接把你的那个文件回到指令中的那个版本。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314172813969.png" alt="image-20230314172813969"></p><h5 id="3-查看提交历史-v2">3. 查看提交历史</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure><h3 id="1-2-Git可视化（Gitfork）">1.2 Git可视化（Gitfork）</h3><blockquote><ul><li><p>Gitfork</p></li><li><p>TortoiseGit(小乌龟)</p></li><li><p>GitHub for Desktop</p></li><li><p>SourceTree</p></li></ul></blockquote><p>GitFork</p><ol><li><p>地址：<a href="https://git-fork.com/">Fork - a fast and friendly git client for Mac and Windows (git-fork.com)</a></p></li><li><p>选择仓库目录：preference -》 默认源文件夹 —》选择 然后扫描</p></li><li><p>打开/切换仓库：<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314193859347.png" alt="image-20230314193859347"></p></li><li><p>创建仓库：<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314194502531.png" alt="image-20230314194502531"></p></li><li><p>添加，提交，返回<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314200410228.png" alt="image-20230314200410228"></p></li><li><p>回滚：<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314201433987.png" alt="image-20230314201433987"><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230314201449391.png" alt="image-20230314201449391"></p></li></ol><h3 id="1-3-GitHub-Gitee">1.3 GitHub/Gitee</h3><p>注册</p><p>忽略文件。。。</p><h3 id="1-4-Postman">1.4 Postman</h3><p>是什么？</p><p>一个管理接口的工具</p><p>下载：<a href="https://www.postman.com/">https://www.postman.com/</a></p><p>怎么导入API：</p><p>怎么导出API</p><h3 id="1-5-怎么搭建Java开发环境">1.5 怎么搭建Java开发环境</h3><h3 id="1-6-怎么搭建Android开发环境">1.6 怎么搭建Android开发环境</h3><h3 id="1-7-Android-Studio入门">1.7 Android Studio入门</h3><ul><li>新建项目</li><li>AS用GitHub</li><li>夜神模拟器 + Anlink 最佳调试</li></ul><hr><h2 id="问题">问题</h2><ol><li>为什么<code>Installation did not succeed. The application could not be installed: INSTALL_FAILED_USER_RESTRICTED</code></li></ol><p><img src="../AppData/Roaming/Typora/typora-user-images/image-20230318113819528.png" alt="image-20230318113819528"></p><p>手机要手动点 安装。</p><ol start="2"><li><p>怎么关闭小米手机这个，USB安装提示弹窗？</p><p>开发者模式关闭 MIUI优化，然后去应用管理中的权限管理，然后右上角有个三个点。进去把那个USB关了。</p></li><li><p>为什么ASpushGithub总是无法连接或者超时？<img src="../AppData/Local/Temp/WeChat%20Files/6485f350ecec674f9b29da03b349aed.png" alt="6485f350ecec674f9b29da03b349aed"></p><p>网不行，跟博客 hexo d 推不上去一样。多推几次或者换个翻墙节点。<img src="../AppData/Roaming/Typora/typora-user-images/image-20230318133353271.png" alt="image-20230318133353271"></p></li></ol><h2 id="AS小技巧">AS小技巧</h2><p>ctrl + Alt + F ：变量全局化</p><p>ctrl + alt + v ：var 命名变量</p><p>shift + shift ：搜索方法或者类</p><p>ctrl + f：在这个文件中搜关键字</p><p>ctrl + shift + backspace ：回到上一次编辑的地方。</p><p>ctrl + fn + f12 ：查看当前类的方法结构</p><p>shit + fn + f6 ：全局改一个变量的命名（重构）</p><p>都用三杯吐 xxh挺好，然后都用dp不要用px</p><p>ctrl + shfit + enter</p><p>fn + alt + insert :构造器 getset方法那个</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Android实战项目《音乐APP》&lt;/h1&gt;
&lt;h2 id=&quot;一，引入&quot;&gt;一，引入&lt;/h2&gt;
&lt;h4 id=&quot;1-0-碎片&quot;&gt;1.0  碎片&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;2023/03/14 begin&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;包含内容&lt;</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="项目" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/"/>
    
    <category term="Android" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/Android/"/>
    
    
    <category term="项目" scheme="http://lmc.pub/tags/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>PermissionX</title>
    <link href="http://lmc.pub/2022/10/05/PermissionX/"/>
    <id>http://lmc.pub/2022/10/05/PermissionX/</id>
    <published>2022-10-05T15:43:31.000Z</published>
    <updated>2023-03-23T09:02:00.745Z</updated>
    
    <content type="html"><![CDATA[<h1>PermissionX</h1><h2 id="一，预备知识">一，预备知识</h2><p>SDK——开源库</p><ol><li>没有界面</li><li>是逻辑功能</li><li>做好的工具库SDK是被其他项目引用</li><li>面向其他开发者做的</li><li>稳定工作，提供简单的接口给其他开发者</li></ol><p>PermissionX</p><p>简化获取运行时权限的资源库</p><h2 id="二，怎么写自己的SDK？">二，怎么写自己的SDK？</h2><h3 id="1-新建一个-Android-项目，名字是你想给这个开源库的名字">1. 新建一个 Android 项目，名字是你想给这个开源库的名字</h3><h3 id="2-加一个模块">2. 加一个模块</h3><p>之前我们都在app下面写，写出来的都是app</p><p>现在我们自己开一个library，写开源库</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221125183151093.png" alt="image-20221125183151093"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221125183309358.png" alt="image-20221125183309358"></p><h3 id="3-库模块和app模块的区别">3. 库模块和app模块的区别</h3><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221125183558828.png" alt="image-20221125183558828"></p><h3 id="4-实现设想">4. 实现设想</h3><p>运行时权限API封装一般要特定上下文依赖，且还要回调处理</p><p>市面的解决办法：</p><ul><li>BaseActivity</li><li>透明的Activity</li><li>Fragment中申请运行时权限</li></ul><p>why？</p><p>优势：不像Activity那样要界面，可以搞个隐藏的Fragment然后在他里面去对运行时权限的API进行封装。且对本来的Activity性能没有影响。</p><h3 id="5-代码实现">5. 代码实现</h3><h4 id="InvisibleFragment-隐形Fragment">InvisibleFragment-隐形Fragment</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221125190531640.png" alt="image-20221125190531640"></p><p>第一版：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.mylibrary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvisibleFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    <span class="comment">//运行时权限申请结果的回调通知</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> callback: ((<span class="built_in">Boolean</span>, List&lt;String&gt;) -&gt; <span class="built_in">Unit</span>)? = <span class="literal">null</span></span><br><span class="line">    <span class="comment">//申请权限的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">requestNow</span><span class="params">(cb: (<span class="type">Boolean</span>, <span class="type">List</span>&lt;<span class="type">String</span>&gt;) -&gt; <span class="type">Unit</span>, <span class="keyword">vararg</span> permissions: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        callback = cb</span><br><span class="line">        requestPermissions(permissions, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//处理运行时权限的申请结果</span></span><br><span class="line">    <span class="meta">@Deprecated(<span class="string">&quot;Deprecated in Java&quot;</span>)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onRequestPermissionsResult</span><span class="params">(requestCode: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                                            permissions: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;, grantResults: <span class="type">IntArray</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (requestCode == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> deniedList = ArrayList&lt;String&gt;()</span><br><span class="line">            <span class="keyword">for</span> ((index, result) <span class="keyword">in</span> grantResults.withIndex()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (result != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                    deniedList.add(permissions[index])</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> allGranted = deniedList.isEmpty()</span><br><span class="line">            callback?.let &#123; it(allGranted, deniedList) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>第二版，优化函数类型参数写的复杂冗余后</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.mylibrary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"></span><br><span class="line"><span class="comment">//typealias : 给任意类型指定一个别名（更加简介了）</span></span><br><span class="line"><span class="keyword">typealias</span> PermissionCallback = (<span class="built_in">Boolean</span>, List&lt;String&gt;) -&gt; <span class="built_in">Unit</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvisibleFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    <span class="comment">//运行时权限申请结果的回调通知</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> callback: PermissionCallback? = <span class="literal">null</span></span><br><span class="line">    <span class="comment">//申请权限的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">requestNow</span><span class="params">(cb: <span class="type">PermissionCallback</span>, <span class="keyword">vararg</span> permissions: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        callback = cb</span><br><span class="line">        requestPermissions(permissions, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//处理运行时权限的申请结果</span></span><br><span class="line">    <span class="meta">@Deprecated(<span class="string">&quot;Deprecated in Java&quot;</span>)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onRequestPermissionsResult</span><span class="params">(requestCode: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                                            permissions: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;, grantResults: <span class="type">IntArray</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (requestCode == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> deniedList = ArrayList&lt;String&gt;()</span><br><span class="line">            <span class="keyword">for</span> ((index, result) <span class="keyword">in</span> grantResults.withIndex()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (result != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                    deniedList.add(permissions[index])</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> allGranted = deniedList.isEmpty()</span><br><span class="line">            callback?.let &#123; it(allGranted, deniedList) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="PermissionX-对外接口">PermissionX-对外接口</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.mylibrary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.FragmentActivity</span><br><span class="line"><span class="comment">//单例类是为了咱这个类中的方法更容易被调用</span></span><br><span class="line"><span class="keyword">object</span> PermissionX &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">val</span> TAG = <span class="string">&quot;InvisibleFragment&quot;</span></span><br><span class="line">    <span class="comment">//注解：FragmentActivity 是 AppCompatActivity 的父类（不信 Ctrl+H）</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">request</span><span class="params">(activity: <span class="type">FragmentActivity</span>, <span class="keyword">vararg</span> permissions: <span class="type">String</span>, callback:</span></span></span><br><span class="line"><span class="params"><span class="function">     <span class="type">PermissionCallback</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> fragmentManager = activity.supportFragmentManager<span class="comment">//获取FragmentManager的实例</span></span><br><span class="line">        <span class="keyword">val</span> existedFragment = fragmentManager.findFragmentByTag(TAG)</span><br><span class="line">        <span class="keyword">val</span> fragment = <span class="keyword">if</span> (existedFragment != <span class="literal">null</span>) &#123;</span><br><span class="line">            existedFragment <span class="keyword">as</span> InvisibleFragment</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> invisibleFragment = InvisibleFragment()</span><br><span class="line">            <span class="comment">//把invisibleFragment加进Activity</span></span><br><span class="line">            fragmentManager.beginTransaction().add(invisibleFragment, TAG).commitNow()<span class="comment">//这里不能换成commit（否则下面这个作为返回值返回的时候是没有那个i——Fragment的 // ）</span></span><br><span class="line">            invisibleFragment</span><br><span class="line">        &#125;</span><br><span class="line">        fragment.requestNow(callback, *permissions)<span class="comment">//*：表示将一个数组转换成可变长度参数传递过去</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三，测试">三，测试</h2><p>app模块中引入library模块</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126162625003.png" alt="image-20221126162625003"></p><p>xml写个按钮，然后AndroidManifest.xml里面要什么权限，就写什么权限。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.CALL_PHONE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_CONTACTS&quot; /&gt;</span><br></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.permissionx</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.Manifest</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.widget.Button</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> com.lmc.mylibrary.PermissionX</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        findViewById&lt;Button&gt;(R.id.makeCallBtn).setOnClickListener &#123;</span><br><span class="line">            PermissionX.request(<span class="keyword">this</span>,  Manifest.permission.CALL_PHONE,</span><br><span class="line">                Manifest.permission.WRITE_EXTERNAL_STORAGE,</span><br><span class="line">                Manifest.permission.READ_CONTACTS) &#123; &#123;</span><br><span class="line">                allGranted,deniedList -&gt;</span><br><span class="line">                <span class="keyword">if</span> (allGranted) &#123;</span><br><span class="line">                    call()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;你取消授权：<span class="variable">$deniedList</span>&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(Intent.ACTION_CALL)</span><br><span class="line">            intent.<span class="keyword">data</span> = Uri.parse(<span class="string">&quot;tel:10086&quot;</span>)</span><br><span class="line">            startActivity(intent)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e:SecurityException)&#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="四，发布开源库">四，发布开源库</h2><blockquote><p>两个棘手问题：</p><ol><li><p>第一行代码中的那个JCenter用不了，现在我们试一下MavenCentral</p></li><li><p>还有Gradle也变了，那个AndroidStudio中Project下的build.gradle根本就没有没有buildscript和allprojects了（移到了另外一个地方）</p><p>2022年冬天的：</p><p>build.gradle<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126191331879.png" alt="image-20221126191331879"></p><p>在这里<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126191402261.png" alt="image-20221126191402261"></p></li></ol></blockquote><h3 id="准备域名">准备域名</h3><p>我的：lmc.pub</p><h3 id="创建工单">创建工单</h3><ol><li><p>注册一下这个<a href="https://issues.sonatype.org/secure/Dashboard.jspa">sonatype</a></p><p>账号邮箱，密码要有大写。</p></li><li><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126193038946.png" alt="image-20221126193038946"></p></li><li><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126194627496.png" alt="image-20221126194627496"></p><p>这里就1按这个来，23看下面这张</p></li><li><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126195545268.png" alt="image-20221126195545268"></p></li></ol><p>然后马上就会发一条邮件到你邮箱，点进去</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126195939437.png" alt="image-20221126195939437"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126195952499.png" alt="image-20221126195952499"></p><p>等下又来一个：<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126200605520.png" alt="image-20221126200605520"></p><p>教你去给域名加一条TXT解析，内容给你了就是工单编号</p><p>登录域名管理的网站（我的是阿里云，那这个举例子）</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126201618462.png" alt="image-20221126201618462"></p><p>控制台-》域名</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126201652919.png" alt="image-20221126201652919"></p><p>解析<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126201731296.png" alt="image-20221126201731296"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126202306113.png" alt="image-20221126202306113"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126205419905.png" alt="image-20221126205419905"></p><p>然后我们就可以向 <strong><a href="http://s01.oss.sonatype.org">s01.oss.sonatype.org</a></strong> 这个地址发布库</p><p>MavenCentral还要求，所有发布的库都必须使用GPG来进行签名才行</p><p>下载 GnuPG</p><p>我是win <a href="https://www.gpg4win.org/download.html">https://www.gpg4win.org/download.html</a></p><p>win记得只能下这个（你要是去了官网，这个下载地址在老下面，很容易下了前面的原始的。原始后果就是后面那个代码跑不起来）</p><p>然后找个文件夹安装好（我的在D盘）</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126211042610.png" alt="image-20221126211042610"></p><p>密钥创建</p><p>gpg --full-generate-key</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126211600799.png" alt="image-20221126211600799"></p><p>然后会跳出来下面这个，设一个密码</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126211244258.png" alt="image-20221126211244258"></p><p>然后</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126211701568.png" alt="image-20221126211701568"></p><p>第二行后8位记下来</p><p>E8B132DC</p><p>上传公钥到GPC服务器</p><p>gpg --keyserver <a href="http://keyserver.ubuntu.com">keyserver.ubuntu.com</a> --send-keys 你的后8位数</p><p>gpg --keyserver <a href="http://keyserver.ubuntu.com">keyserver.ubuntu.com</a> --recv-keys 你的后8位数</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126212253389.png" alt="image-20221126212253389"></p><p>导出私钥</p><p>gpg --export-secret-keys  -o 你想保存的地址+secring.gpg</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126212759209.png" alt="image-20221126212759209"></p><p>gradle-<a href="https://so.csdn.net/so/search?q=maven&amp;spm=1001.2101.3001.7020">maven</a>-publish-plugin这样一个第三方开源插件</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126213151138.png" alt="image-20221126213151138"></p><p>项目根目录下的gradle.properties文件</p><p>GROUP=com.guolindev.glance<br>POM_ARTIFACT_ID=glance<br>VERSION_NAME=1.0.0</p><p>POM_NAME=Glance<br>POM_DESCRIPTION=A simple and handy Android database debugging library.<br>POM_INCEPTION_YEAR=2020<br>POM_URL=https://github.com/guolindev/Glance/</p><p>POM_LICENSE_NAME=The Apache Software License, Version 2.0<br>POM_LICENSE_URL=https://www.apache.org/licenses/LICENSE-2.0.txt<br>POM_LICENSE_DIST=repo</p><p>POM_SCM_URL=https://github.com/guolindev/Glance/<br>POM_SCM_CONNECTION=scm:git:git://github.com/guolindev/Glance.git<br>POM_SCM_DEV_CONNECTION=scm:git:ssh://github.com/guolindev/Glance.git</p><p>POM_DEVELOPER_ID=guolindev<br>POM_DEVELOPER_NAME=Lin Guo<br>POM_DEVELOPER_URL=https://github.com/guolindev/</p><p>signing.keyId=密钥ID的后8位<br>signing.password=密钥密码<br>signing.secretKeyRingFile=私钥文件路径</p><p>mavenCentralUsername=Sonatype账号<br>mavenCentralPassword=Sonatype密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">GROUP=pub.lmc.androidlib</span><br><span class="line">POM_ARTIFACT_ID=permissionx</span><br><span class="line">VERSION_NAME=1.0.0</span><br><span class="line"></span><br><span class="line">POM_NAME=PermissionX</span><br><span class="line">POM_DESCRIPTION=Android开发中更方便的申请运行时权限.</span><br><span class="line">POM_INCEPTION_YEAR=2022</span><br><span class="line">POM_URL=https://github.com/Mecenlee/PermissionX/</span><br><span class="line"></span><br><span class="line">POM_LICENSE_NAME=The Apache Software License, Version 2.0</span><br><span class="line">POM_LICENSE_URL=https://www.apache.org/licenses/LICENSE-2.0.txt</span><br><span class="line">POM_LICENSE_DIST=repo</span><br><span class="line"></span><br><span class="line">POM_SCM_URL=https://github.com/Mecenlee/PermissionX/</span><br><span class="line">POM_SCM_CONNECTION=scm:git:git://github.com/Mecenlee/PermissionX.git</span><br><span class="line">POM_SCM_DEV_CONNECTION=scm:git:ssh://github.com/Mecenlee/PermissionX.git</span><br><span class="line"></span><br><span class="line">POM_DEVELOPER_ID=mecenlee</span><br><span class="line">POM_DEVELOPER_NAME=Mincan Li</span><br><span class="line">POM_DEVELOPER_URL=https://github.com/Mecenlee/</span><br><span class="line"></span><br><span class="line">signing.keyId=密钥ID的后8位</span><br><span class="line">signing.password=密钥密码</span><br><span class="line">signing.secretKeyRingFile=私钥文件路径（记得带.gpg）</span><br><span class="line"></span><br><span class="line">mavenCentralUsername=Sonatype用户名</span><br><span class="line">mavenCentralPassword=Sonatype密码</span><br></pre></td></tr></table></figure><p>前三行决定开源库地址</p><p>pub.lmc.androidlib:permissionx:1.0.0</p><p>其他的照着写写</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126215453897.png" alt="image-20221126215453897"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126215949736.png" alt="image-20221126215949736"></p><p>在Android Studio右侧工具栏的Gradle页签当中找到publish这个任务（找不到正常上网搜，我遇到且解决了。写了解决方案在CSDN）</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126222014109.png" alt="image-20221126222014109"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126225024193.png" alt="image-20221126225024193"></p><p>然后我们的sonatype主页就给你发消息说在同步了</p><p>第一个网址几十分钟就好了 <a href="https://repo1.maven.org/maven2/">https://repo1.maven.org/maven2/</a></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126225154656.png" alt="image-20221126225154656"></p><p>第二个要等一会</p><p><a href="https://search.maven.org/">https://search.maven.org/</a></p><p>然后在这里才能搜到你的那个开源库</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221126225222374.png" alt="image-20221126225222374"></p><p>以后用这个库就</p><p>dependencies {<br>implementation ‘pub.lmc.androidlib:permissionxr:1.0.0’<br>}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;PermissionX&lt;/h1&gt;
&lt;h2 id=&quot;一，预备知识&quot;&gt;一，预备知识&lt;/h2&gt;
&lt;p&gt;SDK——开源库&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;没有界面&lt;/li&gt;
&lt;li&gt;是逻辑功能&lt;/li&gt;
&lt;li&gt;做好的工具库SDK是被其他项目引用&lt;/li&gt;
&lt;li&gt;面向其他开发者做的&lt;</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="项目" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/"/>
    
    <category term="Android" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E9%A1%B9%E7%9B%AE/Android/"/>
    
    
    <category term="项目" scheme="http://lmc.pub/tags/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>不使用方向键，快速移动光标，跳出括号</title>
    <link href="http://lmc.pub/2022/10/05/%E4%B8%8D%E4%BD%BF%E7%94%A8%E6%96%B9%E5%90%91%E9%94%AE%EF%BC%8C%E5%BF%AB%E9%80%9F%E7%A7%BB%E5%8A%A8%E5%85%89%E6%A0%87%EF%BC%8C%E8%B7%B3%E5%87%BA%E6%8B%AC%E5%8F%B7/"/>
    <id>http://lmc.pub/2022/10/05/%E4%B8%8D%E4%BD%BF%E7%94%A8%E6%96%B9%E5%90%91%E9%94%AE%EF%BC%8C%E5%BF%AB%E9%80%9F%E7%A7%BB%E5%8A%A8%E5%85%89%E6%A0%87%EF%BC%8C%E8%B7%B3%E5%87%BA%E6%8B%AC%E5%8F%B7/</id>
    <published>2022-10-05T15:43:31.000Z</published>
    <updated>2023-03-20T09:13:08.718Z</updated>
    
    <content type="html"><![CDATA[<h1>不使用方向键，快速移动光标，跳出括号</h1><p>编程中我们写了一个<code>()</code>之后，一般光标会自动留在里面，想要移动出来就需要去用方向键，但是方向键比较远容易打乱我们的思维。</p><p>经过上网找寻，找到几个解决办法：</p><ol><li>在括号里面输入括号的右半部分。比如在<code>()</code>中输入<code>)</code>,<code>&#123;&#125;</code>中输入<code>&#125;</code>。其实就是自己完整的打出来<code>&#123;&#125;</code>,一般是你输入<code>&#123;</code>就会补全<code>&#123;&#125;</code>。这时候你自己先输入<code>&#123;</code>然后再输入<code>&#125;</code>。光标就在括号外边啦；</li><li><code>Shift</code>+<code>Enter</code> 其实这个是直接跳到下一行开头，也算是一定程度上实现了这个需求；</li><li>下载一个小工具：Caplock+ ，然后可以用 <code>Caplock</code>+ <code>ESDF</code>完全代替 <code>方向键</code></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;不使用方向键，快速移动光标，跳出括号&lt;/h1&gt;
&lt;p&gt;编程中我们写了一个&lt;code&gt;()&lt;/code&gt;之后，一般光标会自动留在里面，想要移动出来就需要去用方向键，但是方向键比较远容易打乱我们的思维。&lt;/p&gt;
&lt;p&gt;经过上网找寻，找到几个解决办法：&lt;/p&gt;
&lt;ol&gt;
&lt;li</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="工具" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="AS" scheme="http://lmc.pub/tags/AS/"/>
    
  </entry>
  
  <entry>
    <title>【Bug】Android 用OkHttp去访问Apache上的xml文件结果连接失败或者超时</title>
    <link href="http://lmc.pub/2022/10/05/%E3%80%90Bug%E3%80%91Android-%E7%94%A8OkHttp%E5%8E%BB%E8%AE%BF%E9%97%AEApache%E4%B8%8A%E7%9A%84xml%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%9C%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%E6%88%96%E8%80%85%E8%B6%85%E6%97%B6/"/>
    <id>http://lmc.pub/2022/10/05/%E3%80%90Bug%E3%80%91Android-%E7%94%A8OkHttp%E5%8E%BB%E8%AE%BF%E9%97%AEApache%E4%B8%8A%E7%9A%84xml%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%9C%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%E6%88%96%E8%80%85%E8%B6%85%E6%97%B6/</id>
    <published>2022-10-05T09:43:00.000Z</published>
    <updated>2023-03-20T08:54:13.899Z</updated>
    
    <content type="html"><![CDATA[<h1>Android 用OkHttp去访问Apache上的xml文件结果连接失败或者超时</h1><blockquote><p>解决的主要问题：</p><ol><li>java.net.ConnectException: Failed to connect to</li><li>java.net.ConnectException: Connection timed out</li></ol></blockquote><h2 id="一，情况描述">一，情况描述</h2><p>昨天备课到《第一行代码 第三版》的第十一章的 11.3小节解析XML数据，他是说，自己搭建一个Apache服务器在自己电脑上（也有问题，已经解决前面有篇博客写了），然后准备了一个xml文件在Apaches上。然后我们在AS中用OkHttp去访问这个Apache读取这个xml文件并拿回来解析。</p><p>但是在按照书上写的来做之后一直在报错：开始是说连接失败(<code>java.net.ConnectException: Failed to connect to</code>)。后来上网查找原因又去改，又出来连接超时（<code> java.net.ConnectException: Connection timed out</code>）的问题。</p><p>网上给出的结果有很多：防火墙的原因，网络原因，还有OkHttp和Apache服务器的默认网络超时设置……再统统试过之后发现其实是代码中的IP原因。</p><h2 id="二，总结">二，总结</h2><h3 id="正确用法">正确用法</h3><p>写的程序如果是运行在手机，则手机和电脑要在同一个WiFI下面；如果是运行在虚拟机其实虚拟机和电脑就是在同一个WiFi下。</p><p>然后拿到电脑主机在当前WiFi下的IP（怎末拿到看下面），然后如果你的Apache没有改端口还是80就可以直接<code>http://ip/get_data.xml</code>，如果改成了别的端口（比如8066）那就需要在IP后面加上现在的端口，比如：<code>http://ip:8066/get_data.xml</code></p><h3 id="怎末拿到电脑在当前WiFi下的正确IP">怎末拿到电脑在当前WiFi下的正确IP?</h3><p><code>win+R</code> 然后输入<code>cmd</code>回车调出来黑框框，然后指令输入<code>ipconfig</code>回车,然后下拉到最下面就可以看到了</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005174652534.png" alt="image-20221005174652534"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005174827274.png" alt="image-20221005174827274"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005175019223.png" alt="image-20221005175019223"></p><h3 id="网上其他可能原因分析">网上其他可能原因分析</h3><h4 id="localhost">localhost</h4><p>这个不行的原因是他跑到不管你的手机还是虚拟机，它指的都不是电脑主机了，而是手机的localhost或者虚拟机的localhost，所以才会出现Failed to connect 的问题</p><h4 id="10-0-2-2">10.0.2.2</h4><p>《第一行代码 第三版》中用的 10.0.2.2 其实是郭霖老师他跑在AS的虚拟机，然后这个IP指的就是AS虚拟机外面的电脑主机IP，不过看格式来说也有一种可能是他截图的时候他家电脑连他家的WiFi然后这个情况下他的电脑在这个WiFi下的IP就是 10.0.2.2。但是这个是用不了的，还是Failed to connect 问题。</p><h4 id="其他">其他</h4><p>此外什么Apache和OkHttp超时设置也是不需要的（有很大一部分回答是说这个能解决，其实不是）,防火墙也不是关键，一般不用管，如果担心可能会有影响可以自己关了</p><h2 id="三，自己当时的求证和探寻过程">三，自己当时的求证和探寻过程</h2><h3 id="test1">test1</h3><p>该次成功条件：</p><blockquote><p>电脑防火墙全关了</p><p>程序是跑在手机（真机）上</p><p>手机开热点，电脑连热点（两个在同一个WiFI下）</p><p>url地址用的是电脑的<code>无线局域网适配器 WLAN</code>哪里的IPv4地址</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005150144188.png" alt="image-20221005150144188"></p><h3 id="test2">test2</h3><p>这次打开电脑全部防火墙 -》 成功 说明不是防火墙的原因</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005150635677.png" alt="image-20221005150635677"></p><h3 id="test3">test3</h3><p>跑虚拟机</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005150937068.png" alt="image-20221005150937068"></p><h3 id="test4">test4</h3><p>手机和电脑都连校园网，那么这里的url中那个IP地址就要改了，要改成现在电脑和手机练的WiFi下的电脑主机IP，否者会提示不能连接目标端口。</p><blockquote><p>怎末知道？</p><p>打开电脑命令提示符黑框框</p><p>然后输入ipconfig回车</p><p>那个<code>无限区域网适配器 WLAN</code>下的IPv4的地址就是结果</p><p>！！！注意是WLAN下的，什么以太网，什么本地连接也有相像的，不是那个！！！</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005151722929.png" alt="image-20221005151722929"></p><h3 id="test5">test5</h3><p>电脑连接Wifi，手机用流量，程序跑手机结果如下</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005152508930.png" alt="image-20221005152508930"></p><h3 id="test6">test6</h3><p>电脑连接WiFi，然后程序跑在虚拟机还是可以的。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005152813804.png" alt="image-20221005152813804"></p><h3 id="test7">test7</h3><p>《第一行代码 第三版》中的那个IP是不行的，本来这个10.0.2.2 是跑在AS虚拟机</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005153438492.png" alt="image-20221005153438492"></p><h3 id="test8">test8</h3><p>用localhost跑在虚拟机</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005154600506.png" alt="image-20221005154600506"></p><h3 id="test9">test9</h3><p>用localhost跑在同一个WIFI下的手机</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221005154757468.png" alt="image-20221005154757468"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Android 用OkHttp去访问Apache上的xml文件结果连接失败或者超时&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;解决的主要问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;java.net.ConnectException: Failed to connect to&lt;/li</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="Bug" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Bug/"/>
    
    <category term="Android" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Bug/Android/"/>
    
    
    <category term="Bug" scheme="http://lmc.pub/tags/Bug/"/>
    
  </entry>
  
  <entry>
    <title>Apache下载安装</title>
    <link href="http://lmc.pub/2022/10/04/Apache%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85/"/>
    <id>http://lmc.pub/2022/10/04/Apache%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85/</id>
    <published>2022-10-04T13:57:00.000Z</published>
    <updated>2023-03-20T08:53:31.466Z</updated>
    
    <content type="html"><![CDATA[<h1>Windows下载安装Apache</h1><blockquote><p>作者：李敏烂</p><p>Mac和Linux自带了Apache就不用来凑热闹了。</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="白嫖资源/干货推荐/快快关注吧"></p><h2 id="一，下载源">一，下载源</h2><p>官方下载网址：<a href="https://httpd.apache.org/download.cgi#apache24">https://httpd.apache.org/download.cgi#apache24</a></p><p>我蓝奏云放了一个Apache最新版的可用的压缩包：<a href="https://wwc.lanzoum.com/ianTZ0d4iksj">https://wwc.lanzoum.com/ianTZ0d4iksj</a></p><p>上面两个都可以</p><h2 id="二，从官网下载">二，从官网下载</h2><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004191312983.png" alt="image-20221004191312983"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004191452198.png" alt="image-20221004191452198"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004191640759.png" alt="image-20221004191640759"></p><p>然后我这边就会弹出下载窗口</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004191721347.png" alt="image-20221004191721347"></p><h2 id="三，用蓝奏云的压缩包">三，用蓝奏云的压缩包</h2><p>这里的这个下载的压缩包我放在蓝奏云了：<a href="https://wwc.lanzoum.com/ianTZ0d4iksj">https://wwc.lanzoum.com/ianTZ0d4iksj</a></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004192120955.png" alt="image-20221004192120955"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004192220480.png" alt="image-20221004192220480"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004192422351.png" alt="image-20221004192422351"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004194058520.png" alt="image-20221004194058520"></p><p>双击打开这个 <code>Apache24</code>,然后赋值此时的地址，然后再点开conf文件夹</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004194231651.png" alt="image-20221004194231651"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004194503554.png" alt="image-20221004194503554"></p><p>然后 win + Q 或者直接来到桌面点下图中任务栏中的放大镜</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004194754753.png" alt="image-20221004194754753"></p><p>回到刚才D盘下面那个Apach24目录然后点进去bin目录，赋值bin所在的地址</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004195028478.png" alt="image-20221004195028478"></p><p>在命令提示符那个黑框框里面输入<code>cd /d D:\Apache24\bin</code> 后面那个是刚才 复制的bin 的路径</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004195150182.png" alt="image-20221004195150182"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004195542823.png" alt="image-20221004195542823"></p><h2 id="四，问题：端口被占用的解决">四，问题：端口被占用的解决</h2><p>接输入<code>netstat -ano</code>查一下电脑端口使用情况</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004195805621.png" alt="image-20221004195805621"></p><p>你这里也可能是80 号端口被某一个代号的占用了，记下来这个代号</p><p>直接<code>tasklist |findstr 8340</code>（后面辣个8340就是占用的代号，你是多少这里就填多少）</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004200116268.png" alt="image-20221004200116268"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004200720747.png" alt="image-20221004200720747"></p><p>不一定非要改为444端口，没有程序在用的端口就可以了</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004200956047.png" alt="image-20221004200956047"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004201036120.png" alt="image-20221004201036120"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004201340212.png" alt="image-20221004201340212"></p><p>记得每一个文件修改过都要保存（Ctrl+S）</p><h2 id="五，解决了问题继续">五，解决了问题继续</h2><p>然后再回到命令提示符黑框框重新安装一次</p><p><code>httpd -k uninstall</code></p><p><code>httpd -k install</code></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004203404174.png" alt="image-20221004203404174"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004203711501.png" alt="image-20221004203711501"></p><p>右击点开后，选择最上面那个Open。。。出来下面界面。如果有什么管理员授权直接给就好了</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004203833205.png" alt="image-20221004203833205"></p><p>来到浏览器网址框输入：<code>localhost:8088</code>(如果你当初那个80端口改了，这里后面就填你改的端口)</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004204119557.png" alt="image-20221004204119557"></p><p>多说一嘴：</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221004192658983.png" alt="image-20221004192658983"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Windows下载安装Apache&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;作者：李敏烂&lt;/p&gt;
&lt;p&gt;Mac和Linux自带了Apache就不用来凑热闹了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://article-picture-</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="其他" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/"/>
    
    <category term="Apache" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/Apache/"/>
    
    
    <category term="Apache" scheme="http://lmc.pub/tags/Apache/"/>
    
  </entry>
  
  <entry>
    <title>Typora美化主题</title>
    <link href="http://lmc.pub/2022/10/03/Typora%E7%BE%8E%E5%8C%96%E4%B8%BB%E9%A2%98/"/>
    <id>http://lmc.pub/2022/10/03/Typora%E7%BE%8E%E5%8C%96%E4%B8%BB%E9%A2%98/</id>
    <published>2022-10-03T13:57:00.000Z</published>
    <updated>2023-03-20T08:53:07.513Z</updated>
    
    <content type="html"><![CDATA[<h1>Typora美化主题</h1><blockquote><p>作者：李敏烂</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="白嫖资源/干货推荐/快快关注吧"></p><h2 id="一，主题获取">一，主题获取</h2><ol><li>官网：<a href="https://theme.typora.io/">https://theme.typora.io/</a></li><li>百度搜索：Typora主题推荐</li><li>文章结尾的阿里云网盘链接：我在用的</li></ol><h2 id="二，怎么换主题">二，怎么换主题</h2><ol><li>把主题压缩包下载下来解压成文件夹</li><li>打开Typora，左上角文件-》偏好设置-》左边外观-》打开主题文件夹</li><li>把你下载的主题文件夹中的<code>.css</code>文件粘贴复制到2中打开的主题文件夹</li><li>重启 Typora，上面主题就有了</li></ol><h2 id="三，主题欣赏">三，主题欣赏</h2><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190650012.png" alt="image-20221003190650012"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190709215.png" alt="image-20221003190709215"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190721761.png" alt="image-20221003190721761"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190738616.png" alt="image-20221003190738616"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190757626.png" alt="image-20221003190757626"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190816556.png" alt="image-20221003190816556"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190831253.png" alt="image-20221003190831253"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190851302.png" alt="image-20221003190851302"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190914399.png" alt="image-20221003190914399"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003190934936.png" alt="image-20221003190934936"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003191013309.png" alt="image-20221003191013309"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003191040778.png" alt="image-20221003191040778"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003191056166.png" alt="image-20221003191056166"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20221003191117429.png" alt="image-20221003191117429"></p><h2 id="四，我的主题合集资源">四，我的主题合集资源</h2><blockquote><p>TyporaThemes <a href="https://www.aliyundrive.com/s/Raei5yXxYYM">https://www.aliyundrive.com/s/Raei5yXxYYM</a> 点击链接保存，或者复制本段内容，打开「阿里云盘」APP ，无需下载极速在线查看，视频原画倍速播放。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Typora美化主题&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;作者：李敏烂&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="其他" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/"/>
    
    <category term="工具" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="Typora" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/%E5%B7%A5%E5%85%B7/Typora/"/>
    
    
    <category term="Typora" scheme="http://lmc.pub/tags/Typora/"/>
    
  </entry>
  
  <entry>
    <title>《吐血推荐！全网Android最硬核findViewById替代方案》</title>
    <link href="http://lmc.pub/2022/07/30/findViewById%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/"/>
    <id>http://lmc.pub/2022/07/30/findViewById%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/</id>
    <published>2022-07-30T02:47:00.000Z</published>
    <updated>2023-03-20T08:51:21.051Z</updated>
    
    <content type="html"><![CDATA[<h1>《吐血推荐！全网Android最硬核findViewById替代方案》</h1><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="白嫖资源/干货推荐/快快关注吧">更多白嫖资源/干货推荐/快快关注吧</p><blockquote><p>一篇获取布局中的元素的通神文</p><p>作者AS版本：Android Studio 2021.2.1稳定版：代号“花栗鼠”</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805113558620.png" alt="image-20220805113558620"></p><p>实验时间：2022/08/05</p></blockquote><h2 id="findViewById（传统方式）">findViewById（传统方式）</h2><p>大家第一次接触 Android 想获取布局中的一个控件，估计大家第一个接触的就是 findViewById() 这个传统方式绑定视图吧</p><blockquote><p>配置布局的xml文件时，有时会给View配置id，而在Activity中寻找到该View的方法就是通过该id号来找到该View的。具体调用的方法就是findViewById。</p><p>这个findViewById方法顾名思义，就是根据id来找到View</p></blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//代码长这样</span></span><br><span class="line"><span class="keyword">val</span> button = findViewById&lt;Button&gt;(R.id.button01)</span><br><span class="line">button.setOnClickListener &#123;</span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;祝你身体健康&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意哦：《第一行代码》中这里是:显示声明变量类型</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805113052613.png" alt="image-20220805113052613"></p><p>有些网上教学是：强制类型转换</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> button = findViewById(R.id.button01) <span class="keyword">as</span> Button</span><br></pre></td></tr></table></figure><p>但是最新版是直接用泛型写啦！！！</p><p>Android中的View结构是一个树形结构，findViewById就是自树的根节点，依次遍历其子节点，知道找到目标的id。</p><p>原理：</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805140301988.png" alt="image-20220805140301988"></p><p>缺点：</p><ul><li>写的太累啦</li><li>性能略差，树形结构查找；</li><li>Fragment中容易使用失误；</li><li>增加代码耦合度，滥用了bug难找；</li><li>NPE：一个大型项目中，控件的id经常会重复，xml中删除了一个控件，但是对应的Activity中没有删除这个控件的相关引用，编译时并不会报错，但是运营室时会报出空指针；</li><li>可读性不好，简直看不懂哈。</li></ul><p>优点：</p><ul><li>兼容性好，使用所有场景</li><li>非常灵活，适合动态加载layout文件。</li></ul><h2 id="ButterKnife-（框架注解）">ButterKnife （框架注解）</h2><blockquote><p>这个Java用的多，不过我们 Kotlin 用的真的不多，而且快遗弃了，这里不展开，知道有这个就行。</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindView(R.id.btn_login)</span></span><br><span class="line">   <span class="keyword">var</span> mTestBtn:Button</span><br><span class="line"></span><br><span class="line">   <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">       setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">       ButterKnife.bind(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">       mTestBtn.setOnClickListener &#123;</span><br><span class="line">           Toast.makeText(<span class="keyword">this</span><span class="symbol">@MainActivity</span>,<span class="string">&quot;success&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></blockquote><h2 id="Kotlin-android-extensions-插件">Kotlin-android-extensions(插件)</h2><p>《第一行代码》中</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805130857651.png" alt="image-20220805130857651"></p><p>新版本 AS 是不会默认引入的，AS4.1之后就要自己手动加了</p><blockquote><p>大声BB:但是现在你再创建Android项目，就不会自动帮你依赖了，其原因就是kotlin-android-extensions这个插件已经被废弃了。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/QQ%E5%9B%BE%E7%89%8720220521182515.jpg" alt="QQ图片20220521182515"></p><p>为啥？Google这新技术迭代跟玩一样啊，有kotlin-android-extensions插件我不用，我就手写，哎，就是玩儿~</p><p>其实底层原因是这个是牺牲掉一部分内存来换取的方便，在对应用性能日益严格的今天，这种做法势必会被淘汰掉。</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805131041184.png" alt="image-20220805131041184"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//然后就可以直接用xml中对应的id来访问视图了</span></span><br><span class="line">button01.setOnClickListener &#123;</span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;第二次实验&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原理：通过反编译kotlin-android-extensions的代码，你就会发现，通过kotlin-android-extensions，它会在代码中创建一个HashMap，用来存放所有的id和对应的View的缓存，如果缓存中没有需要的View，那么就通过findViewById去创建，否则就直接获取，这就是它的原理。</p><p>三宗罪：</p><ul><li><p>耗费内存</p><p>见原理</p></li><li><p>资源 ID 重名</p><p>由于kotlin-android-extensions是通过view的id名直接引用的，所以多个布局间的同名id，就需要手动对import进行重命名处理，而且经常会引用错误的布局文件，导致运行崩溃。</p></li><li><p>仅支持 Kotlin 代码</p></li></ul><h2 id="viewBinding">viewBinding</h2><p>最低环境要求：</p><p>Android Studio：3.6<br>Android Gradle Plugin 3.6.0</p><blockquote><p>系统会为该模块中的每个 XML 布局文件生成一个绑定类。绑定类的实例包含对在相应布局中具有 ID 的所有视图的直接引用。<br>在大多数情况下，视图绑定会替代 <code>findViewById</code>。</p><p>也就是说我们通过使用ViewBinding也可以轻松的解决findViewById的繁琐使用问题，同样可以实现kotlin-android-extensions插件的类似功能。</p><p>其实同时还能在java和kotlin中同时使用，解决了kotlin-android-extensions插件使用所带来的问题。另外针对使用MVVM的朋友来说ViewBinding还可以和databinding配合使用，非常的方便。</p><p>为某个模块启用视图绑定功能后，系统会为该模块中包含的每个 XML 布局文件生成一个绑定类。每个绑定类均包含对根视图以及具有 ID 的所有视图的引用。系统会通过以下方式生成绑定类的名称：将 XML 文件的名称转换为驼峰式大小写，并在末尾添加“Binding”一词。</p><p>比如我们的是<code>first_layout.xml</code>到时候的绑定类名就是<code>FirstLayoutBinding</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ImageView</span> <span class="attr">android:cropToPadding</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">&quot;@drawable/rounded_button&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此类具有两个字段：一个是名为 name 的 TextView，另一个是名为 button 的 Button。该布局中的 ImageView 没有 ID，因此绑定类中不存在对它的引用。</p><p>每个绑定类还包含一个 getRoot() 方法，用于为相应布局文件的根视图提供直接引用。在此示例中，ResultProfileBinding 类中的 getRoot() 方法会返回 LinearLayout 根视图。</p></blockquote><h3 id="1-项目引入">1.项目引入</h3><p>app 下面的 build.gradle 的如图位置加上：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">viewBinding &#123;</span><br><span class="line">        enabled = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line"> buildFeatures &#123;</span><br><span class="line">        viewBinding <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意在 android {}里面哈</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805132017799.png" alt="image-20220805132017799"></p><h3 id="2-Activity-中使用">2. Activity 中使用</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> binding: FirstLayoutBinding</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.first_layout)</span><br><span class="line">       <span class="comment">//使用步骤</span></span><br><span class="line">        binding = FirstLayoutBinding.inflate(layoutInflater)<span class="comment">//1.创建绑定类的实例</span></span><br><span class="line">        <span class="keyword">val</span> view = binding.root<span class="comment">//2.获取根视图的引用</span></span><br><span class="line">        setContentView(view)<span class="comment">//3.让根视图成为屏幕上的活动视图</span></span><br><span class="line">        <span class="comment">//然后这个 xml 文件中的不管啥子都可以用啦</span></span><br><span class="line">        binding.button01.setOnClickListener &#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;第三种实现办法&quot;</span>,Toast.LENGTH_SHORT)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-Fragment-中使用">3.Fragment 中使用</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> _binding: ResultProfileBinding? = <span class="literal">null</span></span><br><span class="line"><span class="comment">// This property is only valid between onCreateView and</span></span><br><span class="line"><span class="comment">// onDestroyView.</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> binding <span class="keyword">get</span>() = _binding!!</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    inflater: <span class="type">LayoutInflater</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    container: <span class="type">ViewGroup</span>?,</span></span></span><br><span class="line"><span class="params"><span class="function">    savedInstanceState: <span class="type">Bundle</span>?</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: View? &#123;</span><br><span class="line">    _binding = ResultProfileBinding.inflate(inflater, container, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">val</span> view = binding.root</span><br><span class="line">    <span class="keyword">return</span> view</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroyView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroyView()</span><br><span class="line">    _binding = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-Adapter">4. Adapter</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoAdapter</span></span>(<span class="keyword">val</span> dataList: List&lt;String&gt;) : RecyclerView.Adapter&lt;DemoAdapter.ViewHolder&gt;() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(binding: OutcircleMissionFansGroupBinding) : RecyclerView.ViewHolder(binding.root) &#123;</span><br><span class="line">        <span class="keyword">val</span> title: TextView = binding.titleTextView</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> binding = OutcircleMissionFansGroupBinding.inflate(LayoutInflater.from(parent.context), parent, <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">return</span> ViewHolder(binding)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> <span class="keyword">data</span> = dataList[position]</span><br><span class="line">        holder.title.text = <span class="keyword">data</span>.title</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = dataList.size</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-希望在生成绑定类时忽略某个布局文件">5.希望在生成绑定类时忽略某个布局文件</h3><blockquote><p>官方这样说：</p><p>如果您希望在生成绑定类时忽略某个布局文件，请将<code>tools:viewBindingIgnore=&quot;true&quot;</code>属性添加到相应布局文件的根视图中：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">...</span></span></span><br><span class="line"><span class="tag">            <span class="attr">tools:viewBindingIgnore</span>=<span class="string">&quot;true&quot;</span> &gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>当你这样操作了发现：<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805132427925.png" alt="image-20220805132427925"></p><p>解决办法：</p><ol><li><p>变成&lt;tools：LinearLayout&gt;</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805104131845.png" alt="image-20220805104131845"></p></li><li><p>前面加上一行<code>xmlns:tools=&quot;http://schemas.android.com/tools&quot;</code><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220805104247376.png" alt="image-20220805104247376"></p></li></ol><h3 id="6-总结">6.总结</h3><p>缺陷：</p><ol><li>使用比kotlin-android-extensions复杂</li><li>不灵活，依然有需要手动处理的场景</li><li>默认给所有 xml 生成 blinding 文件，冗余</li></ol><p>优点：</p><ol><li>规避了 NPE</li><li>可读性好了点</li><li>内存好了点</li><li>轻量级了一点</li></ol><p>亲戚：datablinding （有兴趣了解，xml外面套了一层layout）</p><p>其实 ViewBinding 还有封装，这部分内容比较有意思，俺能力有限就请更有能力的观众朋友们下方评论区补充。</p><p>实话实说，这个 viewBinding 的使用确实不如kotlin-android-extensions方便，但是天下大势所趋，也没有办法，随着Kotlin的升级，早晚还是要切换到ViewBinding。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/%E5%B0%8F%E7%83%82%E8%80%81%E5%B8%88B%E7%AB%99Android01%E7%BE%A4%E7%BE%A4%E8%81%8A%E4%BA%8C%E7%BB%B4%E7%A0%81.png" alt="欢迎大家加群技术交流/群内也有很多免费资源"></p><p>欢迎大家加群技术交流/群内也有很多免费资源</p><blockquote><p>参考文献：</p><p><a href="https://developer.android.google.cn/topic/libraries/view-binding?hl=zh-cn#findviewbyid">视图绑定  | Android 开发者  | Android Developers (google.cn)</a></p><p><a href="https://zhuanlan.zhihu.com/p/350300086">废弃的kotlin-android-extensions，是时候接受ViewBinding了 - 知乎 (zhihu.com)</a></p><p><a href="https://blog.csdn.net/mp624183768/article/details/115596370">Warning: The ‘kotlin-android-extensions‘ Gradle plugin is deprecated. Please use this migration【已解决】_安果移不动的博客-CSDN博客</a></p><p><a href="https://cloud.tencent.com/developer/article/1817984">Google挖坑后人埋-ViewBinding(上) - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p><p><a href="https://blog.csdn.net/weixin_43662090/article/details/123170237">(13条消息) Android findViewById及替代方案大全_柚子君下的博客-CSDN博客_android findviewbyid</a></p></blockquote>]]></content>
    
    
    <summary type="html">findViewById/kotlin-android-extensions/viewBinding</summary>
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="Android" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Android/"/>
    
    
    <category term="Android" scheme="http://lmc.pub/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Hexo 博客 Front-matter</title>
    <link href="http://lmc.pub/2022/07/29/Hexo%20%E5%8D%9A%E5%AE%A2%20Front-matter/"/>
    <id>http://lmc.pub/2022/07/29/Hexo%20%E5%8D%9A%E5%AE%A2%20Front-matter/</id>
    <published>2022-07-29T14:00:00.000Z</published>
    <updated>2023-03-20T09:27:59.457Z</updated>
    
    <content type="html"><![CDATA[<h1>Hexo 博客 Front-matter</h1><h2 id="一，Front-matter">一，Front-matter</h2><p>Front-matter 是 markdown 文件最上方以 — 分隔的区域，用于指定个别档案的变数。</p><ul><li>Page Front-matter 用于配置页面</li><li>Post Front-matter 用于配置文章页</li></ul><h3 id="Page-Front-matter">Page Front-matter</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: # 【必需】页面标题</span><br><span class="line">date: # 【必需】页面创建日期</span><br><span class="line">updated: # 【必需】标签、分类和友情链接三个页面需要配置</span><br><span class="line">type: # 【可选】页面更新日期</span><br><span class="line">comments: # 【可选】页面描述</span><br><span class="line">description: # 【可选】页面关键词</span><br><span class="line">keywords: # 【可选】显示页面评论模块（默认 true）</span><br><span class="line">top<span class="emphasis">_img: # 【可选】页面顶部图片</span></span><br><span class="line"><span class="emphasis">mathjax: # 【可选】显示mathjax（当设置mathjax的per_</span>page： false时，才需要配置，默认 false）</span><br><span class="line">katex: # 【可选】显示katex（当设置katex的per<span class="emphasis">_page： false时，才需要配置，默认 false）</span></span><br><span class="line"><span class="emphasis">aside: # 【可选】显示侧边栏 （默认 true）</span></span><br><span class="line"><span class="emphasis">aplayer: # 【可选】在需要的页面加载aplayer的js和css，请参考文章下面的 配置音乐</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink: # 【可选】配置代码框是否展开（true/false）（默认为设置中highlight<span class="emphasis">_shrink的配置）</span></span><br><span class="line"><span class="emphasis">---</span></span><br></pre></td></tr></table></figure><h3 id="Post-Front-matter">Post Front-matter</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: # 【必需】文章标题</span><br><span class="line">date: # 【必需】文章创建日期</span><br><span class="line">updated: # 【可选】文章更新日期</span><br><span class="line">tags: # 【可选】文章标签</span><br><span class="line">categories: # 【可选】文章分类</span><br><span class="line">keywords: # 【可选】文章关键词</span><br><span class="line">description: # 【可选】文章描述</span><br><span class="line">top<span class="emphasis">_img: # 【可选】文章顶部图片</span></span><br><span class="line"><span class="emphasis">comments: # 【可选】文章缩略图（如果没有设置top_</span>img，文章页顶部将显示缩略图，可设为false/图片地址/留空）</span><br><span class="line">cover: # 【可选】显示文章评论模块（默认 true）</span><br><span class="line">toc: # 【可选】显示文章TOC（默认为设置中toc的enable配置）</span><br><span class="line">toc<span class="emphasis">_number: # 【可选】显示toc_</span>number（默认为设置中toc的number配置）</span><br><span class="line">toc<span class="emphasis">_style_</span>simple: # 【可选】显示 toc 简洁模式</span><br><span class="line">copyright: # 【可选】显示文章版权模块（默认为设置中post<span class="emphasis">_copyright的enable配置）</span></span><br><span class="line"><span class="emphasis">copyright_</span>author: # 【可选】文章版权模块的文章作者</span><br><span class="line">copyright<span class="emphasis">_author_</span>href: # 【可选】文章版权模块的链接文章作者</span><br><span class="line">copyright<span class="emphasis">_url: # 【可选】文章版权模块的链接文章连结</span></span><br><span class="line"><span class="emphasis">copyright_</span>info: # 【可选】文章版权模块的文字版权声明</span><br><span class="line">mathjax: # 【可选】显示mathjax（当设置mathjax的per<span class="emphasis">_page： false时，才需要配置，默认 false）</span></span><br><span class="line"><span class="emphasis">katex: # 【可选】显示katex（当设置katex的per_</span>page： false时，才需要配置，默认 false）</span><br><span class="line">aplayer: # 【可选】在需要的页面加载aplayer的js和css，请参考文章下面的 配置音乐</span><br><span class="line">highlight<span class="emphasis">_shrink: # 【可选】配置代码框是否展开（true/false）（默认为设置中highlight_</span>shrink的配置）</span><br><span class="line">aside: # 【可选】显示侧边栏 （默认 true）</span><br><span class="line"><span class="section">top: # 置顶</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="三板斧">三板斧</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Hexo 博客 Front-matter&lt;/h1&gt;
&lt;h2 id=&quot;一，Front-matter&quot;&gt;一，Front-matter&lt;/h2&gt;
&lt;p&gt;Front-matter 是 markdown 文件最上方以 — 分隔的区域，用于指定个别档案的变数。&lt;/p&gt;
&lt;ul&gt;
&lt;l</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="其他" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/"/>
    
    <category term="博客" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/%E5%85%B6%E4%BB%96/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="Hexo博客" scheme="http://lmc.pub/tags/Hexo%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>JavaWeb</title>
    <link href="http://lmc.pub/2022/07/14/JavaWeb/"/>
    <id>http://lmc.pub/2022/07/14/JavaWeb/</id>
    <published>2022-07-13T22:18:00.000Z</published>
    <updated>2023-03-20T08:47:43.532Z</updated>
    
    <content type="html"><![CDATA[<h1>JavaWeb</h1><blockquote><p>sticky: 100 # 数字越大越在前面</p></blockquote><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/JavaWeb.jpg" alt="Girls"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/109951163261278540.jpg" alt="许嵩"></p><h2 id="一，前端技术">一，前端技术</h2><p>HTML：网页上显示什么</p><p>CSS：显示的美观样式</p><p>JS：动态特效</p><h3 id="1-1-HTML">1.1 HTML</h3><blockquote><p>HTML：HyperText Markup Language</p><p>超文本标记语言</p><p>我们这里学的是 HTML5</p></blockquote><h4 id="1-1-1-基本标签">1.1.1 基本标签</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>LMC标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">我是身体<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">俺也是身体</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这里是段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这里是段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;D:\奇奇怪怪\壁纸\timthumb.jpg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">heigth</span>=<span class="string">&quot;300&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;这是一张美女照片&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>标题1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>标题2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>标题3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>标题4<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>标题5<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>标题6<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">下面是有序列表演示：</span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">type</span>=<span class="string">&quot;A&quot;</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>有序元素1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>有序元素2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>有序元素3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>有序元素4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">下面是无序列表演示：</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">type</span>=<span class="string">&quot;square&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>俺<span class="tag">&lt;/<span class="name">b</span>&gt;</span>是用来<span class="tag">&lt;<span class="name">u</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">u</span>&gt;</span>文本<span class="tag">&lt;<span class="name">i</span>&gt;</span>重点<span class="tag">&lt;/<span class="name">i</span>&gt;</span>标记的</span><br><span class="line"><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">水的分子式是：H<span class="tag">&lt;<span class="name">sub</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sub</span>&gt;</span>O</span><br><span class="line">氧气的分子式是：O<span class="tag">&lt;<span class="name">sup</span>&gt;</span>2<span class="tag">&lt;<span class="name">sup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">3<span class="symbol">&amp;lt;</span>5</span><br><span class="line">6<span class="symbol">&amp;gt;</span>1</span><br><span class="line">3<span class="symbol">&amp;le;</span>3~6</span><br><span class="line">5<span class="symbol">&amp;ge;</span>1~5</span><br><span class="line"><span class="symbol">&amp;reg;</span></span><br><span class="line"><span class="symbol">&amp;copy;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://lmc.pub/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>烂子的BLOG<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">这里是注释</span></span><br><span class="line"><span class="comment">HTML 是解释语言，不是编译语言</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1. &lt;html&gt;</span></span><br><span class="line"><span class="comment">html 页面由一对标签组成</span></span><br><span class="line"><span class="comment">&lt;html&gt; 叫起始标签</span></span><br><span class="line"><span class="comment">&lt;/html&gt; 叫结束标签</span></span><br><span class="line"><span class="comment">2. &lt;head&gt; 网页头</span></span><br><span class="line"><span class="comment">3. &lt;body&gt; 网页主体：里面写啥就会在网页上显示</span></span><br><span class="line"><span class="comment">4. &lt;title&gt; 网页标题</span></span><br><span class="line"><span class="comment">5. &lt;meta&gt; 中可以改变网页文件的编码方式，默认 UTF—8 否则会乱码 </span></span><br><span class="line"><span class="comment">6. &lt;br/&gt; 文本换行 （单标签：开始标签和结束标签是同一个）</span></span><br><span class="line"><span class="comment">7. &lt;p&gt; 表示段落标签</span></span><br><span class="line"><span class="comment">8. &lt;img/&gt; 表示图片引入</span></span><br><span class="line"><span class="comment">src 表示图片资源目录，可以用绝对路径，也可以用相对路径</span></span><br><span class="line"><span class="comment">width height 分别表示宽高</span></span><br><span class="line"><span class="comment">alt 是提示信息，图片加载不出来也会显示这行字</span></span><br><span class="line"><span class="comment">9. &lt;h&gt;  表示标题，从1~6</span></span><br><span class="line"><span class="comment">10. 列表</span></span><br><span class="line"><span class="comment">1）ol 有序列表</span></span><br><span class="line"><span class="comment">type a A I i 1(default)</span></span><br><span class="line"><span class="comment">start 起始标号 只能填数字</span></span><br><span class="line"><span class="comment">2）ul 无序列表</span></span><br><span class="line"><span class="comment">li （listitem）列表元素</span></span><br><span class="line"><span class="comment">type disc(default),circle,square</span></span><br><span class="line"><span class="comment">11. &lt;b&gt;&lt;/b&gt; 加粗</span></span><br><span class="line"><span class="comment">    &lt;i&gt;&lt;/i&gt; 斜体</span></span><br><span class="line"><span class="comment">    &lt;u&gt;&lt;/u&gt; 下划线</span></span><br><span class="line"><span class="comment">12.上标/下标</span></span><br><span class="line"><span class="comment">&lt;sup&gt;&lt;/sup&gt; 上标</span></span><br><span class="line"><span class="comment">&lt;sub&gt;&lt;/sub&gt; 下标</span></span><br><span class="line"><span class="comment">13.符号表示</span></span><br><span class="line"><span class="comment">&amp;lt; &lt; less than</span></span><br><span class="line"><span class="comment">&amp;gt; &gt; greater than</span></span><br><span class="line"><span class="comment">&amp;le; &lt;= less equal</span></span><br><span class="line"><span class="comment">&amp;ge; &gt;= greater equal</span></span><br><span class="line"><span class="comment">&amp;reg; 注册商标</span></span><br><span class="line"><span class="comment">&amp;copy; 版权符号</span></span><br><span class="line"><span class="comment">其他这种符号：https://www.w3school.com.cn/html/html_entities.asp</span></span><br><span class="line"><span class="comment">14.容器</span></span><br><span class="line"><span class="comment">&lt;span&gt;&lt;/span&gt; 不换行的标记</span></span><br><span class="line"><span class="comment">&lt;dev&gt;&lt;/dev&gt;   换行的标记(层)</span></span><br><span class="line"><span class="comment">15.超链接</span></span><br><span class="line"><span class="comment">&lt;a href=&quot;https://lmc.pub/&quot; target=&quot;&quot;&gt;LMC的博客&lt;/a&gt; href（higth reference） 中写网址</span></span><br><span class="line"><span class="comment">targt: 链接打开方式</span></span><br><span class="line"><span class="comment">_self 在本窗口打开</span></span><br><span class="line"><span class="comment">_blank 在一个新窗口打开</span></span><br><span class="line"><span class="comment">_parent 在父窗口打开</span></span><br><span class="line"><span class="comment">_top 在顶层窗口打开 </span></span><br><span class="line"><span class="comment">16.注释</span></span><br><span class="line"><span class="comment">&lt;!-- XX --&gt;</span></span><br><span class="line"></span><br><span class="line">--&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-2-CSS">1.2 CSS</h3><h3 id="1-3-JS">1.3 JS</h3><h2 id="二，后端技术">二，后端技术</h2><h2 id="三，后端深入">三，后端深入</h2><h2 id="四，前端框架">四，前端框架</h2>]]></content>
    
    
    <summary type="html">尚硅谷 2022 JavaWeb自学笔记</summary>
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="Java Web" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Java-Web/"/>
    
    
    <category term="Java Web" scheme="http://lmc.pub/tags/Java-Web/"/>
    
  </entry>
  
  <entry>
    <title>【Bug】Edge浏览器 腾讯会议回放视频放不出来   Erro Code ：4 网络异常</title>
    <link href="http://lmc.pub/2022/07/10/%E3%80%90Bug%E3%80%91Edge%E6%B5%8F%E8%A7%88%E5%99%A8%20%E8%85%BE%E8%AE%AF%E4%BC%9A%E8%AE%AE%E5%9B%9E%E6%94%BE%E8%A7%86%E9%A2%91%E6%94%BE%E4%B8%8D%E5%87%BA%E6%9D%A5%20%20%20Erro%20Code%20%EF%BC%9A4%20%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8/"/>
    <id>http://lmc.pub/2022/07/10/%E3%80%90Bug%E3%80%91Edge%E6%B5%8F%E8%A7%88%E5%99%A8%20%E8%85%BE%E8%AE%AF%E4%BC%9A%E8%AE%AE%E5%9B%9E%E6%94%BE%E8%A7%86%E9%A2%91%E6%94%BE%E4%B8%8D%E5%87%BA%E6%9D%A5%20%20%20Erro%20Code%20%EF%BC%9A4%20%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8/</id>
    <published>2022-07-10T15:43:00.000Z</published>
    <updated>2023-03-20T08:47:07.334Z</updated>
    
    <content type="html"><![CDATA[<h1>Edge浏览器 腾讯会议回放视频放不出来   Erro Code ：4 网络异常</h1><h2 id="一，背景介绍">一，背景介绍</h2><p>朋友们大家好啊，我是烂子。这不搁今晚上嘛，准备学习。学那个白天老师腾讯会议上课的录频，然后就打开了。发现咋滴？这个腾讯会议在这个腾讯云上，别的都有，就是那个视频整不出来。一直显示“网络异常，请刷新后重试 Erro Code ：4”。我电脑默认是 Windows 自带的 Edge 浏览器，内核搜索引擎是那个必应。妈了个巴子，从下午吃完饭就一直整这个鸭，到晚上 11 点才整明白怎么回事。期间还以为是代理 VPN 的锅，还以为是腾讯会议，腾讯云的锅，最后都不是哈，是浏览器的原因。这个 Edge 浏览器的</p><h2 id="二，情况描述">二，情况描述</h2><p>这个腾讯会议在这个腾讯云上，别的都有，就是那个视频整不出来。一直显示 <strong>“网络异常，请刷新后重试 Erro Code ：4”</strong></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20220710234757826.png" alt="image-20220710234757826"></p><h2 id="三，原因">三，原因</h2><p>问题突破口在这个 <code>Erro Code ：4</code></p><p>常见原因：</p><p>1、 视频格式不支持</p><p>播放器是依赖浏览器自身解码能力解析视频进行播放，如果上传的视频没有执行转码或本身视频文件的编码信息与当前播放环境不兼容，则会导致播放异常，我们可以通过对视频执行转码操作或对比Demo看是否可以正常播放，如果Demo是异常，那断定是该问题。</p><p>2、模拟环境播放</p><p>由于PC端chrome浏览器播放m3u8视频是通过MSE转封装播放的，而IOS具有直接播放m3u8的能力，所以在PC模拟iOS的环境，播放器获取环境是iOS时，会直接播放m3u8，而不是像其他PC播放那样调用MSE来播放m3u8,但模拟环境并不是真实的iOS,并没有直接播放m3u8的能力，所以如果使用模拟ios环境来播放对应视频，这里有可能会导致报错。</p><p>3、Js顺序加载失败</p><p>如果是这个场景，那需要保证hls.js在tcplayer.js前引入，tcplayer.js加载并初始化播放器后，需要通过hls.js来播放hls视频，如果hls.js在tcplayer.js之后引入，播放器初始化成功并调用hls.js进行视频播放器的时候，hls.js可能并未加载成功，导致播放失败，原来用户播放失败是这里没有调整好。</p><p>4、获取不到资源</p><p>超级播放器是根据页面代码中appid和fileid发送请求给点播后台，后台根据对应的appid和fileid返回对应的视频信息，播放器拿到视频信息再去请求视频，如果对应appid开通key防盗链等配置，则需要在播放过程中带入对应字段进行播放信息的获取。</p><p>说的比较杂，好像没有说在点子上。为了排错，我先后：</p><ol><li>卸载所有网络代理，VPN -&gt; 不行</li><li>重启 -&gt; 不行</li><li>在手机上进入这个腾讯会议的回放 -&gt; 行</li><li>在别人的电脑上进入这个腾讯会议的回放 -&gt; 行</li></ol><p>所以问题只能出在自己电脑上，综合那个 <code>Erro Code ：4</code></p><h2 id="四，解决">四，解决</h2><ol><li>下一个火狐浏览器</li><li>同时关闭网络代理VPN</li><li>用火狐浏览器在没有翻墙的情况下打开腾讯会议的回放</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Edge浏览器 腾讯会议回放视频放不出来   Erro Code ：4 网络异常&lt;/h1&gt;
&lt;h2 id=&quot;一，背景介绍&quot;&gt;一，背景介绍&lt;/h2&gt;
&lt;p&gt;朋友们大家好啊，我是烂子。这不搁今晚上嘛，准备学习。学那个白天老师腾讯会议上课的录频，然后就打开了。发现咋滴？这个腾讯</summary>
      
    
    
    
    <category term="编程" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/"/>
    
    <category term="Bug" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Bug/"/>
    
    <category term="计算机" scheme="http://lmc.pub/categories/%E7%BC%96%E7%A8%8B/Bug/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="Bug" scheme="http://lmc.pub/tags/Bug/"/>
    
  </entry>
  
</feed>
