<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LMC_Blog</title>
  
  
  <link href="http://lmc.pub/atom.xml" rel="self"/>
  
  <link href="http://lmc.pub/"/>
  <updated>2023-04-01T00:40:27.220Z</updated>
  <id>http://lmc.pub/</id>
  
  <author>
    <name>LMC</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>【电脑】怎么改win11的默认右键二级目录为一级目录</title>
    <link href="http://lmc.pub/posts/2579761686.html"/>
    <id>http://lmc.pub/posts/2579761686.html</id>
    <published>2023-04-01T00:31:59.000Z</published>
    <updated>2023-04-01T00:40:27.220Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述">题目描述</h2><p>win11 更新之后，UI变得美观了。但是也有不少地方是反向升级了。</p><p>比如右键，变成了二级目录。</p><p>我经常用的 git bash 就要点两下才能起来。</p><p>就不好。</p><h2 id="实现-v2">实现</h2><ol><li><p><code>win + x</code>选择<code>Windows powershell（管理员）</code>/或者<code>右键Home键</code><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230401083520389.png" alt="image-20230401083520389"></p></li><li><p><code>*reg add &quot;HKCU\Software\Classes\CLSID\&#123;86ca1aa0-34aa-4e8b-a509-50c905bae2a2&#125;\InprocServer32&quot; /f /ve*</code>把这行代码复制过去执行。<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230401083605141.png" alt="image-20230401083605141"></p></li><li><p><code>win + E</code>打开<code>Windows资源管理器</code>/手点打开也行。然后<code>Ctrl + Shift + Esc</code>调出<code>任务管理器</code>。然后把<code>Windows资源管理器</code>重启。<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230401083900666.png" alt="image-20230401083900666"></p></li><li><p>然后这台电脑右键就是直接一级目录了。<img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230401083935820.png" alt="image-20230401083935820"></p></li></ol><h2 id="个人总结-v2">个人总结</h2><p>产品升级，是毁誉参半的事情。</p><p>生的好皆大欢喜，生的不好就会引发用户不满。</p><p>降低用户好感度。</p>]]></content>
    
    
    <summary type="html">【电脑】怎么改win11的默认右键二级目录为一级目录</summary>
    
    
    
    <category term="电脑" scheme="http://lmc.pub/categories/%E7%94%B5%E8%84%91/"/>
    
    
    <category term="电脑" scheme="http://lmc.pub/tags/%E7%94%B5%E8%84%91/"/>
    
  </entry>
  
  <entry>
    <title>【算法】左旋转字符串_剑指Offer58II</title>
    <link href="http://lmc.pub/posts/1541378983.html"/>
    <id>http://lmc.pub/posts/1541378983.html</id>
    <published>2023-03-31T23:04:13.000Z</published>
    <updated>2023-03-31T23:28:31.543Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v7">题目描述</h2><p><a href="https://leetcode.cn/problems/zuo-xuan-zhuan-zi-fu-chuan-lcof/">左旋转字符串_剑指Offer58II</a></p><h2 id="代码实现-v4">代码实现</h2><h2 id="个人总结-v8">个人总结</h2>]]></content>
    
    
    <summary type="html">【算法】左旋转字符串_剑指Offer58II</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【电脑】怎么设置Windows默认DOS编码格式</title>
    <link href="http://lmc.pub/posts/720772485.html"/>
    <id>http://lmc.pub/posts/720772485.html</id>
    <published>2023-03-31T12:10:31.000Z</published>
    <updated>2023-03-31T23:28:31.531Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v2">题目描述</h2><p>在<code>刚开始学Java</code>以及<code>用Sublime写Java算法</code>的时候。</p><p>为了编译 java 文件，总会在 win 下面的<code>DOS</code>下面用命令行的形式去<code>javac java</code></p><p>但是<code>DOS默认编码是GBK，但我们用的大多都是 UTF-8</code>。</p><p>所以在Sublime写完代码要单独保存为 GBK，然后才能在 DOS 下测试运行。</p><p>而且下次打开又是乱码，很不方便。</p><p>所以要永久的改一下 Windows 下 DOS 的默认编码：从 GBK 改为 UTF-8。</p><h2 id="实现-v3">实现</h2><p><code>win + R</code>呼出运行框，然后输入<code>regedit</code>进入<code>注册表编辑器</code>。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230331201447765.png" alt="image-20230331201447765"></p><p>找到<code>计算机\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Command Processor</code>这个目录</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230331201612883.png" alt="image-20230331201612883"></p><p>新建<code>字符串值</code></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230331201649623.png" alt="image-20230331201649623"></p><p>依次这样填，然后确认退出。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230331201755760.png" alt="image-20230331201755760"></p><p>然后随便哪里打开 DOS，输入<code>chcp</code>就会显示当前编码，已经是<code>UTF-8</code>了。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230331201906299.png" alt="image-20230331201906299"></p><h2 id="个人总结-v3">个人总结</h2><p>失败了，哪怕 DOS 设置成了 UTF-8，还是会乱码。</p>]]></content>
    
    
    <summary type="html">怎么设置Windows默认DOS编码格式</summary>
    
    
    
    <category term="电脑" scheme="http://lmc.pub/categories/%E7%94%B5%E8%84%91/"/>
    
    
    <category term="电脑" scheme="http://lmc.pub/tags/%E7%94%B5%E8%84%91/"/>
    
  </entry>
  
  <entry>
    <title>【算法】反转字符串中的单词151</title>
    <link href="http://lmc.pub/posts/2899010650.html"/>
    <id>http://lmc.pub/posts/2899010650.html</id>
    <published>2023-03-31T10:19:47.000Z</published>
    <updated>2023-03-31T23:28:31.541Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v6">题目描述</h2><p><a href="https://leetcode.cn/problems/reverse-words-in-a-string/">151. 反转字符串中的单词 - 力扣（Leetcode）</a></p><h2 id="代码实现-v3">代码实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//反转字符串中的单词151    </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReverseWordsInAString151</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">System.out.println(<span class="keyword">new</span> <span class="title class_">Solution</span>().reverseWords(<span class="string">&quot;  hello world  &quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseWords</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> removeSpace(s);</span><br><span class="line">        System.out.println(res);</span><br><span class="line">    reverse(res,<span class="number">0</span>,res.length() - <span class="number">1</span>);</span><br><span class="line">        System.out.println(res);</span><br><span class="line">        reverseEachWord(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1. 去多余空格</span></span><br><span class="line">    <span class="keyword">public</span> StringBuilder <span class="title function_">removeSpace</span><span class="params">(String oriStr)</span>&#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> oriStr.length() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span>[] oriChar = oriStr.toCharArray();</span><br><span class="line">    <span class="comment">//把前后空格去了</span></span><br><span class="line">    <span class="keyword">while</span>(oriChar[right] == <span class="string">&#x27; &#x27;</span>) right--;</span><br><span class="line">    <span class="keyword">while</span>(oriChar[left] == <span class="string">&#x27; &#x27;</span>) left++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">    <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> oriChar[left];</span><br><span class="line">    <span class="comment">//去中间空格</span></span><br><span class="line">    <span class="keyword">if</span> (c != <span class="string">&#x27; &#x27;</span> || res.charAt(res.length() - <span class="number">1</span>) != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">    res.append(c);</span><br><span class="line">    &#125;</span><br><span class="line">    left++;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 整个str 的反转</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(StringBuilder oriStr, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(start &lt; end)&#123;</span><br><span class="line">    <span class="type">char</span> <span class="variable">temp</span> <span class="operator">=</span> oriStr.charAt(start);</span><br><span class="line">    oriStr.setCharAt(start++, oriStr.charAt(end));</span><br><span class="line">    oriStr.setCharAt(end--,temp);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3. 单词的恢复</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverseEachWord</span><span class="params">(StringBuilder oriStr)</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> oriStr.length();</span><br><span class="line">    <span class="keyword">while</span>(start &lt; len)&#123;</span><br><span class="line">    <span class="comment">//找last</span></span><br><span class="line">            <span class="comment">//这个地方end++不能放在判断式里面，因为放在里面就是只要判断了就会自增，实际上</span></span><br><span class="line">            <span class="comment">//只有同时满足条件了才会自增。</span></span><br><span class="line">    <span class="keyword">while</span>(end &lt; len &amp;&amp; oriStr.charAt(end) != <span class="string">&#x27; &#x27;</span>) end++;</span><br><span class="line">    reverse(oriStr, start, end - <span class="number">1</span>);</span><br><span class="line">    start = end + <span class="number">1</span>;</span><br><span class="line">    end = start + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人总结-v7">个人总结</h2><p>解题关键：</p><ol><li>只使用 <code>O(1)</code> 的空间复杂度</li><li>可以用 <code>StringBuilder</code></li><li>记得分好步骤：1. 去空格； 2. 全颠覆； 3. 恢复单词；</li></ol><p>我对于<code>++</code>这个运算符的理解又上一层楼咯。</p><hr><p>2023/04/01</p><p>我觉得这个题目有点东西的，所以第二天又刷了一次。</p><p>这次在<code>++</code> 这种自增运算符处理更优雅了，但是我发现我还有两个弱点。</p><blockquote><ol><li><code>char</code>老是写成<code>chat</code></li><li>对一下Java基础语法不太熟练。比如<code>setCharAt()</code>里面是两个参数，index 和 updataValue。</li></ol></blockquote>]]></content>
    
    
    <summary type="html">这个算法比较难实现，多练习几次。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】替换空格05</title>
    <link href="http://lmc.pub/posts/992760064.html"/>
    <id>http://lmc.pub/posts/992760064.html</id>
    <published>2023-03-31T07:15:26.000Z</published>
    <updated>2023-03-31T08:51:55.673Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v8">题目描述</h2><p><a href="https://leetcode.cn/problems/ti-huan-kong-ge-lcof/">剑指 Offer 05. 替换空格</a></p><h2 id="代码实现-v5">代码实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.lang.StringBuilder;</span><br><span class="line"></span><br><span class="line"><span class="comment">//替换空格05</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TiHuanKongGeLcof05</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">System.out.print(<span class="string">&quot;请输入需要替换【空格】为【20%】的字符串：&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;\n&quot;</span> + <span class="keyword">new</span> <span class="title class_">Solution</span>().replaceSpace(input.nextLine()));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//简单实现版本</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">replaceSpace</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(s == <span class="literal">null</span> || s.length() == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">char</span> item : s.toCharArray())&#123;</span><br><span class="line">    <span class="keyword">if</span> (item == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">    res.append(<span class="string">&quot;%20&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    res.append(item);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//双指针版本</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">replaceSpace</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(s == <span class="literal">null</span> || s.length() == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//确定加几个空格，每个空格加两个空格</span></span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> item : s.toCharArray()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">    temp.append(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (temp.length() == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> s.length() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    s += temp.toString();</span><br><span class="line">    <span class="type">char</span>[] ori = s.toCharArray();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> s.length() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (ori[left] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">    ori[right--] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    ori[right--] = <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    ori[right] = <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    ori[right] = ori[left];</span><br><span class="line">    &#125;</span><br><span class="line">    right--;</span><br><span class="line">    left--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(ori);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人总结-v9">个人总结</h2><p>为什么我觉得如果对于 Java 的 <code>String，StringBuilder，StringBuffer</code>熟悉的话，第一个显得更加高效简单。</p>]]></content>
    
    
    <summary type="html">【算法】替换空格05</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】反转字符串II541</title>
    <link href="http://lmc.pub/posts/180107193.html"/>
    <id>http://lmc.pub/posts/180107193.html</id>
    <published>2023-03-31T02:16:37.000Z</published>
    <updated>2023-03-31T05:22:45.118Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v4">题目描述</h2><p><a href="https://leetcode.cn/problems/reverse-string-ii/description/">反转字符串II541</a></p><h2 id="代码实现">代码实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.Math;</span><br><span class="line"></span><br><span class="line"><span class="comment">//反转字符串II541</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReverseStringII541</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">System.out.println(<span class="keyword">new</span> <span class="title class_">Solution</span>().reverseStr(<span class="string">&quot;abcdefg&quot;</span>,<span class="number">2</span>));<span class="comment">//bacdfeg</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseStr</span><span class="params">(String s, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">char</span>[] res = s.toCharArray();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; res.length; i += <span class="number">2</span> * k) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> Math.min(res.length - <span class="number">1</span>, start + k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (start &lt; end)&#123;</span><br><span class="line">    <span class="type">char</span> <span class="variable">temp</span> <span class="operator">=</span> res[start];</span><br><span class="line">    res[start++] = res[end];</span><br><span class="line">    res[end--] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> String.valueOf(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人总结-v5">个人总结</h2><ol><li>在循环内部不要改变循环控制量</li><li>上面这种实现方式最好理解且轻便</li></ol>]]></content>
    
    
    <summary type="html">【算法】反转字符串II541</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】反转字符串344</title>
    <link href="http://lmc.pub/posts/772676929.html"/>
    <id>http://lmc.pub/posts/772676929.html</id>
    <published>2023-03-31T01:48:34.000Z</published>
    <updated>2023-03-31T05:22:45.117Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v5">题目描述</h2><p><a href="https://leetcode.cn/problems/reverse-string/description/">力扣，反转字符串344</a></p><h2 id="代码实现-v2">代码实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">//反转字符串344</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReverseString344</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.print(<span class="string">&quot;请输入需要 reverse 的 String ： &quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">string</span> <span class="operator">=</span> input.nextLine();</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Solution</span>().reverseString(string.toCharArray());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverseString</span><span class="params">(<span class="type">char</span>[] s)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>,j = s.length - <span class="number">1</span>; i &lt; j; i++,j--) &#123;</span><br><span class="line">    <span class="type">char</span> <span class="variable">temp</span> <span class="operator">=</span> s[i];</span><br><span class="line">    s[i] = s[j];</span><br><span class="line">    s[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">System.out.print(<span class="string">&quot;\n&quot;</span> + String.valueOf(s));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="个人总结-v6">个人总结</h2><p>题目请简单的，就双指针法直接一换就可以了。</p><p>补充： ==谁用size谁用length？==</p><blockquote><ol><li><p><code>length</code>是<strong>数组的属性</strong>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] nums = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">System.out.println(<span class="string">&quot;nums.length = &quot;</span> + nums.length);<span class="comment">//5</span></span><br></pre></td></tr></table></figure></li><li><p><code>length()</code>是<strong>String的统计长度方法</strong>。底层还是length。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">System.out.println(<span class="string">&quot;The length of s is &quot;</span> + s.length());<span class="comment">//5</span></span><br></pre></td></tr></table></figure></li><li><p><code>size()</code>是集合统计元素个数的统计方法，底层还是length。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">list.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;这个list的长度为：&quot;</span> + list.size());<span class="comment">//3</span></span><br></pre></td></tr></table></figure></li></ol></blockquote>]]></content>
    
    
    <summary type="html">【算法】反转字符串344</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【电脑】百度网盘网页版怎么按文件名排序</title>
    <link href="http://lmc.pub/posts/59755803.html"/>
    <id>http://lmc.pub/posts/59755803.html</id>
    <published>2023-03-29T14:26:50.000Z</published>
    <updated>2023-03-31T23:11:07.867Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述-v3">题目描述</h2><p>百度网盘文件默认排序只有<code>修改时间</code>和<code>大小</code>两个。</p><p>导致一些用文件名排好序的文件全乱了。</p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230329222930927.png" alt="image-20230329222930927"></p><p>而且只给了这两个调整方案。</p><h2 id="solution-v3">solution</h2><ol><li>回到老版</li><li>空白处右键</li></ol><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230329223037544.png" alt="image-20230329223037544"></p><h2 id="个人总结-v4">个人总结</h2><p>这波属于是升级新版，直接脱离用户体验。</p><p>产品经理是哈了吧。还好百度程序员留了个口子。</p><p>真心离谱哈。</p>]]></content>
    
    
    <summary type="html">百度网盘网页版怎么按文件名排序</summary>
    
    
    
    <category term="电脑" scheme="http://lmc.pub/categories/%E7%94%B5%E8%84%91/"/>
    
    
    <category term="电脑" scheme="http://lmc.pub/tags/%E7%94%B5%E8%84%91/"/>
    
  </entry>
  
  <entry>
    <title>【其他_Sublime】自动保存设置</title>
    <link href="http://lmc.pub/posts/4175140693.html"/>
    <id>http://lmc.pub/posts/4175140693.html</id>
    <published>2023-03-28T02:06:49.000Z</published>
    <updated>2023-03-31T23:14:47.187Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述">描述</h2><p><code>Sublime</code>是一款很好用的轻量级编辑器。</p><p>我挺喜欢的，但是每次写完代码都要 <code>ctrl + s</code>手动保存。</p><p>有点 emo。</p><h2 id="实现">实现</h2><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230328101156490.png" alt="image-20230328101156490"></p><p><img src="https://article-picture-resource.oss-cn-chengdu.aliyuncs.com/imags/image-20230328101228019.png" alt="image-20230328101228019"></p><p>然后重启 Sublime，就好了。</p><h2 id="个人总结">个人总结</h2><p>Sublime 这个自动保存，会有点点延迟。</p><p>是你离开了这个文件，她才保存。</p>]]></content>
    
    
    <summary type="html">【Sublime】自动保存设置</summary>
    
    
    
    <category term="其他" scheme="http://lmc.pub/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="Sublime" scheme="http://lmc.pub/categories/%E5%85%B6%E4%BB%96/Sublime/"/>
    
    
    <category term="Sublime" scheme="http://lmc.pub/tags/Sublime/"/>
    
  </entry>
  
  <entry>
    <title>【算法】四数之和18</title>
    <link href="http://lmc.pub/posts/2449576452.html"/>
    <id>http://lmc.pub/posts/2449576452.html</id>
    <published>2023-03-28T01:21:04.000Z</published>
    <updated>2023-03-31T07:11:37.732Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/4sum/">四数之和18</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//四数之和</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FourSum18</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="comment">// nums = [1, 0, -1, 0, -2, 2]，和 target = 0。 </span></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">System.out.print(<span class="string">&quot;target = &quot;</span>);</span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">Solution</span>().fourSum(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">2</span>&#125;, input.nextInt());</span><br><span class="line"><span class="keyword">for</span> (List&lt;Integer&gt; itemList : res) &#123;</span><br><span class="line">System.out.println();</span><br><span class="line"><span class="keyword">for</span> (Integer item : itemList) &#123;</span><br><span class="line">System.out.print(item + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">fourSum</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; ret = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (nums.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//排序</span></span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">    <span class="comment">//这里的这个 nums[i] &gt; 0 不能少，因为如果target 为 -11，最小的是-5，就直接没了。</span></span><br><span class="line">    <span class="comment">//实际上还是可以的，-5，-4，-2</span></span><br><span class="line">    <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span> &amp;&amp; nums[i] &gt; target) &#123;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//对于i去重</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">    <span class="comment">//对j去重</span></span><br><span class="line">    <span class="keyword">if</span> (j &gt; i + <span class="number">1</span> &amp;&amp; nums[j] == nums[j - <span class="number">1</span>]) &#123;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> j + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> nums[i] + nums[j] + nums[left] + nums[right];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (sum &lt; target) &#123;</span><br><span class="line">    left++;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sum &gt; target) &#123;</span><br><span class="line">    right--;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sum == target) &#123;</span><br><span class="line">    ret.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));</span><br><span class="line">    <span class="keyword">while</span>(left &lt; right &amp;&amp; nums[right - <span class="number">1</span>] == nums[right]) right--;</span><br><span class="line">    <span class="keyword">while</span>(left &lt; right &amp;&amp; nums[left] == nums[left + <span class="number">1</span>]) left++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后面两个去重</span></span><br><span class="line">    right--;</span><br><span class="line">    left++;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">【算法】四数之和18</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】三数之和15</title>
    <link href="http://lmc.pub/posts/2670222231.html"/>
    <id>http://lmc.pub/posts/2670222231.html</id>
    <published>2023-03-28T01:20:49.000Z</published>
    <updated>2023-03-29T14:11:04.399Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/3sum/">三数之和15</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//三数之和15</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Threesum15</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] nums = &#123;-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">4</span>&#125;;</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; list = <span class="keyword">new</span> <span class="title class_">Solution</span>().threeSum(nums);</span><br><span class="line">        <span class="keyword">for</span>(List&lt;Integer&gt; itemList : list)&#123;</span><br><span class="line">            System.out.println();</span><br><span class="line">            <span class="keyword">for</span> (Integer item : itemList) &#123;</span><br><span class="line">                System.out.print(item + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">threeSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (nums.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//排序</span></span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">            <span class="comment">//如果第一个就 &gt; 0,那绝对凑不出来 三个 = 0</span></span><br><span class="line">            <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//对a去重</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp;nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> i + <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(right &gt; left)&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> nums[i] + nums[left] + nums[right];</span><br><span class="line">                <span class="keyword">if</span> (sum &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    left++;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    right--;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sum == <span class="number">0</span>)&#123;</span><br><span class="line">                    res.add(Arrays.asList(nums[i], nums[left], nums[right]));</span><br><span class="line">                    <span class="comment">//后面两位去重</span></span><br><span class="line">                    <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[right] == nums[right - <span class="number">1</span>]) right--;</span><br><span class="line">                    <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[left] == nums[left + <span class="number">1</span>]) left++;</span><br><span class="line">                    right--;</span><br><span class="line">                    left++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="add">add</h2><ol><li>多复习几遍。这个题目确实棘手，尤其是去重处理。我能写出来，但是不知道为什么在哪里去重。</li><li>回滚JavaSE。关于JavaSE中间关于集合那段的语法有点忘了。只记得JavaSE最基础的if，when，while，for了。</li><li>我不知道引入什么包，这点有点寄。</li></ol>]]></content>
    
    
    <summary type="html">比较难消化的一题，记得多来写几遍。【去重，Java集合语法，引包】</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】赎金信383</title>
    <link href="http://lmc.pub/posts/1784299523.html"/>
    <id>http://lmc.pub/posts/1784299523.html</id>
    <published>2023-03-28T01:20:27.000Z</published>
    <updated>2023-03-31T08:04:28.432Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/ransom-note/">赎金信383</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//赎金信383</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RansomNote383</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Solution</span>().canConstruct(<span class="string">&quot;bb&quot;</span>,<span class="string">&quot;ba&quot;</span>))&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">canConstruct</span><span class="params">(String ransomNote, String magazine)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] arr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> item : magazine.toCharArray()) &#123;</span><br><span class="line">    arr[item - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> item : ransomNote.toCharArray()) &#123;</span><br><span class="line">    arr[item - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> item : arr) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">【算法】赎金信383</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】四数相加II454</title>
    <link href="http://lmc.pub/posts/2539118837.html"/>
    <id>http://lmc.pub/posts/2539118837.html</id>
    <published>2023-03-28T01:19:54.000Z</published>
    <updated>2023-03-29T14:11:04.403Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/4sum-ii/">454. 四数相加 II - 力扣（Leetcode）</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">//四数相加II454</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FourSumII454</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">int</span>[] nums1 = &#123;<span class="number">1</span>,<span class="number">2</span>&#125;; </span><br><span class="line"><span class="type">int</span>[] nums2 = &#123;-<span class="number">2</span>,-<span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] nums3 = &#123;-<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] nums4 = &#123;<span class="number">0</span>,<span class="number">2</span>&#125;;</span><br><span class="line">System.out.println(<span class="keyword">new</span> <span class="title class_">Solution</span>().fourSumCount(nums1,nums2,nums3,nums4));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">fourSumCount</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2, <span class="type">int</span>[] nums3, <span class="type">int</span>[] nums4)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    Map&lt;Integer,Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//上两个</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num01 : nums1) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num02 : nums2 ) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sum01</span> <span class="operator">=</span> num01 + num02;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(sum01)) &#123;</span><br><span class="line">    map.put(sum01,map.get(sum01) + <span class="number">1</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    map.put(sum01,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//下面两个</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num03 : nums3) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num04 : nums4 ) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">needNum01</span> <span class="operator">=</span> <span class="number">0</span> - (num03 + num04);</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(needNum01)) &#123;</span><br><span class="line">    res += map.get(needNum01);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">思路和【两数相加】差不多。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】两数之和1</title>
    <link href="http://lmc.pub/posts/3588063365.html"/>
    <id>http://lmc.pub/posts/3588063365.html</id>
    <published>2023-03-28T01:19:29.000Z</published>
    <updated>2023-03-29T14:11:04.402Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/two-sum/description/">1. 两数之和 - 力扣（Leetcode）</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//两数之和1</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TwoSum1</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>[] nums = &#123;<span class="number">9</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">34</span>&#125;;</span><br><span class="line"></span><br><span class="line">System.out.print(<span class="string">&quot;nums:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i : nums) &#123;</span><br><span class="line">System.out.print(<span class="string">&quot;\t&quot;</span> + i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">boolean</span> <span class="variable">again</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span>(again)&#123;</span><br><span class="line">System.out.print(<span class="string">&quot;\n请输入 target(666 退出)：&quot;</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">inputNum</span> <span class="operator">=</span> input.nextInt();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (inputNum == <span class="number">666</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">Solution</span>().twoSum(nums,inputNum);</span><br><span class="line"><span class="keyword">if</span> (res != <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;\n nums[&quot;</span> + res[<span class="number">0</span>] + <span class="string">&quot;] + nums[&quot;</span> + res[<span class="number">1</span>] + <span class="string">&quot;] = &quot;</span> + inputNum);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;匹配失败。&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] twoSum(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="literal">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;Integer,Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> target - nums[i];</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(temp)) &#123;</span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];</span><br><span class="line">    res[<span class="number">1</span>] = i;</span><br><span class="line">    res[<span class="number">0</span>] = map.get(temp);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    map.put(nums[i],i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">力扣no1。点开第一个。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】快乐数202</title>
    <link href="http://lmc.pub/posts/3897625260.html"/>
    <id>http://lmc.pub/posts/3897625260.html</id>
    <published>2023-03-28T01:19:08.000Z</published>
    <updated>2023-03-29T14:11:04.403Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/happy-number/">快乐数202</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//快乐数202</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HappyNumber202</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.print(<span class="string">&quot;快乐数判断：&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Solution</span>().isHappy(input.nextInt())) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;\n您输入的【是】快乐数！&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;\n很抱歉，您输入的【不是】快乐数。&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isHappy</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    Set&lt;Integer&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//前面是‘是’的退出条件，后面是‘不是’的退出条件</span></span><br><span class="line">    <span class="keyword">while</span>(n != <span class="number">1</span> &amp;&amp; !set.contains(n))&#123;</span><br><span class="line">    set.add(n);</span><br><span class="line">    <span class="comment">//n变化</span></span><br><span class="line">    n = newNum(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">return</span> <span class="variable">n</span> <span class="operator">=</span>= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">newNum</span><span class="params">(<span class="type">int</span> origalNum)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(origalNum &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> origalNum % <span class="number">10</span>;</span><br><span class="line">    res += temp * temp;</span><br><span class="line">    origalNum /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">快乐数的定义有点意思是吧。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】两个数组的交集349</title>
    <link href="http://lmc.pub/posts/3956726361.html"/>
    <id>http://lmc.pub/posts/3956726361.html</id>
    <published>2023-03-28T01:18:43.000Z</published>
    <updated>2023-03-29T14:11:04.399Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/intersection-of-two-arrays/description/">leetcode 两个数组的交集 349</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">//两个数组的交集</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IntersectionOfTwoArrays349</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">int</span>[] arr01 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] arr02 = &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] intersectionArr = <span class="keyword">new</span> <span class="title class_">Solution</span>().intersection(arr01,arr02);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> item : intersectionArr) &#123;</span><br><span class="line">System.out.print(item + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] intersection(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2) &#123;</span><br><span class="line">    <span class="comment">//安全性检验</span></span><br><span class="line">    <span class="keyword">if</span> (nums1 == <span class="literal">null</span> || nums1.length == <span class="number">0</span> || nums2 == <span class="literal">null</span> || nums2.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//先把 nums1 存起来</span></span><br><span class="line">    Set&lt;Integer&gt; set01 = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    Set&lt;Integer&gt; same = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> item : nums1) &#123;</span><br><span class="line">    set01.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//把 num2 拿来比</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> item : nums2) &#123;</span><br><span class="line">    <span class="keyword">if</span> (set01.contains(item)) &#123;</span><br><span class="line">    same.add(item);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> same.stream().mapToInt(Integer::intValue).toArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后这个</p><p><code>return same.stream().mapToInt(Integer:intValue).toArray();</code></p><p>需要记一下。</p>]]></content>
    
    
    <summary type="html">涉及Java 集合部分知识，如 Set ，回去复习一下Java基础。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://lmc.pub/posts/0.html"/>
    <id>http://lmc.pub/posts/0.html</id>
    <published>2023-03-27T23:06:56.887Z</published>
    <updated>2023-03-31T23:28:31.545Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/valid-anagram/description/">242. 有效的字母异位词 - 力扣（Leetcode）</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//有效的字母异位词242</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ValidAnagram242</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;aee&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;ee&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Solution</span>().isAnagram(s1,s2)) &#123;</span><br><span class="line">System.out.println(s1 + <span class="string">&quot; 和 &quot;</span> + s2 + <span class="string">&quot;是&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">System.out.println(s1 + <span class="string">&quot; 和 &quot;</span> + s2 + <span class="string">&quot;不是&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAnagram</span><span class="params">(String s, String t)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] record = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">    record[s.charAt(i) - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t.length(); i++) &#123;</span><br><span class="line">    record[t.charAt(i) - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> item : record) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://leetcode.cn/problems/valid-anagram/description/&quot;&gt;242. 有效的字母异位词 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;ta</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>【项目】天气APP</title>
    <link href="http://lmc.pub/posts/658723411.html"/>
    <id>http://lmc.pub/posts/658723411.html</id>
    <published>2023-03-27T23:06:56.000Z</published>
    <updated>2023-04-01T00:21:24.127Z</updated>
    
    <content type="html"><![CDATA[<h1>火山天气</h1><p>天气API：<a href="https://dashboard.caiyunapp.com/v1/token/">彩云科技 | 开放平台 (caiyunapp.com)</a></p><blockquote><ol><li><p>查询全球城市数据信息：<a href="https://api.caiyunapp.com/v2/place?query=%E5%8C%97%E4%BA%AC&amp;token=%7Btoken%7D&amp;lang=zh_CN">https://api.caiyunapp.com/v2/place?query=北京&amp;token={token}&amp;lang=zh_CN</a></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;**status**&quot;</span><span class="punctuation">:</span><span class="string">&quot;ok&quot;</span><span class="punctuation">,</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;**places**&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;**name**&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京市&quot;</span><span class="punctuation">,</span><span class="attr">&quot;**location**&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.9041999</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.4073963</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;**formatted_address**&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国北京市&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京西站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.89491</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.322056</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 莲花池东路118号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京南站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.865195</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.378545</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 永外大街车站路12号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京站(地铁站)&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.904983</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.427287</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 东城区 2号线&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>查询某地区实时天气：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/realtime.json  </code></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;**realtime**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;**temperature**&quot;</span><span class="punctuation">:</span> <span class="number">23.16</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**skycon**&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WIND&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**air_quality**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;aqi&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;chn&quot;</span><span class="punctuation">:</span> <span class="number">17.0</span> <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure></li><li><p>查询未来几天天气信息接口：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/daily.json  </code></p><p>返回的JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;daily&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;max&quot;</span><span class="punctuation">:</span> <span class="number">25.7</span><span class="punctuation">,</span> <span class="attr">&quot;min&quot;</span><span class="punctuation">:</span> <span class="number">20.3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;skycon&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CLOUDY&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2019-10-20T00:00+08:00&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;life_index&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coldRisk&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;易发&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;carWashing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;适宜&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ultraviolet&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;dressing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;舒适&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h2 id="1-MVVM项目架构">1. MVVM项目架构</h2><p>MVVM：Model-View-ViewModel  （还有MVP/MVC）</p><p>Model：数据模型</p><p>View：界面展示</p><p>ViewModel：连接数据和界面的桥梁</p><p>实现让业务逻辑和界面展示分离的程序结构设计</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221103164101961.png" alt="image-20221103164101961"></p><p>UI控制层：Activity，Fragment，布局文件等和界面有关的东西；</p><p>ViewModel层：持有和UI元素相关的数据，并保证旋转不会丢失；同时提供接口给UI控制层调用和仓库层通信；</p><p>仓库层：判断调用请求的数据去哪里获取</p><p>本地数据源：SQLite，SharedPreferences</p><p>网络数据库：Retrofit访问服务器提供的Webservice接口来获得</p><p>注意：箭头是单向的，表示上一层只能持有下一层的引用。不能反过来也不能跨层</p><p>项目结构：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221103165442048.png" alt="image-20221103165442048"></p><p>依赖：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.core:core-ktx:1.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.google.android.material:material:1.4.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.recyclerview:recyclerview:1.2.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-extensions:2.2.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-livedata-ktx:2.5.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.1.0&quot;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:retrofit:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:converter-gson:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.1&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.1&quot;</span></span><br><span class="line"></span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.13.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-城市数据">2. 城市数据</h2><blockquote><ol><li><p>查询全球城市数据信息：<a href="https://api.caiyunapp.com/v2/place?query=%E5%8C%97%E4%BA%AC&amp;token=%7Btoken%7D&amp;lang=zh_CN">https://api.caiyunapp.com/v2/place?query=北京&amp;token={token}&amp;lang=zh_CN</a></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;**status**&quot;</span><span class="punctuation">:</span><span class="string">&quot;ok&quot;</span><span class="punctuation">,</span><span class="attr">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;**places**&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;**name**&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京市&quot;</span><span class="punctuation">,</span><span class="attr">&quot;**location**&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.9041999</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.4073963</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;**formatted_address**&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国北京市&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京西站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.89491</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.322056</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 莲花池东路118号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京南站&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.865195</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.378545</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 丰台区 永外大街车站路12号&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;北京站(地铁站)&quot;</span><span class="punctuation">,</span><span class="attr">&quot;location&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span><span class="number">39.904983</span><span class="punctuation">,</span><span class="attr">&quot;lng&quot;</span><span class="punctuation">:</span><span class="number">116.427287</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;formatted_address&quot;</span><span class="punctuation">:</span><span class="string">&quot;中国 北京市 东城区 2号线&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="2-1-逻辑层">2.1 逻辑层</h3><h4 id="2-1-1-准备工作">2.1.1 准备工作</h4><p><strong>全局获取context</strong></p><blockquote><p>为什么？</p><p>因为MVVM这种分层架构设计，我们在ViewModel就不再持有Activity的引用了，所以会经常出现缺<code>context</code>的情况。</p></blockquote><ol><li><p>在com.lmc.volcanoweather包下新建一个VolcanoWeatherApplication类:</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106162714195.png" alt="image-20221106162714195"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="comment">//全局获取context</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VolcanoWeatherApplication</span>:<span class="type">Application</span></span>() &#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="meta">@SuppressLint(<span class="string">&quot;StaticFieldLeak&quot;</span>)</span></span><br><span class="line">        <span class="keyword">lateinit</span> <span class="keyword">var</span> context: Context</span><br><span class="line">        <span class="comment">//天气API的令牌值</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">val</span> TOKEN = <span class="string">&quot;NL0AtaDgGQO3Ytfg&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line">        context = applicationContext</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>顺手把天气API的令牌值放进去</p></li><li><p>在AndroidManifest下指定用我们这个VolcanoWeatherApplication</p><p>就下面name那一句指定下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:name</span>=<span class="string">&quot;.VolcanoWeatherApplication&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.VolcanoWeather&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">tools:targetApi</span>=<span class="string">&quot;31&quot;</span>&gt;</span></span><br><span class="line">      ……</span><br><span class="line">   <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-2-数据模型">2.1.2 数据模型</h4><ol><li><p>logic-》model 下建立一个个PlaceResponse.kt</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106164054048.png" alt="image-20221106164054048"></p><p>代码：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaceResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> places: List&lt;Place&gt;)</span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Place</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> location: Location,</span><br><span class="line">                 <span class="meta">@SerializedName(<span class="string">&quot;formatted_address&quot;</span>)</span> <span class="keyword">val</span> address: String)<span class="comment">//JSON中字段命名和Kotlin中命名规范不一致就用一下这个</span></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Location</span></span>(<span class="keyword">val</span> lng: String, <span class="keyword">val</span> lat: String)</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-3-网络层">2.1.3 网络层</h4><ol><li><p>定义一个Retrofit接口（访问彩云天气城市搜索API:logic/network下新建PlaceService）</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.PlaceResponse</span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.GET</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.Query</span><br><span class="line"><span class="comment">//位置服务</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PlaceService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//发送的网络请求只有query(地址)，其他的都不会变</span></span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2/place?token=<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>&amp;lang=zh_CN&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(<span class="meta">@Query(<span class="string">&quot;query&quot;</span>)</span> query: <span class="type">String</span>)</span></span>:Call&lt;PlaceResponse&gt;<span class="comment">//数据返回结果解析成PlaceResponse</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>创建一个Retrofit构造器（logic/network-》ServiceCreator单例类）</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> retrofit2.Retrofit</span><br><span class="line"><span class="keyword">import</span> retrofit2.converter.gson.GsonConverterFactory</span><br><span class="line"></span><br><span class="line"><span class="comment">//Retrofit的构造器</span></span><br><span class="line"><span class="keyword">object</span> ServiceCreator &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">val</span> BASE_URL = <span class="string">&quot;https://api.caiyunapp.com/&quot;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> retrofit = Retrofit.Builder()</span><br><span class="line">        .baseUrl(BASE_URL)</span><br><span class="line">        .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">create</span><span class="params">(serviceClass: <span class="type">Class</span>&lt;<span class="type">T</span>&gt;)</span></span>: T = retrofit.create(serviceClass)</span><br><span class="line">    <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T&gt;</span> <span class="title">create</span><span class="params">()</span></span>: T = create(T::<span class="keyword">class</span>.java)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>一个统一的网络数据源访问入口（对所有网络请求API进行封装）logic/network/VolcanoWeatherNetwork单例类</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.Callback</span><br><span class="line"><span class="keyword">import</span> retrofit2.Response</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.resume</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.resumeWithException</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.suspendCoroutine</span><br><span class="line"></span><br><span class="line"><span class="comment">//一个统一的网络数据源访问入口</span></span><br><span class="line"><span class="keyword">object</span> VolcanoWeatherNetwork &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> placeService = ServiceCreator.create&lt;PlaceService&gt;()<span class="comment">//创建了一个PlaceService接口的动态代理对象</span></span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = placeService.searchPlaces(query).await()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Call<span class="type">&lt;T&gt;</span>.<span class="title">await</span><span class="params">()</span></span>: T &#123;</span><br><span class="line">        <span class="keyword">return</span> suspendCoroutine &#123; continuation -&gt;</span><br><span class="line">            enqueue(<span class="keyword">object</span> : Callback&lt;T&gt; &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResponse</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, response: <span class="type">Response</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> body = response.body()</span><br><span class="line">                    <span class="keyword">if</span> (body != <span class="literal">null</span>) continuation.resume(body)</span><br><span class="line">                    <span class="keyword">else</span> continuation.resumeWithException(</span><br><span class="line">                        RuntimeException(<span class="string">&quot;response body is null&quot;</span>))</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onFailure</span><span class="params">(call: <span class="type">Call</span>&lt;<span class="type">T</span>&gt;, t: <span class="type">Throwable</span>)</span></span> &#123;</span><br><span class="line">                    continuation.resumeWithException(t)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-1-4-仓库层">2.1.4 仓库层</h4><blockquote><p>仓库层主要工作：判断调用方请求的数据要从哪里拿（本地还是网络？）并拿到给调用方。</p><p>相当于他是调用和缓存的中间件，每次有调用请求先看下本地有没有缓存，没有就直接去网络或者内存中拿。</p></blockquote><p>这里没有做缓存必要，直接全去网络。</p><p>logic下做一个Repository单例类，作为仓库层的统一封装入口。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221106171104592.png" alt="image-20221106171104592"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.liveData</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.network.VolcanoWeatherNetwork</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.Dispatchers</span><br><span class="line"></span><br><span class="line"><span class="comment">//仓库层的统一封装入口</span></span><br><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = liveData(Dispatchers.IO) &#123;<span class="comment">//这里设置全是在子线程中干活</span></span><br><span class="line">        <span class="keyword">val</span> result = <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> placeResponse = VolcanoWeatherNetwork.searchPlaces(query)</span><br><span class="line">            <span class="keyword">if</span> (placeResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">val</span> places = placeResponse.places</span><br><span class="line">                Result.success(places)<span class="comment">//这个是Kotlin自带的包装方法</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Result.failure(RuntimeException(<span class="string">&quot;response status is <span class="subst">$&#123;placeResponse.status&#125;</span>&quot;</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">            Result.failure&lt;List&lt;Place&gt;&gt;(e)</span><br><span class="line">        &#125;</span><br><span class="line">        emit(result)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-1-5-ViewModel层">2.1.5 ViewModel层</h4><blockquote><p>这是逻辑层和UI层的一个桥梁，但是更加偏向逻辑。但又由于ViewModel和Activity还有Fragment是一一对应的。所有把他们放在一起好了。</p></blockquote><p>ui/place下新建一个PlaceViewModel</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Transformations</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.Repository</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="comment">//ViewModel层</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceViewModel</span>:<span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> searchLiveData = MutableLiveData&lt;String&gt;()</span><br><span class="line">    <span class="keyword">val</span> placeList = ArrayList&lt;Place&gt;()</span><br><span class="line">    <span class="keyword">val</span> placeLiveData = Transformations.switchMap(searchLiveData) &#123; query -&gt;</span><br><span class="line">        Repository.searchPlaces(query)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        searchLiveData.value = query</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-UI层">2.2 UI层</h3><h4 id="2-2-1-界面总布局">2.2.1 界面总布局</h4><p>在res/layout目录中新建fragment_place.xml布局</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;?android:windowBackground&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/bgImageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/bg_place&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/actionBarLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@color/design_default_color_primary&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/searchPlaceEdit&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:paddingStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:paddingEnd</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:hint</span>=<span class="string">&quot;输入地址&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">&quot;@drawable/search_bg&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/actionBarLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:visibility</span>=<span class="string">&quot;gone&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107142453630.png" alt="image-20221107142453630"></p><h4 id="2-2-2-RecycleView的善后工作">2.2.2 RecycleView的善后工作</h4><ol><li><p>子项布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107142710677.png" alt="image-20221107142710677"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;130dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;12dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_margin</span>=<span class="string">&quot;18dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeName&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeAddress&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorSecondary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107143253929.png" alt="image-20221107143253929"></p></li><li><p>RecycleView适配器</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107143356782.png" alt="image-20221107143356782"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="comment">//RecyclerView适配器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: Fragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList: List&lt;Place&gt;) :</span><br><span class="line">    RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(view: View) : RecyclerView.ViewHolder(view) &#123;</span><br><span class="line">        <span class="keyword">val</span> placeName: TextView = view.findViewById(R.id.placeName)</span><br><span class="line">        <span class="keyword">val</span> placeAddress: TextView = view.findViewById(R.id.placeAddress)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">            parent, <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">return</span> ViewHolder(view)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">        holder.placeName.text = place.name</span><br><span class="line">        holder.placeAddress.text = place.address</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = placeList.size</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-2-3-Fragment">2.2.3 Fragment</h4><ol><li>Fragment实现</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107144434547.png" alt="image-20221107144434547"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.place</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.core.widget.addTextChangedListener</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Observer</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.fragment_place.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span>:<span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(PlaceViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> adapter: PlaceAdapter</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(inflater: <span class="type">LayoutInflater</span>, container: <span class="type">ViewGroup</span>?,</span></span></span><br><span class="line"><span class="params"><span class="function">                              savedInstanceState: <span class="type">Bundle</span>?)</span></span>: View? &#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_place, container, <span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinearLayoutManager(activity)</span><br><span class="line">        recyclerView.layoutManager = layoutManager</span><br><span class="line">        adapter = PlaceAdapter(<span class="keyword">this</span>, viewModel.placeList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">        searchPlaceEdit.addTextChangedListener &#123; editable -&gt;</span><br><span class="line">            <span class="keyword">val</span> content = editable.toString()</span><br><span class="line">            <span class="keyword">if</span> (content.isNotEmpty()) &#123;</span><br><span class="line">                viewModel.searchPlaces(content)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                recyclerView.visibility = View.GONE</span><br><span class="line">                bgImageView.visibility = View.VISIBLE</span><br><span class="line">                viewModel.placeList.clear()</span><br><span class="line">                adapter.notifyDataSetChanged()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        viewModel.placeLiveData.observe(viewLifecycleOwner, Observer&#123; result -&gt;</span><br><span class="line">            <span class="keyword">val</span> places = result.getOrNull()</span><br><span class="line">            <span class="keyword">if</span> (places != <span class="literal">null</span>) &#123;</span><br><span class="line">                recyclerView.visibility = View.VISIBLE</span><br><span class="line">                bgImageView.visibility = View.GONE</span><br><span class="line">                viewModel.placeList.clear()</span><br><span class="line">                viewModel.placeList.addAll(places)</span><br><span class="line">                adapter.notifyDataSetChanged()</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Toast.makeText(activity, <span class="string">&quot;未能查询到任何地点&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>将Fragment添加到Activity中</p><p>activity_main.xml中的代码:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.lmc.volcanoweather.ui.place.PlaceFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>隐藏原生的ActionBar</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107145752864.png" alt="image-20221107145752864"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.MaterialComponents.Light.NoActionBar&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>申请权限</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">package</span>=<span class="string">&quot;com.sunnyweather.android&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>结果：<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107150029243.png" alt="image-20221107150029243"></p><p>os：其实地方名，地址，经纬度都拿到了</p><h2 id="3-天气信息">3. 天气信息</h2><blockquote><ol start="2"><li><p>查询某地区实时天气：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/realtime.json  </code></p><p>返回JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;**realtime**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;**temperature**&quot;</span><span class="punctuation">:</span> <span class="number">23.16</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**skycon**&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WIND&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;**air_quality**&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;aqi&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;chn&quot;</span><span class="punctuation">:</span> <span class="number">17.0</span> <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure></li><li><p>查询未来几天天气信息接口：</p><p><code>https://api.caiyunapp.com/v2.5/&#123;token&#125;/116.4073963,39.9041999/daily.json  </code></p><p>返回的JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ok&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;daily&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;max&quot;</span><span class="punctuation">:</span> <span class="number">25.7</span><span class="punctuation">,</span> <span class="attr">&quot;min&quot;</span><span class="punctuation">:</span> <span class="number">20.3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;skycon&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CLOUDY&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;2019-10-20T00:00+08:00&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;life_index&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;coldRisk&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;易发&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;carWashing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;适宜&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ultraviolet&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;无&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;dressing&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="punctuation">&#123;</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;舒适&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> ... <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="3-1-逻辑">3.1 逻辑</h3><h4 id="3-1-1-数据模型">3.1.1 数据模型</h4><ol><li>RealtimeResponse</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107150555760.png" alt="image-20221107150555760"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">RealtimeResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> result: Result) &#123;</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span></span>(<span class="keyword">val</span> realtime: Realtime)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Realtime</span></span>(<span class="keyword">val</span> skycon: String, <span class="keyword">val</span> temperature: <span class="built_in">Float</span>,</span><br><span class="line">                        <span class="meta">@SerializedName(<span class="string">&quot;air_quality&quot;</span>)</span> <span class="keyword">val</span> airQuality: AirQuality)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">AirQuality</span></span>(<span class="keyword">val</span> aqi: AQI)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">AQI</span></span>(<span class="keyword">val</span> chn: <span class="built_in">Float</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所有数据模型类都定义在RealtimeResonse内部可以有效防止和其他接口的数据类型重名冲突的情况</p><ol start="2"><li>DailyResponse</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.annotations.SerializedName</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">DailyResponse</span></span>(<span class="keyword">val</span> status: String, <span class="keyword">val</span> result: Result) &#123;</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span></span>(<span class="keyword">val</span> daily: Daily)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Daily</span></span>(<span class="keyword">val</span> temperature: List&lt;Temperature&gt;, <span class="keyword">val</span> skycon: List&lt;Skycon&gt;,</span><br><span class="line">                     <span class="meta">@SerializedName(<span class="string">&quot;life_index&quot;</span>)</span> <span class="keyword">val</span> lifeIndex: LifeIndex)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Temperature</span></span>(<span class="keyword">val</span> max: <span class="built_in">Float</span>, <span class="keyword">val</span> min: <span class="built_in">Float</span>)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Skycon</span></span>(<span class="keyword">val</span> value: String, <span class="keyword">val</span> date: Date)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeIndex</span></span>(<span class="keyword">val</span> coldRisk: List&lt;LifeDescription&gt;, <span class="keyword">val</span> carWashing:</span><br><span class="line">    List&lt;LifeDescription&gt;, <span class="keyword">val</span> ultraviolet: List&lt;LifeDescription&gt;,</span><br><span class="line">                         <span class="keyword">val</span> dressing: List&lt;LifeDescription&gt;)</span><br><span class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeDescription</span></span>(<span class="keyword">val</span> desc: String)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><p>整和上面两个的 Weather</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107152815165.png" alt="image-20221107152815165"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Weather</span></span>(<span class="keyword">val</span> realtime: RealtimeResponse.Realtime, <span class="keyword">val</span> daily: DailyResponse.Daily)</span><br></pre></td></tr></table></figure></li><li><p>Sky(这个是在UI后面补充的)</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107165606951.png" alt="image-20221107165606951"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sky</span></span>(<span class="keyword">val</span> info: String, <span class="keyword">val</span> icon: <span class="built_in">Int</span>, <span class="keyword">val</span> bg: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> sky = mapOf(</span><br><span class="line">    <span class="string">&quot;CLEAR_DAY&quot;</span> to Sky(<span class="string">&quot;晴&quot;</span>, R.drawable.ic_clear_day, R.drawable.bg_clear_day),</span><br><span class="line">    <span class="string">&quot;CLEAR_NIGHT&quot;</span> to Sky(<span class="string">&quot;晴&quot;</span>, R.drawable.ic_clear_night, R.drawable.bg_clear_night),</span><br><span class="line">    <span class="string">&quot;PARTLY_CLOUDY_DAY&quot;</span> to Sky(</span><br><span class="line">        <span class="string">&quot;多云&quot;</span>, R.drawable.ic_partly_cloud_day,</span><br><span class="line">        R.drawable.bg_partly_cloudy_day</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;PARTLY_CLOUDY_NIGHT&quot;</span> to Sky(</span><br><span class="line">        <span class="string">&quot;多云&quot;</span>, R.drawable.ic_partly_cloud_night,</span><br><span class="line">        R.drawable.bg_partly_cloudy_night</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">&quot;CLOUDY&quot;</span> to Sky(<span class="string">&quot;阴&quot;</span>, R.drawable.ic_cloudy, R.drawable.bg_cloudy),</span><br><span class="line">    <span class="string">&quot;WIND&quot;</span> to Sky(<span class="string">&quot;大风&quot;</span>, R.drawable.ic_cloudy, R.drawable.bg_wind),</span><br><span class="line">    <span class="string">&quot;LIGHT_RAIN&quot;</span> to Sky(<span class="string">&quot;小雨&quot;</span>, R.drawable.ic_light_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;MODERATE_RAIN&quot;</span> to Sky(<span class="string">&quot;中雨&quot;</span>, R.drawable.ic_moderate_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;HEAVY_RAIN&quot;</span> to Sky(<span class="string">&quot;大雨&quot;</span>, R.drawable.ic_heavy_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;STORM_RAIN&quot;</span> to Sky(<span class="string">&quot;暴雨&quot;</span>, R.drawable.ic_storm_rain, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;THUNDER_SHOWER&quot;</span> to Sky(<span class="string">&quot;雷阵雨&quot;</span>, R.drawable.ic_thunder_shower, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;SLEET&quot;</span> to Sky(<span class="string">&quot;雨夹雪&quot;</span>, R.drawable.ic_sleet, R.drawable.bg_rain),</span><br><span class="line">    <span class="string">&quot;LIGHT_SNOW&quot;</span> to Sky(<span class="string">&quot;小雪&quot;</span>, R.drawable.ic_light_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;MODERATE_SNOW&quot;</span> to Sky(<span class="string">&quot;中雪&quot;</span>, R.drawable.ic_moderate_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;HEAVY_SNOW&quot;</span> to Sky(<span class="string">&quot;大雪&quot;</span>, R.drawable.ic_heavy_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;STORM_SNOW&quot;</span> to Sky(<span class="string">&quot;暴雪&quot;</span>, R.drawable.ic_heavy_snow, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;HAIL&quot;</span> to Sky(<span class="string">&quot;冰雹&quot;</span>, R.drawable.ic_hail, R.drawable.bg_snow),</span><br><span class="line">    <span class="string">&quot;LIGHT_HAZE&quot;</span> to Sky(<span class="string">&quot;轻度雾霾&quot;</span>, R.drawable.ic_light_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;MODERATE_HAZE&quot;</span> to Sky(<span class="string">&quot;中度雾霾&quot;</span>, R.drawable.ic_moderate_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;HEAVY_HAZE&quot;</span> to Sky(<span class="string">&quot;重度雾霾&quot;</span>, R.drawable.ic_heavy_haze, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;FOG&quot;</span> to Sky(<span class="string">&quot;雾&quot;</span>, R.drawable.ic_fog, R.drawable.bg_fog),</span><br><span class="line">    <span class="string">&quot;DUST&quot;</span> to Sky(<span class="string">&quot;浮尘&quot;</span>, R.drawable.ic_fog, R.drawable.bg_fog)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getSky</span><span class="params">(skycon: <span class="type">String</span>)</span></span>: Sky &#123;</span><br><span class="line">    <span class="keyword">return</span> sky[skycon] ?: sky[<span class="string">&quot;CLEAR_DAY&quot;</span>]!!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="3-1-2-网络层">3.1.2 网络层</h4><h5 id="1-访问天气信息API的Retrofit接口">1. 访问天气信息API的Retrofit接口</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153005106.png" alt="image-20221107153005106"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.network</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.DailyResponse</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.RealtimeResponse</span><br><span class="line"><span class="keyword">import</span> retrofit2.Call</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.GET</span><br><span class="line"><span class="keyword">import</span> retrofit2.http.Path</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">WeatherService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2.5/<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>/&#123;lng&#125;,&#123;lat&#125;/realtime.json&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getRealtimeWeather</span><span class="params">(<span class="meta">@Path(<span class="string">&quot;lng&quot;</span>)</span> lng: <span class="type">String</span>, <span class="meta">@Path(<span class="string">&quot;lat&quot;</span>)</span> lat: <span class="type">String</span>)</span></span>:</span><br><span class="line">            Call&lt;RealtimeResponse&gt;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;v2.5/<span class="subst">$&#123;VolcanoWeatherApplication.TOKEN&#125;</span>/&#123;lng&#125;,&#123;lat&#125;/daily.json&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getDailyWeather</span><span class="params">(<span class="meta">@Path(<span class="string">&quot;lng&quot;</span>)</span> lng: <span class="type">String</span>, <span class="meta">@Path(<span class="string">&quot;lat&quot;</span>)</span> lat: <span class="type">String</span>)</span></span>:</span><br><span class="line">            Call&lt;DailyResponse&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-VolcanoWeatherNetwork网络数据源访问入口对新加的这个接口进行封装">2.VolcanoWeatherNetwork网络数据源访问入口对新加的这个接口进行封装</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153503788.png" alt="image-20221107153503788"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> VolcanoWeatherNetwork &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> weatherService = ServiceCreator.create(WeatherService::<span class="keyword">class</span>.java)</span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">getDailyWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> =</span><br><span class="line">    weatherService.getDailyWeather(lng, lat).await()</span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">getRealtimeWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> =</span><br><span class="line">    weatherService.getRealtimeWeather(lng, lat).await()</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-3-仓库层">3.1.3 仓库层</h4><ol><li>修改Repository中的代码：</li></ol><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107153731630.png" alt="image-20221107153731630"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.liveData</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Weather</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.network.VolcanoWeatherNetwork</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.Dispatchers</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.async</span><br><span class="line"><span class="keyword">import</span> kotlinx.coroutines.coroutineScope</span><br><span class="line"><span class="keyword">import</span> kotlin.coroutines.CoroutineContext</span><br><span class="line"></span><br><span class="line"><span class="comment">//仓库层的统一封装入口</span></span><br><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">searchPlaces</span><span class="params">(query: <span class="type">String</span>)</span></span> = fire(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">val</span> placeResponse = VolcanoWeatherNetwork.searchPlaces(query)</span><br><span class="line">        <span class="keyword">if</span> (placeResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> places = placeResponse.places</span><br><span class="line">            Result.success(places)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Result.failure(RuntimeException(<span class="string">&quot;response status is <span class="subst">$&#123;placeResponse.status&#125;</span>&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> = fire(Dispatchers.IO) &#123;</span><br><span class="line">        coroutineScope &#123;</span><br><span class="line">            <span class="keyword">val</span> deferredRealtime = async &#123;</span><br><span class="line">                VolcanoWeatherNetwork.getRealtimeWeather(lng, lat)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> deferredDaily = async &#123;</span><br><span class="line">                VolcanoWeatherNetwork.getDailyWeather(lng, lat)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">val</span> realtimeResponse = deferredRealtime.await()</span><br><span class="line">            <span class="keyword">val</span> dailyResponse = deferredDaily.await()</span><br><span class="line">            <span class="comment">//这两个执行完才能往下走</span></span><br><span class="line">            <span class="keyword">if</span> (realtimeResponse.status == <span class="string">&quot;ok&quot;</span> &amp;&amp; dailyResponse.status == <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">val</span> weather = Weather(realtimeResponse.result.realtime,</span><br><span class="line">                    dailyResponse.result.daily)</span><br><span class="line">                Result.success(weather)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Result.failure(</span><br><span class="line">                    RuntimeException(</span><br><span class="line">                        <span class="string">&quot;realtime response status is <span class="subst">$&#123;realtimeResponse.status&#125;</span>&quot;</span> +</span><br><span class="line">                                <span class="string">&quot;daily response status is <span class="subst">$&#123;dailyResponse.status&#125;</span>&quot;</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//这个fire是升级过后的东西拉</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">fire</span><span class="params">(context: <span class="type">CoroutineContext</span>, block: <span class="type">suspend</span> () -&gt; <span class="type">Result</span>&lt;<span class="type">T</span>&gt;)</span></span> =</span><br><span class="line">        liveData&lt;Result&lt;T&gt;&gt;(context) &#123;</span><br><span class="line">            <span class="keyword">val</span> result = <span class="keyword">try</span> &#123;</span><br><span class="line">                block()</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">                Result.failure&lt;T&gt;(e)</span><br><span class="line">            &#125;</span><br><span class="line">            emit(result)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-4-ViewModel">3.1.4 ViewModel</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107160307510.png" alt="image-20221107160307510"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.wealther</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Transformations</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.Repository</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Location</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> locationLiveData = MutableLiveData&lt;Location&gt;()</span><br><span class="line">    <span class="comment">//下面三个都是和界面相关的数据，所以放在 ViewModel</span></span><br><span class="line">    <span class="keyword">var</span> locationLng = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> locationLat = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> placeName = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">//这个是转换LiveData观察用的</span></span><br><span class="line">    <span class="keyword">val</span> weatherLiveData = Transformations.switchMap(locationLiveData) &#123; location -&gt;</span><br><span class="line">        Repository.refreshWeather(location.lng, location.lat)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">(lng: <span class="type">String</span>, lat: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        locationLiveData.value = Location(lng, lat)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-UI">3.2 UI</h3><h4 id="3-2-1-显示天气的Activity">3.2.1 显示天气的Activity</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161254732.png" alt="image-20221107161254732"></p><p>activity_weather.xml（这个在创建Activity的时候会自动创建） 会是很长的一个布局，我们用引用布局的形式。</p><h4 id="3-2-2-now">3.2.2 now</h4><p>当前天气信息布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161927746.png" alt="image-20221107161927746"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107161905024.png" alt="image-20221107161905024"></p><h4 id="3-2-3-forecast">3.2.3 forecast</h4><p>未来几天天气信息布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162109721.png" alt="image-20221107162109721"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162402138.png" alt="image-20221107162402138"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">    xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">    android:layout_marginLeft=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    android:layout_marginRight=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    android:layout_marginTop=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">    app:cardCornerRadius=<span class="string">&quot;4dp&quot;</span>&gt;</span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:orientation=<span class="string">&quot;vertical&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_marginStart=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">            android:layout_marginTop=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">            android:layout_marginBottom=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;预报&quot;</span></span><br><span class="line">            android:textColor=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span><br><span class="line">            android:textSize=<span class="string">&quot;20sp&quot;</span>/&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:id=<span class="string">&quot;@+id/forecastLayout&quot;</span></span><br><span class="line">            android:orientation=<span class="string">&quot;vertical&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span>&gt;</span><br><span class="line">        &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/com.google.android.material.card.MaterialCardView&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-4-fprecast-item">3.2.4 fprecast_item</h4><p>未来天气信息的子项布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162540732.png" alt="image-20221107162540732"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107162940272.png" alt="image-20221107162940272"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/dateInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/skyIcon&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;20dp&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/skyInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/temperatureInfo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;end&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-5-life-index">3.2.5 life_index</h4><p>生活指数的布局</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164104493.png" alt="image-20221107164104493"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164800332.png" alt="image-20221107164800332"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107164937530.png" alt="image-20221107164937530"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;生活指数&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;20dp&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/coldRiskImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_coldrisk&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/coldRiskImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;感冒&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/coldRiskText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/dressingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_dressing&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/dressingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;穿衣&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/dressingText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;20dp&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/ultravioletImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_ultraviolet&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/ultravioletImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;实时紫外线&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/ultravioletText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/carWashingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerVertical</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_carwashing&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/carWashingImg&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;12sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">&quot;洗车&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">&quot;@+id/carWashingText&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:textColor</span>=<span class="string">&quot;?android:attr/textColorPrimary&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-6-引入">3.2.6 引入</h4><p>将上面4个模块加载进显示天气的Activity</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107165138692.png" alt="image-20221107165138692"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/weatherLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:scrollbars</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:overScrollMode</span>=<span class="string">&quot;never&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:visibility</span>=<span class="string">&quot;invisible&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/now&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/forecast&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/life_index&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-7-Sky转换函数准备">3.2.7 Sky转换函数准备</h4><p>见3.1.1 最后一个</p><h4 id="3-2-8-WeatherActivity下">3.2.8 WeatherActivity下</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.ui.wealther</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.Observer</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.R</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Weather</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.getSky</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_weather.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.forecast.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.life_index.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.now.*</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(WeatherViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_weather)</span><br><span class="line">        <span class="comment">//下面三个是从Intent中去除经纬坐标和地区名称</span></span><br><span class="line">        <span class="keyword">if</span> (viewModel.locationLng.isEmpty()) &#123;</span><br><span class="line">            viewModel.locationLng = intent.getStringExtra(<span class="string">&quot;location_lng&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (viewModel.locationLat.isEmpty()) &#123;</span><br><span class="line">            viewModel.locationLat = intent.getStringExtra(<span class="string">&quot;location_lat&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (viewModel.placeName.isEmpty()) &#123;</span><br><span class="line">            viewModel.placeName = intent.getStringExtra(<span class="string">&quot;place_name&quot;</span>) ?: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//观察天气LiveData，当获取到服务器返回数据就展示出来</span></span><br><span class="line">        viewModel.weatherLiveData.observe(<span class="keyword">this</span>, Observer &#123; result -&gt;</span><br><span class="line">            <span class="keyword">val</span> weather = result.getOrNull()</span><br><span class="line">            <span class="keyword">if</span> (weather != <span class="literal">null</span>) &#123;</span><br><span class="line">                showWeatherInfo(weather)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;无法成功获取天气信息&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        viewModel.refreshWeather(viewModel.locationLng, viewModel.locationLat)<span class="comment">//执行了一次刷新天气的请求</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showWeatherInfo</span><span class="params">(weather: <span class="type">Weather</span>)</span></span> &#123;</span><br><span class="line">        placeName.text = viewModel.placeName</span><br><span class="line">        <span class="keyword">val</span> realtime = weather.realtime</span><br><span class="line">        <span class="keyword">val</span> daily = weather.daily</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充now.xml布局中的数据</span></span><br><span class="line">        <span class="keyword">val</span> currentTempText = <span class="string">&quot;<span class="subst">$&#123;realtime.temperature.toInt()&#125;</span> ℃&quot;</span></span><br><span class="line">        currentTemp.text = currentTempText</span><br><span class="line">        currentSky.text = getSky(realtime.skycon).info</span><br><span class="line">        <span class="keyword">val</span> currentPM25Text = <span class="string">&quot;空气指数 <span class="subst">$&#123;realtime.airQuality.aqi.chn.toInt()&#125;</span>&quot;</span></span><br><span class="line">        currentAQI.text = currentPM25Text</span><br><span class="line">        nowLayout.setBackgroundResource(getSky(realtime.skycon).bg)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充forecast.xml布局中的数据</span></span><br><span class="line">        forecastLayout.removeAllViews()</span><br><span class="line">        <span class="keyword">val</span> days = daily.skycon.size</span><br><span class="line">        <span class="comment">//下面这个循环是拿到未来每天的天气信息</span></span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0</span> until days) &#123;</span><br><span class="line">            <span class="keyword">val</span> skycon = daily.skycon[i]</span><br><span class="line">            <span class="keyword">val</span> temperature = daily.temperature[i]</span><br><span class="line">            <span class="keyword">val</span> view = LayoutInflater.from(<span class="keyword">this</span>).inflate(</span><br><span class="line">                R.layout.forecast_item,</span><br><span class="line">                forecastLayout, <span class="literal">false</span></span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">val</span> dateInfo = view.findViewById(R.id.dateInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> skyIcon = view.findViewById(R.id.skyIcon) <span class="keyword">as</span> ImageView</span><br><span class="line">            <span class="keyword">val</span> skyInfo = view.findViewById(R.id.skyInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> temperatureInfo = view.findViewById(R.id.temperatureInfo) <span class="keyword">as</span> TextView</span><br><span class="line">            <span class="keyword">val</span> simpleDateFormat = SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>, Locale.getDefault())</span><br><span class="line">            dateInfo.text = simpleDateFormat.format(skycon.date)</span><br><span class="line">            <span class="keyword">val</span> sky = getSky(skycon.value)</span><br><span class="line">            skyIcon.setImageResource(sky.icon)</span><br><span class="line">            skyInfo.text = sky.info</span><br><span class="line">            <span class="keyword">val</span> tempText = <span class="string">&quot;<span class="subst">$&#123;temperature.min.toInt()&#125;</span> ~ <span class="subst">$&#123;temperature.max.toInt()&#125;</span> ℃&quot;</span></span><br><span class="line">            temperatureInfo.text = tempText</span><br><span class="line">            forecastLayout.addView(view)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 填充life_index.xml布局中的数据</span></span><br><span class="line">        <span class="keyword">val</span> lifeIndex = daily.lifeIndex</span><br><span class="line">        <span class="comment">//生活指数有很多天的，我们只拿出当天的</span></span><br><span class="line">        coldRiskText.text = lifeIndex.coldRisk[<span class="number">0</span>].desc</span><br><span class="line">        dressingText.text = lifeIndex.dressing[<span class="number">0</span>].desc</span><br><span class="line">        ultravioletText.text = lifeIndex.ultraviolet[<span class="number">0</span>].desc</span><br><span class="line">        carWashingText.text = lifeIndex.carWashing[<span class="number">0</span>].desc</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//获取了所有数据要让他们显示出来</span></span><br><span class="line">        weatherLayout.visibility = View.VISIBLE</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-9-界面跳转">3.2.9 界面跳转</h4><p>从搜索城市界面跳转到天气界面</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107171916611.png" alt="image-20221107171916611"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: Fragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList: List&lt;Place&gt;) :</span><br><span class="line">RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">    <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">    parent, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">val</span> holder = ViewHolder(view)</span><br><span class="line">    holder.itemView.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> position = holder.adapterPosition</span><br><span class="line">    <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(parent.context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    fragment.startActivity(intent)</span><br><span class="line">    fragment.activity?.finish()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> holder</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果出现这个Bug：</p><p><code>    android.content.ActivityNotFoundException: Unable to find explicit activity class &#123;com.lmc.volcanoweather/com.lmc.volcanoweather.ui.wealther.WeatherActivity&#125;; have you declared this activity in your AndroidManifest.xml?</code></p><p>则AndroidManifest.xml这里改一下：看图</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173037558.png" alt="image-20221107173037558"></p><p>我ui下面weather包名之前写错了，之前是wealther 现在改过来了weather</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173054749.png" alt="image-20221107173054749"></p></blockquote><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107173351243.png" alt="image-20221107173351243"></p><p>美化：</p><p>之前美化是用的Material库来做的，虽然优秀但是复杂。今天来个更简单的实现方式。</p><p>WeatherActivity中：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">   /下面这里是设置那个状态栏的</span><br><span class="line">        <span class="keyword">val</span> decorView = window.decorView</span><br><span class="line">        decorView.systemUiVisibility =</span><br><span class="line">            View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN or View.SYSTEM_UI_FLAG_LAYOUT_STABLE<span class="comment">//这行表示Activity的布局会显示在状态栏上</span></span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT<span class="comment">//将状态栏设置为透明色</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这时候，天气界面的布局整体向上偏移了一些——丑：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107182716540.png" alt="image-20221107182716540"></p><p>os：其实也还好，怕以后工作产品狗挑毛病也写一下好了</p><p>修改：now.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/nowLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;530dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/titleLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这一行是让系统状态栏留出空间。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107183046983.png" alt="image-20221107183046983"></p><p>好像确实更优雅了</p><h3 id="3-3-记录选中城市">3.3 记录选中城市</h3><h4 id="3-3-1-存储准备">3.3.1 存储准备</h4><ol><li><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191559967.png" alt="image-20221107191559967"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lmc.volcanoweather.logic.dao</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.provider.Settings.Global.putString</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.edit</span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.VolcanoWeatherApplication</span><br><span class="line"><span class="keyword">import</span> com.lmc.volcanoweather.logic.model.Place</span><br><span class="line"></span><br><span class="line"><span class="keyword">object</span> PlaceDao &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> &#123;</span><br><span class="line">        sharedPreferences().edit &#123;</span><br><span class="line">            putString(<span class="string">&quot;place&quot;</span>, Gson().toJson(place))<span class="comment">//利用这个GSON将一个place对象转成一个JSON字符串再去存就很划算</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span>: Place &#123;</span><br><span class="line">        <span class="keyword">val</span> placeJson = sharedPreferences().getString(<span class="string">&quot;place&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> Gson().fromJson(placeJson, Place::<span class="keyword">class</span>.java)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断数据是否又被存储</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = sharedPreferences().contains(<span class="string">&quot;place&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">sharedPreferences</span><span class="params">()</span></span> = VolcanoWeatherApplication.context.</span><br><span class="line">    getSharedPreferences(<span class="string">&quot;sunny_weather&quot;</span>, Context.MODE_PRIVATE)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>仓库中封装一下</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191808930.png" alt="image-20221107191808930"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> Repository &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> = PlaceDao.savePlace(place)</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span> = PlaceDao.getSavedPlace()</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = PlaceDao.isPlaceSaved()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>PlaceViewModel中再进行一次封装</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107191955822.png" alt="image-20221107191955822"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">savePlace</span><span class="params">(place: <span class="type">Place</span>)</span></span> = Repository.savePlace(place)</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getSavedPlace</span><span class="params">()</span></span> = Repository.getSavedPlace()</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isPlaceSaved</span><span class="params">()</span></span> = Repository.isPlaceSaved()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="3-3-2-实现">3.3.2 实现</h4><h5 id="PlaceAdapter">PlaceAdapter</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107192230429.png" alt="image-20221107192230429"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> fragment: PlaceFragment, <span class="keyword">private</span> <span class="keyword">val</span> placeList:</span><br><span class="line">List&lt;Place&gt;) : RecyclerView.Adapter&lt;PlaceAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">    <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.place_item,</span><br><span class="line">    parent, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">val</span> holder = ViewHolder(view)</span><br><span class="line">    holder.itemView.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> position = holder.adapterPosition</span><br><span class="line">    <span class="keyword">val</span> place = placeList[position]</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(parent.context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    fragment.viewModel.savePlace(place)</span><br><span class="line">    fragment.startActivity(intent)</span><br><span class="line">    fragment.activity?.finish()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> holder</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进行两处修改：</p><ol><li>先把 PlaceAdapter 主构造函数中传入的 Fragment 对象改成 PlaceFragment 对象</li><li>当点击了任何子项布局时，在跳转到 WeatherActivity 之前，先调用 PlaceViewModel 的 savePlace() 方法来存储选中的城市。</li></ol><h5 id="PlaceFragment">PlaceFragment</h5><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221107192833343.png" alt="image-20221107192833343"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">    <span class="keyword">if</span> (viewModel.isPlaceSaved()) &#123;</span><br><span class="line">    <span class="keyword">val</span> place = viewModel.getSavedPlace()</span><br><span class="line">    <span class="keyword">val</span> intent = Intent(context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">    putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">    putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">    putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">    &#125;</span><br><span class="line">    startActivity(intent)</span><br><span class="line">    activity?.finish()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>验证了一下几乎成了</p><h2 id="4-手动刷新天气-切换城市">4.手动刷新天气&amp;切换城市</h2><blockquote><p>有个Bug：选中某个地方就没办法查看其他城市的天气了。</p></blockquote><h3 id="4-1-手动刷新天气">4.1 手动刷新天气</h3><p>直接用下拉控件就可以了</p><ol><li><p>在ScrollView的外面嵌套了一层SwipeRefreshLayout</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108150656151.png" alt="image-20221108150656151"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/swipeRefresh&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/weatherLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:overScrollMode</span>=<span class="string">&quot;never&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:scrollbars</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:visibility</span>=<span class="string">&quot;invisible&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>WeatherActivity 中加入刷新天气的处理逻辑：</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108150818662.png" alt="image-20221108150818662"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"><span class="keyword">val</span> viewModel <span class="keyword">by</span> lazy &#123; ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(WeatherViewModel::<span class="keyword">class</span>.java) &#125;</span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    viewModel.weatherLiveData.observe(<span class="keyword">this</span>, Observer &#123; result -&gt;</span><br><span class="line">    <span class="keyword">val</span> weather = result.getOrNull()</span><br><span class="line">    <span class="keyword">if</span> (weather != <span class="literal">null</span>) &#123;</span><br><span class="line">    showWeatherInfo(weather)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;无法成功获取天气信息&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">    result.exceptionOrNull()?.printStackTrace()</span><br><span class="line">    &#125;</span><br><span class="line">    swipeRefresh.isRefreshing = <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">    swipeRefresh.setColorSchemeResources(R.color.design_default_color_primary)</span><br><span class="line">    refreshWeather()</span><br><span class="line">    swipeRefresh.setOnRefreshListener &#123;</span><br><span class="line">    refreshWeather()</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">refreshWeather</span><span class="params">()</span></span> &#123;</span><br><span class="line">    viewModel.refreshWeather(viewModel.locationLng, viewModel.locationLat)</span><br><span class="line">    swipeRefresh.isRefreshing = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>其实吧，没啥大区别，你进去就是最新的天气信息。再刷新下子有啥作用尼？</p><h3 id="4-2-切换城市">4.2 切换城市</h3><p>想着是通过滑动菜单来做</p><h4 id="4-2-1-头布局加个切换按钮">4.2.1 头布局加个切换按钮</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108151942198.png" alt="image-20221108151942198"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/nowLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;530dp&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/titleLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/navBtn&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@drawable/ic_home&quot;</span> /&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-2-2-实现滑动菜单功能">4.2.2 实现滑动菜单功能</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108152223568.png" alt="image-20221108152223568"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/swipeRefresh&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;start&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:clickable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:focusable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@color/design_default_color_primary&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/placeFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.lmc.volcanoweather.ui.place.PlaceFragment&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;25dp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在SwipeRefreshLayout的外面又嵌套了一层DrawerLayout,第一个是主屏幕中的内容，第二个是滑动菜单中的内容</p><h4 id="4-2-3-滑动菜单逻辑">4.2.3 滑动菜单逻辑</h4><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108153659654.png" alt="image-20221108153659654"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        ...</span><br><span class="line">        navBtn.setOnClickListener &#123;</span><br><span class="line">            drawerLayout.openDrawer(GravityCompat.START)</span><br><span class="line">        &#125;</span><br><span class="line">        drawerLayout.addDrawerListener(<span class="keyword">object</span> : DrawerLayout.DrawerListener &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerStateChanged</span><span class="params">(newState: <span class="type">Int</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerSlide</span><span class="params">(drawerView: <span class="type">View</span>, slideOffset: <span class="type">Float</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerOpened</span><span class="params">(drawerView: <span class="type">View</span>)</span></span> &#123;&#125;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDrawerClosed</span><span class="params">(drawerView: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">                <span class="comment">//滑动菜单隐藏的时候也隐藏输入法</span></span><br><span class="line">            <span class="keyword">val</span> manager = getSystemService(Context.INPUT_METHOD_SERVICE)</span><br><span class="line">            <span class="keyword">as</span> InputMethodManager</span><br><span class="line">            manager.hideSoftInputFromWindow(drawerView.windowToken,</span><br><span class="line">            InputMethodManager.HIDE_NOT_ALWAYS)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有个Bug：</p><blockquote><p>之前在PlaceFragment中做过一个数据存储状态的判断，假如已经有选中的城市保<br>存在SharedPreferences文件中了，那么就直接跳转到WeatherActivity。但是现在将<br>PlaceFragment嵌入WeatherActivity中之后，如果还执行这段逻辑肯定是不行的，因为这会<br>造成无限循环跳转的情况。为此需要对PlaceFragment进行如下修改：</p><p>???</p></blockquote><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108154643471.png" alt="image-20221108154643471"></p><p>加了一层逻辑判断条件</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlaceFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">        <span class="keyword">if</span> (activity <span class="keyword">is</span> MainActivity &amp;&amp; viewModel.isPlaceSaved()) &#123;</span><br><span class="line">            <span class="keyword">val</span> place = viewModel.getSavedPlace()</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(context, WeatherActivity::<span class="keyword">class</span>.java).apply &#123;</span><br><span class="line">            putExtra(<span class="string">&quot;location_lng&quot;</span>, place.location.lng)</span><br><span class="line">            putExtra(<span class="string">&quot;location_lat&quot;</span>, place.location.lat)</span><br><span class="line">            putExtra(<span class="string">&quot;place_name&quot;</span>, place.name)</span><br><span class="line">            &#125;</span><br><span class="line">            startActivity(intent)</span><br><span class="line">            activity?.finish()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>切换城市后的逻辑:</p><p>之前选中了某个城市后是跳转到WeatherActivity的，而现在由于我们本来就是<br>在WeatherActivity中的，因此并不需要跳转，只要去请求新选择城市的天气信息就可以了。</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108155127067.png" alt="image-20221108155127067"></p><p>出现一个空指针BUG</p><blockquote><p>解决办法：<img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221108160359323.png" alt="image-20221108160359323"></p><p>这两个方法一定要放在最上面</p></blockquote><h2 id="5-制作APP图标">5. 制作APP图标</h2><p>从 Android8 开始app图标应该是两层：前景层和背景层。</p><p>前景层：APP的logo</p><p>背景层：衬托APP的Logo（只能定义颜色和纹理，不可以有形状）</p><p>图标形状由手机厂商来决定（mask）</p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109161923535.png" alt="image-20221109161923535"></p><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109162022438.png" alt="image-20221109162022438"></p><h2 id="6-生成正式签名的APK文件文件">6. 生成正式签名的APK文件文件</h2><p>之前测试的安卓APP是AS有个默认的keystore文件帮我们自动进行了签名（gradle负责）</p><h3 id="6-1-AS生成">6.1 AS生成</h3><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109162800822.png" alt="image-20221109162800822"></p><p>这个也不好演示，看视频好耶</p><h3 id="6-2-Gradle生成">6.2 Gradle生成</h3><p><img src="C:/Users/Micenlee/AppData/Roaming/Typora/typora-user-images/image-20221109165813855.png" alt="image-20221109165813855"></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;org.jetbrains.kotlin.android&#x27;</span></span><br><span class="line">    id <span class="string">&#x27;kotlin-android-extensions&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdk <span class="number">32</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.lmc.volcanoweather&quot;</span></span><br><span class="line">        minSdk <span class="number">21</span></span><br><span class="line">        targetSdk <span class="number">32</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line"></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        config &#123;</span><br><span class="line">            storeFile file(<span class="string">&#x27;/Users/Mecenlee/Mecenlee.jks&#x27;</span>)</span><br><span class="line">            storePassword <span class="string">&#x27;594946&#x27;</span></span><br><span class="line">            keyAlias = <span class="string">&#x27;Mecenleedev&#x27;</span></span><br><span class="line">            keyPassword <span class="string">&#x27;594946&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android-optimize.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">            signingConfig signingConfigs.config</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        jvmTarget = <span class="string">&#x27;1.8&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.core:core-ktx:1.7.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.appcompat:appcompat:1.3.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.google.android.material:material:1.4.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.constraintlayout:constraintlayout:2.0.4&#x27;</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">&#x27;androidx.recyclerview:recyclerview:1.2.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-extensions:2.2.0&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;androidx.lifecycle:lifecycle-livedata-ktx:2.5.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.1.0&quot;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:retrofit:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;com.squareup.retrofit2:converter-gson:2.6.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.4.1&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.4.1&quot;</span></span><br><span class="line"></span><br><span class="line">    testImplementation <span class="string">&#x27;junit:junit:4.13.2&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.ext:junit:1.1.3&#x27;</span></span><br><span class="line">    androidTestImplementation <span class="string">&#x27;androidx.test.espresso:espresso-core:3.4.0&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-优化点">7.优化点</h2><h2 id="8-总结">8.总结</h2><p>弱项：</p><ol><li>网络部分，尤其是Retrofit</li><li>RecycleView的一些列操作</li><li>Fragment</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;火山天气&lt;/h1&gt;
&lt;p&gt;天气API：&lt;a href=&quot;https://dashboard.caiyunapp.com/v1/token/&quot;&gt;彩云科技 | 开放平台 (caiyunapp.com)&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;查询全</summary>
      
    
    
    
    <category term="项目" scheme="http://lmc.pub/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="项目" scheme="http://lmc.pub/tags/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>【算法】数据结构和算法理论基础</title>
    <link href="http://lmc.pub/posts/965578377.html"/>
    <id>http://lmc.pub/posts/965578377.html</id>
    <published>2023-03-27T22:34:17.000Z</published>
    <updated>2023-03-27T23:30:06.824Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数组">数组</h2><blockquote><h3 id="1-数组基本概念">1. 数组基本概念</h3><p>在一片连续的内存地址上同意类型的数据集合。</p><p>二维数组在C++中内存地址是连续的，但是Java中不是。</p><p>Java 中 int[5] [6] 是5个行首指针放在一个连续组里面大小为5，然后各自指向一条连续的6空间。</p><p>所以是5*6的连续空间</p><p>Java中是每一行当一个，然后每行的头是连续内存。</p></blockquote><h2 id="链表">链表</h2><h3 id="链表基础">链表基础</h3><h4 id="1-单链表">1. 单链表</h4><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806194529815.png" alt="单链表"></p><h4 id="2-双链表">2. 双链表</h4><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806194559317.png" alt="链表2"></p><h4 id="3-循环链表">3. 循环链表</h4><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806194629603.png" alt="链表4"></p><h4 id="4-存储方式">4. 存储方式</h4><blockquote><p>非连续</p></blockquote><h4 id="5-链表节点的定义">5. 链表节点的定义</h4><p>codes：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在下面</span><br></pre></td></tr></table></figure><h4 id="6-链表的操作">6. 链表的操作</h4><h5 id="a-删除">a. 删除</h5><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806195114541-20230310121459257.png" alt="链表-删除节点"></p><p>直接：前.next = next.next;</p><p>java 会自己清除 D；</p><h5 id="b-添加">b. 添加</h5><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806195134331-20230310121503147.png" alt="链表-添加节点"></p><p>code:</p><h4 id="7-链表和数组的对比">7. 链表和数组的对比</h4><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20200806195200276.png" alt="链表-链表与数据性能对比"></p><hr><h2 id="Hash-表">Hash 表</h2><h3 id="哈希表">哈希表</h3><p>键值对。</p><p>通过key可以很快的访问value。</p><p><strong>一般 Hash Table 都是用来快速判断一个元素是否出现在集合里。</strong></p><p>牺牲空间换时间</p><h3 id="哈希函数">哈希函数</h3><p>一个函数：把你输入的东西转换成 哈希表 中的下标。</p><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/2021010423484818.png" alt="哈希表2"></p><h3 id="哈希碰撞">哈希碰撞</h3><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/2021010423494884.png" alt="哈希表3"></p><h4 id="拉链法">拉链法</h4><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20210104235015226.png" alt="哈希表4"></p><p>哈希表大小为 tableSize</p><p>数据规模为 dataSize</p><p>要控制tableSize 的大小</p><p>达到一个：</p><p>即不让太多数组空着浪费，又不会链表太长查找麻烦。</p><h4 id="线性试探法">线性试探法</h4><p>前提：tableSize &gt; dataSize</p><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20210104235109950.png" alt="哈希表5"></p><p>第二个放的人，这个冲突了就尝试放下一个。</p><p>下一个不行就继续下一个。</p><h3 id="常见的三种哈希结构">常见的三种哈希结构</h3><blockquote><ul><li>数组</li><li>set（集合）</li><li>map（映射）</li></ul></blockquote>]]></content>
    
    
    <summary type="html">基础数据结构和一下算法基本理论知识。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>【算法】环形链表II142</title>
    <link href="http://lmc.pub/posts/2450859797.html"/>
    <id>http://lmc.pub/posts/2450859797.html</id>
    <published>2023-03-27T10:24:29.000Z</published>
    <updated>2023-03-27T23:30:06.834Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode.cn/problems/linked-list-cycle-ii/">142. 环形链表 II - 力扣（Leetcode）</a></p><p>这个逻辑过程还是很有趣的，有点数学在里面。</p><p>不过是初中水平。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//环形链表II142</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedListCycleII142</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> initLinkedList(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;);</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Solution</span>().detectCycle(head);</span><br><span class="line">System.out.println(res == <span class="literal">null</span> ? <span class="string">&quot;null&quot;</span> : res.val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//做环的init</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">initLinkedList</span><span class="params">(<span class="type">int</span>[] nums)</span>&#123;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(nums[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head,node;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">    node = <span class="keyword">new</span> <span class="title class_">ListNode</span>(nums[i]);</span><br><span class="line">    cur.next = node;</span><br><span class="line">    cur = node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//下面这里设置成不成环</span></span><br><span class="line">    <span class="comment">//cur.next = head.next;</span></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line"><span class="type">int</span> val;</span><br><span class="line">ListNode next;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ListNode</span> <span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ListNode</span> <span class="params">(<span class="type">int</span> val)</span>&#123; </span><br><span class="line"><span class="built_in">this</span>.val = val;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ListNode</span> <span class="params">(<span class="type">int</span> val, ListNode next)</span>&#123; </span><br><span class="line"><span class="built_in">this</span>.val = val;</span><br><span class="line"><span class="built_in">this</span>.next = next;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">detectCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(fast != <span class="literal">null</span> &amp;&amp; fast.next != <span class="literal">null</span>)&#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        <span class="keyword">if</span> (fast == slow) &#123;</span><br><span class="line">        <span class="comment">//有环</span></span><br><span class="line">        </span><br><span class="line">        slow = head;</span><br><span class="line">        <span class="keyword">while</span>(slow != fast)&#123;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        fast = fast.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">带了点数学味道的链表题目。懂了规律就很容易。</summary>
    
    
    
    <category term="算法" scheme="http://lmc.pub/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="http://lmc.pub/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
</feed>
